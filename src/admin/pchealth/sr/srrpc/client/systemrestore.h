/******************************************************************
   Copyright (c) 1999 Microsoft Corporation

   SystemRestore.H -- WMI provider class definition

   Generated by Microsoft WBEM Code Generation Engine
 
   Description: 
   

*******************************************************************/

// Property set identification
//============================

#ifndef _SystemRestore_H_
#define _SystemRestore_H_

#define PROVIDER_NAME_SYSTEMRESTORE L"SystemRestore"

// Property name externs -- defined in SystemRestore.cpp
//=================================================

extern const WCHAR* pName ;
extern const WCHAR* pNumber ;
extern const WCHAR* pType ;
extern const WCHAR* pTime ;

class CSystemRestore : public Provider 
{
    public:
        // Constructor/destructor
        //=======================

        CSystemRestore(LPCWSTR lpwszClassName, LPCWSTR lpwszNameSpace);
        virtual ~CSystemRestore();

    protected:
        // Reading Functions
        //============================
        virtual HRESULT EnumerateInstances(MethodContext*  pMethodContext, long lFlags = 0L);
        virtual HRESULT GetObject(CInstance* pInstance, long lFlags = 0L);
        virtual HRESULT ExecQuery(MethodContext *pMethodContext, CFrameworkQuery& Query, long lFlags = 0L);

        // Writing Functions
        //============================
        virtual HRESULT PutInstance(const CInstance& Instance, long lFlags = 0L);
        virtual HRESULT DeleteInstance(const CInstance& Instance, long lFlags = 0L);

        // Other Functions
        virtual HRESULT ExecMethod( const CInstance& Instance,
                        const BSTR bstrMethodName,
                        CInstance *pInParams,
                        CInstance *pOutParams,
                        long lFlags = 0L );

        // TO DO: Declare any additional functions and accessor
        // functions for private data used by this class
        //===========================================================
        HRESULT CreateRestorePoint(
            CInstance *pInParams,
            CInstance *pOutParams);

        HRESULT Disable(
            CInstance *pInParams,
            CInstance *pOutParams);
            
        HRESULT Enable(
            CInstance *pInParams,
            CInstance *pOutParams);

        HRESULT Restore(
            CInstance *pInParams,
            CInstance *pOutParams);            

		HRESULT GetLastRestoreStatus(
		    CInstance *pInParams,
		    CInstance *pOutParams);
		    
    private:
        // All data members for CSystemRestore should be included here.   

} ;

#endif
