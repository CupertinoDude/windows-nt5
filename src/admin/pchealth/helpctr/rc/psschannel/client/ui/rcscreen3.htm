<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_goToURL() { //v3.0
  var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
  window.navigate(args[0]); 
}
//-->
</script>
</head>

<body bgcolor="#FFFFFF">
<div id=idStep4>
<table width="450" border="0" cellspacing="0" cellpadding="0" height="450">
  <tr valign="top"> 
    <td height="354"> <font face="Arial, Helvetica, sans-serif" size="+1" color="#666666">Remote 
      Control</font><font face="Arial, Helvetica, sans-serif" color="#000000" size="2"> 
      </font> <font face="Arial, Helvetica, sans-serif" size="+1" color="#666666"> 
      - </font><font face="Arial, Helvetica, sans-serif" color="#666666">Asking for PSS Help
	</font><font face="Arial, Helvetica, sans-serif" color="#000000" size="2"><font color="#666666"></font></font> 

      <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr valign="top"> 
          <td height="39"> 
		<!--
            <table width="100%" border="0" cellspacing="0" cellpadding="10">
              <tr> 
                <td> 
                  <p><font face="Verdana, Arial, Helvetica, sans-serif" size="2">Your 
                    helper will be sent an email explaining </font><font face="Arial, Helvetica, sans-serif" color="#000000" size="2"><font face="Verdana, Arial, Helvetica, sans-serif">Remote 
                    Control </font></font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"> 
                    and instructing them how to start the help session. Please 
                    fill out the invitation below.</font></p>
                </td>
              </tr>
            </table>
		-->
          </td>
        </tr>
        <tr valign="top"> 
          <td height="43"> <br>
            <table width="90%" border="1" cellspacing="0" cellpadding="0" bordercolorlight="#000000" bordercolordark="#FFFFFF" align="center">
              <tr bgcolor="#99CCFF"> 
                <td nowrap height="5"> 
                  
                    
                  <table width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr> 
                      <td width="65%"> 
                        <div align="right"><font face="Verdana, Arial, Helvetica, sans-serif" size="2">Problem
                          Description</font></div>
                      </td>
                      <td width="35%"> 
                        <div align="right"><font size="1"><img src="Help.gif" width="45" height="16" align="absmiddle">&nbsp;</font></div>
                      </td>
                    </tr>
                  </table>
                </td>
              </tr>
              <tr> 
                <td height="147"> 
                  <table width="100%" border="0" cellspacing="8" cellpadding="0">
                    <tr> 
                      <td width="68%" height="18"><font size="1" face="Verdana, Arial, Helvetica, sans-serif">FROM<b> 
                        <font face="Arial, Helvetica, sans-serif" color="#666666">(YOUR 
                        NAME)</font></b>
                        <input type="text" id="idFrom" name="textfield222" size="60" maxlength="30">
                        </font> </td>
                    </tr>
                    <tr> 
                      <td width="68%"> <font size="1" face="Verdana, Arial, Helvetica, sans-serif">MESSAGE 
                        TO PSS Support Engineer <font face="Arial, Helvetica, sans-serif" color="#666666"></font><br>
                        </font><font face="Arial, Helvetica, sans-serif"> 
                        <textarea id="idMsg" name="textarea" wrap="VIRTUAL" cols="45" rows="8">

</textarea>
                        </font><font size="1" face="Verdana, Arial, Helvetica, sans-serif"> 
                        </font> </td>
                    </tr>
                  </table>
                  <table width="100%" border="0" cellspacing="10" cellpadding="0">
                    <tr> 
                      <td width="60%" valign="middle" bgcolor="E0E0E0"> 
                        <div align="center"><font face="Verdana, Arial, Helvetica, sans-serif" size="1">MAKE 
                          HELP INVITATION EXPIRE</font></div>
                      </td>
                      <td width="35%" valign="top" nowrap><font face="Verdana, Arial, Helvetica, sans-serif" size="1"> 
                        <select name="select2">
                          <option>in 5 minutes</option>
                          <option>in 30 minutes</option>
                          <option>in 1 hour</option>
                          <option>in 3 hours</option>
                          <option>in 6 hours</option>
                          <option selected>in 1 day</option>
                        </select>
                        </font></td>
                    </tr>
		<!--
                    <tr> 
                      <td width="60%" valign="middle" bgcolor="E0E0E0"> 
                        <div align="center"><font size="1" face="Verdana, Arial, Helvetica, sans-serif">MAKE 
                          HELPER ENTER A PASSWORD <font face="Arial, Helvetica, sans-serif" color="#666666">(OPTIONAL)</font> 
                          </font></div>
                      </td>
                      <td width="35%" valign="top" nowrap><font size="1" face="Verdana, Arial, Helvetica, sans-serif"> 
                        PASSWORD<br>
                        <input type="password" id="idPass1" name="textfield2" size="18" maxlength="18">
                        <br>
                        CONFIRM PASSWORD<br>
                        <input type="password" id="idPass2" name="textfield23" size="18" maxlength="18">
                        </font></td>
                    </tr>
                    <tr> 
                      <td colspan="2" valign="top"> 
                        <div align="center"><font face="Verdana, Arial, Helvetica, sans-serif" size="1"><font color="#000000">NOTE: 
                          If you use a password you will need to <a href="PassHelp.htm">give 
                          it to your helper</a>.</font></font></div>
                      </td>
                    </tr>
		-->
                  </table>
                  
                </td>
              </tr>
            </table>
            <div align="center"><font face="Verdana, Arial, Helvetica, sans-serif" size="1"><b>&nbsp;<font color="#0033CC">&nbsp;</font></b></font></div>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr valign="bottom"> 
    <td height="2"> 
      <table width="350" border="0" cellspacing="0" cellpadding="0" align="center">
        <tr> 
          <td width="135"> 
            <div align="center"><font face="Arial, Helvetica, sans-serif"> 
              <input type="submit" name="Submit222" value="&lt; Back" onClick="MM_goToURL('RCscreen1.htm');return document.MM_returnValue">
              &nbsp; </font></div>
          </td>
          <td width="80"> 
            <div align="left"> </div>
          </td>
          <td width="135"> 
            <div align="center"><font face="Arial, Helvetica, sans-serif"> 
              <input type="submit" name="Submit23" value="Send Help Request" OnClick="DoSend()">
              </font></div>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</div>

</body>
<Script Language=JavaScript>
var oChannel = null;
var oRCSession = null;
var L_RCCHANNEL_MSG = "Please double click the attached file to launch Remote Control expert session.";
var L_DESCRIPTION_MSG = "Problem description: ";
var L_SUBJECT_MSG = "Remote Control Help Request from: ";

function DoSend() {
	// 
	if (parent.Init() == false)
		return false;

	var oRCSession = parent.oRCSession;
	var oChannel = parent.oChannel;

	sSalemID = oRCSession.ConnectParms;
	oRCSession.OnConnected = parent.onCallBackConnect;
	
	// save ticket locally
	oChannel.RecordIncident(parent.sEmail, sSalemID);
	
	//
	// Now set the attributes of the incident
	//
	Timeout = "undefined";
	var IncidentFile = oChannel.VendorDirectory + "\\rcPSS.MsRcIncident";

	oInc = parent.pchealth.CreateObject_Incident();
	oInc.UserName = idFrom.value;
	oInc.ProblemDescription = idMsg.value;

    	oInc.RcTicket = sSalemID;

	//
	// TODO: only timeout is left to be added to Incident
	//
	
	//
	// Save incident OFF to an XML file
	//
	oInc.GetXML(IncidentFile);
	
	//
	//  Upload the incident to the PSS Web.
	//
    try {
	obj = new ActiveXObject("UploadManager.MPCUpload");
	job = obj.CreateJob();
	//job.onStatusChange = job_onStatusChange;
	//job.onProgressChange = job_onProgressChange;
	job.Server = "http://steveshi04/pssDemo/UploadServer.dll";
	job.ProviderID = "RCHANDLER";
	job.GetDataFromFile( IncidentFile );
	job.Mode = 1; // foreground mode
	job.PersistToDisk = false;
	job.History = 0; //No history log
    job.Sig = "";
	job.ActivateAsync();
	// Open the last step: step4 and wait for connection from buddy
	PopupThanks();
    }
    catch (e) {
        alert("Upload failed: " + e.Description);
    }
}

function PopupThanks() {
    navigate("rcScreen4.htm");
}

	
</Script>
</html>
