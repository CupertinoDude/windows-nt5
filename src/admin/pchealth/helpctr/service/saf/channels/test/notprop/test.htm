<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><HTML>


<HEAD>
<META http-equiv=Content-Type content="text/html; charset=unicode"><!-- // let's include the PC Health object here -->
<OBJECT id=pchealth classid=CLSID:FC7D9E02-3F9E-11d3-93C0-00C04F72DAF7></OBJECT>
<SCRIPT LANG="JScript" SRC="safbvt_utility.js">
</SCRIPT>

<META content="MSHTML 6.00.2410.0" name=GENERATOR>
</HEAD>
<BODY>
<P><INPUT type=button value=Button onclick=Go()></P></BODY>

<SCRIPT LANGUAGE="Javascript">


function Go()
{
	var myChannel;

	var szGUID = "";

	var incident;
	
	var display, url, progress, XMLDataFile;	
	display = "display1";
	url = "url1";
	progress = "progress1";
	XMLDataFile = "XMLDataFile1";
	
	try
	{
		myChannel = pchealth.CreateObject_channel("CN=Microsoft Corporation,L=Redmond,S=Washington,C=US", "Microsoft Remote Assistance");
		alert("Created Channel!");

		alert("Setting 1-8 GUID!");

		myChannel.Notification = "{354252FF-F707-4507-9B9C-2F5D6DA62C69}";
		alert("Set Notification!");

		alert("Creating incident!");

		incident = myChannel.RecordIncident(display, url, progress, XMLDataFile);

		alert("CREATED incident, should have gotten notification!");
	
		alert("Modifying the Progress property!");

		incident.Progress = "Test";

		alert("Modified incident, should have gotten notification!");

		alert("Removing the incident!");

		incident.DeleteIncidentItem();

		alert("Deleted incident, should have gotten a deleted and a updated");

	}
	catch (e)
	{
		alert(e.description);
	}
	
	return true;

}


</SCRIPT>



</HTML>
