#include <windows.h>
#include "resource.h"
#include "cmdlineres.h"
#include "cmdline.rc"

/////////////////////////////////////////////////////////////////////////////
//
// String Table
//

// Strings for the help display
STRINGTABLE DISCARDABLE 
BEGIN
    IDS_HELP_1      "\nGPRESULT [/S system [/U username [/P [password]]]] [/SCOPE scope]\n"
    IDS_HELP_2      "         [/USER targetusername] [/V | /Z]\n"
    IDS_HELP_3      "\n"
    IDS_HELP_4      "Description:\n"
    IDS_HELP_5      "    This command line tool displays the Resultant Set of Policy (RSoP)\n"
    IDS_HELP_6      "    for a target user and computer.\n"
    IDS_HELP_7      "\n"    
    IDS_HELP_8      "Parameter List:\n"
    IDS_HELP_9      "    /S        system           Specifies the remote system to connect\n"
    IDS_HELP_10     "                               to.\n\n"
    IDS_HELP_11     "    /U        [domain\]user    Specifies the user context under which\n"
    IDS_HELP_12     "                               the command should execute.\n\n"
    IDS_HELP_13     "    /P        [password]       Specifies the password for the given \n"
    IDS_HELP_14     "                               user context. Prompts for input if omitted.\n\n"
    IDS_HELP_15     "    /USER     [domain\]user    Specifies the user name for which the\n"
    IDS_HELP_16     "                               RSOP data is to be displayed.\n\n"
    IDS_HELP_17     "    /SCOPE    scope            Specifies whether the user or the\n"
    IDS_HELP_18     "                               computer settings needs to be\n"
    IDS_HELP_19     "                               displayed.\n"
    IDS_HELP_20     "                               Valid values: ""USER"", ""COMPUTER"".\n\n"
    IDS_HELP_21     "    /V                         Specifies that the verbose information\n"
    IDS_HELP_22     "                               is to be displayed. Verbose information\n"
    IDS_HELP_23     "                               details specific settings that have\n"
    IDS_HELP_24     "                               been applied with a precedence of 1.\n\n"
    IDS_HELP_25     "    /Z                         Specifies that the super-verbose\n"
    IDS_HELP_26     "                               information is to be displayed. Super-\n"
    IDS_HELP_27     "                               verbose information details specific\n"
    IDS_HELP_28     "                               settings that have been applied with a\n"
    IDS_HELP_29     "                               precedence of 1 and higher. This allows\n"
    IDS_HELP_30     "                               you to see if a setting was set in\n"
    IDS_HELP_31     "                               multiple places. See the Group Policy\n"
    IDS_HELP_32     "                               online help for more information.\n\n"
    IDS_HELP_33     "    /?                         Displays this help/usage.\n\n"
    IDS_HELP_34     "NOTE: If you run GPRESULT without parameters, it returns the RSoP data\n"
    IDS_HELP_35     "      for the current logged-on user on the computer it was run on.\n"
    IDS_HELP_36     "\nExamples:\n"
    IDS_HELP_37     "    GPRESULT\n"
    IDS_HELP_38     "    GPRESULT /USER targetusername /V\n"    
    IDS_HELP_39     "    GPRESULT /S system /USER targetusername /SCOPE COMPUTER /Z\n"
    IDS_HELP_40     "    GPRESULT /S system /U username /P password /SCOPE USER /V\n"
END

// General strings
STRINGTABLE DISCARDABLE 
BEGIN
    IDS_INFO                    "INFO: "
    IDS_ERROR                   "ERROR: "
    IDS_WARNING                 "WARNING: "
    IDS_DASH                    "-"
    IDS_NEWLINE_TAB             "\n    "
    IDS_LAST_CHAR               " :  "
    IDS_NEWLINE                 "\n"
    IDS_NEWLINE1                "\n                                   "
    IDS_NEWLINE2                "\n                           "
    IDS_NEWLINETAB              "\n        "
    IDS_NEWLINE_TABTHREE        "\n            "
END

// Strings for warning messages
STRINGTABLE DISCARDABLE 
BEGIN
    IDS_WARN_LOCAL              "Ignoring the user credentials for the local system."
END

// Strings for Information messages
STRINGTABLE DISCARDABLE 
BEGIN
    IDS_USER_NO_RSOP            "The user ""%s"" does not have RSOP data.\n"
END

// Strings for Error messages
STRINGTABLE DISCARDABLE 
BEGIN
    IDS_ERROR_USERNAME_BUT_NOMACHINE    "Invalid Syntax. /U can be specified only when /S is specified.\n"
    IDS_ERROR_PASSWORD_BUT_NOUSERNAME   "Invalid Syntax. /P can be specified only when /U is specified.\n"
    IDS_ERROR_COM_ERROR                 "%s Error Code: 0x%08lx\n"
    IDS_ERROR_USERNAME_EMPTY            "Invalid Syntax. User name cannot be empty.\n"
    IDS_ERROR_SERVERNAME_EMPTY          "Invalid Syntax. Server name cannot be empty.\n"
    IDS_ERROR_NO_OPTIONS                "Invalid Syntax.\nType ""GPRESULT /?"" for usage.\n" 
    IDS_ERROR_USAGE                     "Invalid Syntax. No options can be specified alongwith '/?'.\n" 
    IDS_TYPE_USAGE                      "Type ""GPRESULT /?"" for usage.\n"
    IDS_ERROR_TARGET_EMPTY              "Invalid Syntax. Target user name cannot be empty.\n"
    IDS_USER_NOT_VALID                  "The specified user name is not valid.\n"
    IDS_NO_USER                         "The /USER value is not valid.\n"
    IDS_METHOD_FAILED                   "Access Denied.\n"
    IDS_ERROR_VERBOSE_SYNTAX            "Invalid Syntax. /Z cannot be specified when /V is specified.\n"
END

// Strings for data display
STRINGTABLE DISCARDABLE 
BEGIN
    IDS_LEGAL_INFO1             "Microsoft (R) Windows (R) XP Operating System Group Policy Result tool v2.0\n"
    IDS_LEGAL_INFO2             "Copyright (C) Microsoft Corp. 1981-2001\n"
    IDS_CREATED_ON              "\nCreated On %s at %s\n\n"
    IDS_GPO_USER                "\n\nUSER SETTINGS"
    IDS_GPO_COMPUTER            "\n\nCOMPUTER SETTINGS"
    IDS_GPO_TITLE               "\rRSOP results for %s on %s : Logging Mode"
    IDS_DOMAIN_NAME             "Domain Name:                 "
    IDS_DOMAIN_TYPE             "Domain Type:                 "
    IDS_SITE_NAME               "Site Name:                   "
    IDS_OS_TYPE                 "\nOS Type:                     "
    IDS_OS_VERSION              "\nOS Version:                  "
    IDS_OS_CONFIG               "\nOS Configuration:            "
    IDS_LOCAL_PROFILE           "Local Profile:               "
    IDS_ROAMING_PROFILE         "Roaming Profile:             "
    IDS_LINK_SPEED              "Connected over a slow link?: "
    IDS_GPO_DISPLAY             "\n    Applied Group Policy Objects"
    IDS_GPO_FILTERED            "\n    The following GPOs were not applied because they were filtered out"
    IDS_GPO_FILTER_ID           "            WMI Filter: "
    IDS_FILTERING               "\n            Filtering:  "
    IDS_COMPUTER_RESULT         "\n    Resultant Set Of Policies for Computer:"
    IDS_USER_RESULT             "\n    Resultant Set Of Policies for User:"
    IDS_SW_SETTINGS             "Software Installations"
    IDS_WS_SS_AP_PP             "Account Policies"
    IDS_WS_SS_AP_ALP            "Account Lockout Policies"
    IDS_WS_SS_LP_AP             "Audit Policy"
    IDS_WS_SS_LP_URA            "User Rights"
    IDS_WS_SS_LP_SO             "Security Options"
    IDS_WS_SSU                  "Startup Scripts"
    IDS_WS_SSD                  "Shutdown Scripts"
    IDS_WS_SS_EL                "Event Log Settings"
    IDS_WS_SS_RG                "Restricted Groups"
    IDS_WS_SS_SS                "System Services"
    IDS_WS_SS_REG               "Registry Settings"
    IDS_WS_SS_FS                "File System Settings"
    IDS_WS_SS_PKP               "Public Key Policies"
    IDS_ADTS_RAS                "RAS Fix Policy"
    IDS_ADTS_ERS                "Administrative Templates"
    IDS_USERFR                  "Folder Redirection"
    IDS_IEPOLICY                "Internet Explorer Browser User Interface"
    IDS_FAVLINKORITEM           "Internet Explorer URLs"
    IDS_IE_SECURITY             "Internet Explorer Security"
    IDS_IE_PROGRAMS             "Internet Explorer Programs"
    IDS_PROXY                   "Internet Explorer Connection"
    IDS_GPO                     "\n            GPO: "
    IDS_POLICY                  "\n                Policy:            "
    IDS_COMPUTER_SETTING        "\n                Computer Setting:  "
    IDS_NAME                    "\n                Name:         "
    IDS_PARAMETERS              "\n                Parameters:   "
    IDS_LASTEXECUTED            "\n                LastExecuted: "
    IDS_SETTING                 "\n                Setting:           "
    IDS_FR_SETTING              "\n                Setting: "
    IDS_STATE                   "\n                State:   "
    IDS_AUTOINSTALL             "\n                AutoInstall:      "
    IDS_ORIGIN                  "\n                Origin:           "
    IDS_OBJECTNAME              "\n                ObjectName: "
    IDS_GROUPNAME               "\n                Groupname: "
    IDS_MEMBERS                 "\n                Members:   "
    IDS_SERVICENAME             "\n                ServiceName: "
    IDS_STARTUP                 "\n                Startup:     "
    IDS_PERMISSION              "\n                Permission:  "
    IDS_MEMBEROF                "\n                Memberof: "
    IDS_INSTALLATIONTYPE        " InstallationType:  "
    IDS_GRANTTYPE               "\n                    Grant Type:        "
    IDS_MOVETYPE                "\n                    Move Type:         "
    IDS_REDIRECTINGGROUP        "\n                    Redirecting Group: "
    IDS_REDIRECTEDPATH          "\n                    Redirected Path:   "
    IDS_POLICYREMOVAL           "\n                    Policy Removal:    "
    IDS_HOMEPAGEURL             "\n                Home page URL:           "
    IDS_SEARCHBARURL            "\n                Search page URL:         "
    IDS_HELPPAGEURL             "\n                Online support page URL: "
    IDS_BITMAPNAME              "\n                Large Animated Bitmap Name:      "
    IDS_LOGOBITMAPNAME          "\n                Large Custom Logo Bitmap Name:   "
    IDS_TITLEBARTEXT            "\n                Title BarText:                   "
    IDS_USERAGENTTEXT           "\n                UserAgent Text:                  "
    IDS_TOOL_BUTTONS            "\n                Delete existing toolbar buttons: "
    IDS_URL                     "\n            URL:                    "
    IDS_AVAILABLE               "\n            Make Available Offline: "
    IDS_VIEWABLESITES           "\n            Always Viewable Sites:     "
    IDS_PASSWORDOVERRIDE        "\n            Password Override Enabled: "
    IDS_ZONE_SETTING            "\n                Import the current Security Zones Settings:       "
    IDS_PROGRAM_SETTING         "\n                Import the current Program Settings: "
    IDS_CONTENT_SETTING         "\n                Import the current Content Ratings Settings:      "
    IDS_AUTH_SETTING            "\n                Import current Authenticode Security Information: "
    IDS_TRUST_PUB               "\n                Enable trusted publisher lockdown:                "
    IDS_HTTP_PROXY              "\n            HTTP Proxy Server:   "
    IDS_SECURE_PROXY            "\n            Secure Proxy Server: "
    IDS_FTP_PROXY               "\n            FTP Proxy Server:    "
    IDS_GOPHER_PROXY            "\n            Gopher Proxy Server: "
    IDS_SOCKS_PROXY             "\n            Socks Proxy Server:  "
    IDS_AUTO_CONFIG_ENABLE      "\n            Auto Config Enable:  "
    IDS_ENABLE_PROXY            "\n            Enable Proxy:        "
    IDS_USE_SAME_PROXY          "\n            Use same Proxy:      "
    IDS_APP_NAME                "\n                Name:             "
    IDS_APP_VERSION             "\n                Version:          "
    IDS_DEPLOY_STATE            "\n                Deployment State: "
    IDS_APP_SRC                 "\n                Source:           "
    IDS_LOG_NAME                "\n                Log Name:          "
    IDS_USER_SG                 "    The user is a part of the following security groups:"
    IDS_SYS_SG                  "    The computer is a part of the following security groups:"
    IDS_THRESHOLD_LINK_SPEED    "Group Policy slow link threshold:   "
    IDS_LAST_TIME               "Last time Group Policy was applied: "
    IDS_APPLIED_FROM            "Group Policy was applied from:      "
END

// Strings for data values
STRINGTABLE DISCARDABLE 
BEGIN
    IDS_NO_AUDITING                     "No Auditing"
    IDS_AUTOMATIC                       "Automatic"
    IDS_MANUAL                          "Manual"
    IDS_DISABLED                        "disabled"
    IDS_PUBLISHED                       "Published"
    IDS_ASSIGNED                        "Assigned"
    IDS_TRUE                            "True"
    IDS_FALSE                           "False"
    IDS_ARP                             "ARP List item"
    IDS_APPLICATION                     "Applied Application"
    IDS_REMOVED                         "Removed Package"
    IDS_NOPOLICY                        "no policy"
    IDS_BASIC                           "basic"
    IDS_ADVANCED                        "advanced"
    IDS_MAXIMUM                         "maximum"
    IDS_YES                             "Yes"
    IDS_NO                              "No"
    IDS_VALUE_STANDALONEWORKSTATION     "Standalone Workstation"                
    IDS_VALUE_MEMBERWORKSTATION         "Member Workstation"                             
    IDS_VALUE_STANDALONESERVER          "Standalone Server"                                    
    IDS_VALUE_MEMBERSERVER              "Member Server"                                             
    IDS_VALUE_BACKUPDOMAINCONTROLLER    "Additional/Backup Domain Controller"
    IDS_VALUE_PRIMARYDOMAINCONTROLLER   "Primary Domain Controller"                 
    IDS_STRING_COMPUTER                 "Computer"
    IDS_STRING_USER                     "User"  
    IDS_NULL_SID                        "Null SID"              
    IDS_EVERYONE                        "Everyone" 
    IDS_LOCAL                           "Local" 
    IDS_CREATOR_OWNER                   "Creator Owner ID"
    IDS_CREATOR_GROUP                   "Creator Group ID"
    IDS_SYSTEM                          "System"
    IDS_SECURITY                        "Security"
    IDS_APP_LOG                         "Application"
    IDS_ENABLED                         "Enabled"
    IDS_NOT_ENABLED                     "Not Enabled"
    IDS_NOT_EXECUTED                    "This script has not yet been executed."
    IDS_EXCLUSIVE                       "Exclusive Rights"
    IDS_NOTEXCLUSIVE                    "Not Exclusive Rights"
    IDS_MOVED                           "Contents of Local Directory moved"
    IDS_NOTMOVED                        "Contents of Local Directory not moved"
    IDS_LEAVEFOLDER                     "Leave folder in existing location"
    IDS_REDIRECT                        "Redirect the folder back to user profile location"
    IDS_W2K_DOMAIN                      "Windows 2000"
    IDS_LOCAL_COMP                      "<Local Computer>"
    IDS_NT4_DOMAIN                      "WindowsNT 4"
    IDS_MS_409                          "ms-409"
    IDS_WMI_DENIED                      "Denied (WMI Filter)\n"
    IDS_LINK_DISABLED                   "Disabled (Link)\n"
    IDS_GPO_DISABLED                    "Disabled (GPO)\n"
    IDS_ACCESS_DENIED                   "Denied (Security)\n"
    IDS_VERSION_ZERO                    "Not Applied (Empty)\n"
    IDS_NOT_APPLIED                     "Not Applied (Unknown Reason)\n"
END

// Strings for status messages
STRINGTABLE DISCARDABLE 
BEGIN
   IDS_STARTED_RETRIEVAL                "Retrieving RSOP data..."
   IDS_CONNECT_CIMV2                    "Connecting to the CIMV2 namespace..."
   IDS_USER_DATA                        "Getting the user data..."
   IDS_CONNECT_RSOP                     "Connecting to the RSOP namespace..."
   IDS_GET_SID                          "Getting the SID information..."
   IDS_GET_NAME                         "Getting the user name..."
   IDS_GET_PROFILE                      "Getting the local profile for..."
   IDS_GET_COMMON                       "Getting the common information..."
   IDS_GET_DOMAIN                       "Getting the domain information..."
   IDS_GET_OSINFO                       "Getting the OS information..."
   IDS_GET_SITE                         "Getting the site information..."
   IDS_GET_PROVIDER                     "Getting the RSOP provider..."
   IDS_GET_METHOD                       "Getting the RSOP method..."
   IDS_PUT_SID                          "Putting the SID..."
   IDS_CREATE_SESSION                   "Creating the RSOP session for %s..."
   IDS_DISPLAY_DATA                     "Starting the display of data..."
   IDS_WAIT                             "Waiting for other instances to complete their method execution..."
END

//
// Version resources
//
#include <ntverp.h>
#define VER_FILETYPE                    VFT_APP
#define VER_FILESUBTYPE                 VFT2_UNKNOWN
#define VER_FILEDESCRIPTION_STR         "Query RSOP Data"
#define VER_INTERNALNAME_STR            "GpResult.exe"
#define VER_ORIGINALFILENAME_STR        "GpRslt.exe"
#include <common.ver>
