MSI_C_DEFINES=-DSTRICT -D"_WIN32_MSI=200" -D_WIN32_DCOM

!if !$(FREEBUILD)
MSI_C_DEFINES=$(MSI_C_DEFINES) -DDEBUG
USE_RTTI=1
# MSI_BROWSER_INFO=1
!endif

!if "$(MSI_BUILD_UNICODE)"=="1"
MSI_C_DEFINES=$(MSI_C_DEFINES) -DUNICODE -D_UNICODE
MSI_SUBDIR=unicode
!if "$(MSI_BUILD_LEGACY)"=="1"
MSI_LEGACY_SUBDIR=legacy
!endif
MSI_WINENTRY=wwinmain
MSI_ENTRY=wmain
!else
MSI_SUBDIR=ansi
ALT_PROJECT_TARGET=msiwin9x
MSI_WINENTRY=winmain
MSI_ENTRY=main
NO_NTDLL=1
!endif

386_STDCALL=0

DARWIN_ROOT=$(PROJECT_ROOT)\Darwin
BUILD_ROOT=Build
MSI_DIR=$(DARWIN_ROOT)

!if "$(MSI_BUILD_LEGACY)"=="1"
MSI_TARGETPATH=$(MSI_DIR)\$(BUILD_ROOT)\$(MSI_LEGACY_SUBDIR)
MSI_UNICODE_TARGETPATH=$(MSI_DIR)\$(BUILD_ROOT)\$(MSI_SUBDIR)
!else
MSI_TARGETPATH=$(MSI_DIR)\$(BUILD_ROOT)\$(MSI_SUBDIR)
!endif

MSI_BUILD_TARGET=$(MSI_TARGETPATH)\$(_OBJ_DIR)
!if "$(MSI_BUILD_LEGACY)"=="1"
MSI_UNICODE_BUILD_TARGET=$(MSI_UNICODE_TARGETPATH)\$(_OBJ_DIR)
!endif

TARGETPATH=$(MSI_BUILD_TARGET)

SRC_DIR=$(MSI_DIR)\src
INC_DIR=$(SRC_DIR)\inc
ENGINE_DIR=$(SRC_DIR)\Engine

MSI_LIB_PATH=$(MSI_DIR)\lib\$(TARGET_DIRECTORY)

IDL_DIR=$(SRC_DIR)\Idl
!if "$(MSI_BUILD_LEGACY)"=="1"
IDL_OBJDIR=$(IDL_DIR)\$(MSI_LEGACY_SUBDIR)\$(O)
!else
IDL_OBJDIR=$(IDL_DIR)\$(MSI_SUBDIR)\$(O)
!endif

RES_DIR=$(SRC_DIR)\Res
RES_OBJDIR=$(RES_DIR)\$(MSI_SUBDIR)\$(O)

AUTO_DIR=$(SRC_DIR)\Auto
AUTO_OBJDIR=$(AUTO_DIR)\$(MSI_SUBDIR)\$(O)

BUILD_DIR=$(MSI_TARGETPATH)\$(O)
COMMON_DIR=$(MSI_DIR)\$(BUILD_ROOT)\Common
TARGETPATH_COMMON=$(COMMON_DIR)\$(_OBJ_DIR)
BUILD_COMMONDIR=$(COMMON_DIR)\$(O)
BUILD_COMMONTOOLSDIR=$(BUILD_COMMONDIR)
BUILD_PACKAGEROOT=$(MSI_DIR)\$(BUILD_ROOT)\Packages
BUILD_PACKAGEDIR=$(BUILD_PACKAGEROOT)\$(O)
HELP_DIR=$(SRC_DIR)\Help

TOOLS_DIR=$(MSI_DIR)\Tools
TOOLS_INC_DIR=$(TOOLS_DIR)\inc
MSI_TOOLS_DIR=$(SRC_DIR)\MsiTools
MSI_BUILDTOOLS_DIR=$(SRC_DIR)\BuildTools
MSI_DATA_DIR=$(MSI_DIR)\Data
MSI_INTLDATA_DIR=$(MSI_DATA_DIR)\intl
SCHEMA_IDT=$(MSI_DATA_DIR)\schema.idt
MSI_BIN_PATH=$(MSI_DIR)\Bin

ICESRC=$(MSI_TOOLS_DIR)\iceman\ices

MSI_SPYDIR=$(MSI_TOOLS_DIR)\MsiSpy
MSI_SPYRES_DIR=$(MSI_SPYDIR)\SpyRes
MSI_SPYINC_DIR=$(MSI_SPYDIR)\SpyInc

MSI_CMDPARSE_DIR=$(MSI_TOOLS_DIR)\cmdparse

C_DEFINES=$(MSI_C_DEFINES)
USER_C_FLAGS=-J

INCLUDES=$(INCLUDES);$(COM_INC_PATH);$(WINDOWS_INC_PATH);$(TERMSRV_INC_PATH)

