<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Microsoft Visual Studio 6.0">
<TITLE></TITLE>

<SCRIPT LANGUAGE="VBS">
	Dim Locator
	Dim WmiServices
</SCRIPT>

<SCRIPT FOR="Sink" EVENT="OnObjectReady(objObject, objAsyncContext)" LANGUAGE="VBScript">
		Set row = EventRecords.insertRow
		row.insertCell().innerText = objObject.TargetInstance.Identifier
		row.insertCell().innerText = objObject.TargetInstance.LoggingTime
		row.insertCell().innerText = objObject.TargetInstance.Severity
		row.insertCell().innerText = objObject.TargetInstance.Priority
		row.insertCell().innerText = objObject.TargetInstance.Message
		EventRecords.refresh
</SCRIPT>	

<SCRIPT LANGUAGE="VBS" for=window event=onload>
<!--

	'Create the scriptable locator
	Set Locator = CreateObject ("WbemScripting.SWBemLocator")
	Set WmiServices = Locator.ConnectServer ( , "Root\EventStore" ) 

	EnumServices

//-->
</SCRIPT>

<SCRIPT LANGUAGE="VBS">
<!--

Sub EnumServices

	on error resume next

	TableHeader.style.visibility = "visible"

	WmiServices.ExecNotificationQueryAsync Sink, _
		"select * from __InstanceCreationEvent within 5.0 where TargetInstance isa 'EventLogRecord'"

end Sub 
-->
</SCRIPT>
</HEAD>
<BODY LANGUAGE=javascript onload="return window_onload()" bgColor=silver>

<P align=center><STRONG><FONT face=Verdana size=5>ITG Event Record </FONT></STRONG> 
</P>

<P><FONT color=darkgreen face=Verdana size=5>Trouble Ticket List:</FONT> 
</P>

<DIV ID=TableHeader style="VISIBILITY: hidden">
<TABLE ID=EventRecords align=left bgColor=tan border=1 borderColor=saddlebrown cellPadding=1 cellSpacing=1 
width=100%>
<THEAD>
<TR>
<TD align=middle><EM>Identifer</EM></TD>
<TD align=middle><EM>Logging Time</EM></TD>
<TD align=middle><EM>Severity</EM></TD>
<TD align=middle><EM>Priority</EM></TD>
<TD align=middle><EM>Message</EM></TD>
</TR>
<TBODY></TBODY>
</TABLE> 
</DIV>
<OBJECT ID="Sink" CLASSID="CLSID:75718C9A-F029-11d1-A1AC-00C04FB6C223"></OBJECT>
</BODY></HTML>
