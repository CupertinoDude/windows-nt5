/******************************************************************

   PrinterDriver.H -- WMI provider class definition

   Generated by Microsoft WBEM Code Generation Engine
 
   Description: 
   

*******************************************************************/

// Property set identification
//============================

#ifndef  _CPrinterDriver_H_
#define  _CPrinterDriver_H_

//
// Provider Name
//
#define PROVIDER_NAME_PRINTERDRIVER		L"Win32_PrinterDriver"

class CPrinterDriver : public Provider 
{
public:

        CPrinterDriver (LPCWSTR lpwszClassName, LPCWSTR lpwszNameSpace);

        virtual ~CPrinterDriver () ;

        virtual HRESULT EnumerateInstances ( MethodContext *pMethodContext, long lFlags = 0L ) ;
		virtual HRESULT PutInstance  ( const CInstance &Instance, long lFlags );
		virtual HRESULT DeleteInstance ( const CInstance &Instance,  long lFlags );
        virtual HRESULT GetObject(CInstance *pInstance, long lFlags, CFrameworkQuery &Query);
        
        virtual HRESULT ExecMethod(const CInstance& Instance, const BSTR bstrMethodName, CInstance *pInParams, CInstance *pOutParams, long lFlags = 0L);

private:

		HRESULT LoadInstance        (      CInstance *pInstance, DRIVER_INFO_6 *DriverInfo);
		HRESULT FindAndGetDriver    (      CInstance *pInstance);
		HRESULT GetAllPrinterDrivers(      BYTE*     &a_DriverInfo, DWORD     &dwNoDrivers);
        HRESULT ExecAddPrinterDriver(      CInstance *pInParams,    CInstance *pOutParams);

#ifdef _WMI_DELETE_METHOD_
        HRESULT ExecDelPrinterDriver(      CInstance *pInParams,    CInstance *pOutParams);
#endif

};

#endif

