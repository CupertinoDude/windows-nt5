<HTML>
<HEAD>
<TITLE>ATL 3.0 test page for object WMIObjectBroker</TITLE>
</HEAD>
<BODY>
hello there<br>
one<br>
<SCRIPT LANGUAGE="VBScript">
sub window_onload
  dim obj
'  set obj = CreateObject("WMIScriptUtils.WMIObjectBroker")
end sub
</SCRIPT>
<SCRIPT LANGUAGE="JSCRIPT">
function hack2()
{
//<OBJECT ID="broker" CLASSID="CLSID:4BA59771-8FBF-4E67-9917-3BBB39B743AB"></OBJECT>

  alert (window.document.designMode);
//  window.document.designMode = "On";
  alert (window.document.designMode);
  alert(window.location.pathname);
  alert(window.location.protocol);

  alert (window.parent.document.URL);
  alert (window.parent.parent.document.URL);
  alert (window.parent.parent.parent.document.URL);
  alert (window.parent.parent.parent.parent.document.URL);
}
function window.onload()
{
  var broker = new ActiveXObject("WMIScriptUtils.WMIObjectBroker");
  var obj = broker.CreateObject("WbemScripting.SWbemLocator");
  var service = obj.ConnectServer();
  var procs = service.InstancesOf("Win32_Process");
  var f = new Enumerator(procs);
  sz = "";
  for (;!f.atEnd();f.moveNext())
  {
    var proc = f.item();
    sz += proc["Name"] + "\r\n";
    
  }
  alert(sz);
}
</SCRIPT>

</BODY>
</HTML>