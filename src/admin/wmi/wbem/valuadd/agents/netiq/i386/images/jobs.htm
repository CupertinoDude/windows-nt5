<html>
<head>
<title>NetIQ WMI Agent</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="styles.css"><style type="text/css">
<!--
-->
</style></head>

<body  topmargin="0" leftmargin="0" bgcolor="#FFFFFF">
<table border="0" width="640" cellspacing="0" cellpadding="0">
  <tr> 
    <td bgcolor="#FF9900" width="150" height="70" valign="top" rowspan="2"><img src="amlogo_s.gif" width="150" height="70"></td>
    <td bgcolor="#FF9900" width="450" height="40" valign="top"><img src="spacer.gif" width="450" height="40"></td>
    <td bgcolor="#FF9900" width="40" height="40" valign="top"><img src="spacer.gif" width="40" height="40"></td>
  </tr>
  <tr> 
    <td colspan="2" bgcolor="#FFFFFF" width="490" height="30" valign="top"><img src="suite.gif" width="490" height="30"></td>
  </tr>
  <tr> 
            <td bgcolor="#FF9900" width="150" height="20" valign="top"><img src="spacer.gif" width="150" height="20"></td>
    <td bgcolor="#FFFFFF" width="450" height="20" valign="top"><img src="spacer.gif" width="450" height="20"></td>
    <td bgcolor="#FFFFFF" width="40" height="20" valign="top"><img src="spacer.gif" width="40" height="20"></td>


  </tr>
  <tr> 
    <td bgcolor="#FF9900" width="150" valign="top">
      <table border="0" width="140" cellspacing="0" cellpadding="0">
        <tr> 
          <td width="5" height="130" valign="top"><img src="spacer.gif" width="5" height="130"></td>
          <td colspan="2" width="130" height="100" valign="middle"><img src="radar130.jpg" width="130" height="130"></td>
        </tr>
        <tr> 
          <td width="10" valign="top"><img src="spacer.gif" width="10" height="5"></td> 
          <td colspan="2" width="130" valign="top" class="intro">Click a topic 
            for more information:</td>
        </tr>
        <tr> 
          <td width="10" height="8" valign="top"><img src="spacer.gif" width="10" height="8"></td>
          <td width="10" height="8" valign="top"><img src="spacer.gif" width="10" height="8"></td>
          <td width="120" height="8" valign="top"><img src="spacer.gif" width="120" height="8"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="navcurrent"><a href="../readme.htm" class="nav">Thank 
            you</a></td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="nav"><a href="appmangr.htm" class="nav">What 
            you need to know about AppManager</a></td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="nav"><a href="wmi.htm" class="nav">About 
            the AppManager WMI Agent</a></td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="nav"><a href="install.htm" class="nav">Installing 
            the AppManager WMI Agent</a></td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="nav"><a href="starting.htm" class="nav">Starting 
            and stopping Knowledge Script jobs</a></td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="nav"><a href="events.htm" class="nav">Browsing 
            AppManager jobs, events, and data</a></td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="navcurrent">A closer 
            look at the WMI Knowledge Scripts</td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="nav"><a href="more.htm" class="nav">Learning 
            more about the AppManager Suite</a></td>
        </tr>
        <tr> 
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="10" height="5" valign="top"><img src="spacer.gif" width="10" height="5"></td>
          <td width="120" height="5" valign="top"><img src="spacer.gif" width="120" height="5"></td>
        </tr>
        <tr> 
          <td width="10" height="3" valign="top"><img src="spacer.gif" width="10" height="3"></td>
          <td width="10" height="11" valign="top"><img src="bullet.gif" width="6" height="11"></td>
          <td width="120" valign="top" class="nav"><a href="license.htm" class="nav">Disclaimer</a></td>
        </tr>
      </table>
    </td>
    <td>
      <table border="0" width="450" cellspacing="0" cellpadding="0">
        <tr>
          <td width="20" height="100" valign="top"><img src="spacer.gif" width="20" height="100"></td>
          <td width="430" valign="top">
            <h1>A closer look at the WMI Knowledge Scripts</h1>
          </td>
        </tr>
        <tr>
          <td width="20" height="20" valign="top"><img src="spacer.gif" width="20" height="20"></td>
          <td width="430" valign="top"> 
            <p>Each Knowledge Script represents one or more business or system 
              management rules. Knowledge Scripts can monitor the health and performance 
              of a managed computer by comparing real-time conditions (such as 
              memory usage) against thresholds specified by the Knowledge Scipt. 
              Knowledge Scripts also watch for specified events (such as a service 
              going down) and can take corrective action (such as restarting the 
              stopped service). Knowledge Scripts can also collect data for graphs 
              and reports.</p>
            <p> The Knowledge Scripts for the AppManager WMI Agent are configured 
              with preset parameters, as described in the following tables. The 
              table also lists the preset schedule for each Knowledge Script. 
              In the full NetIQ AppManager Suite, you can set the parameters and 
              schedule yourself, and perform many other forms of customization.</p>
			
            <p>The AppManager WMI Agent includes Knowledge Scripts in two categories:</p>
            <ul>
              <li><a href="#win2000">Knowledge Scripts that monitor basic Windows 
                NT/2000 resources</a><br>
                <br>
              </li>
              <li><a href="#wmi">Knowledge Scripts that monitor WMI resources</a></li>
            </ul>
            <p><b><a name="win2000"></a>Knowledge Scripts that monitor basic Windows 
              NT/2000 resources</b></p>
            <table border="0" cellspacing="0" cellpadding="3" class="table" width="420">
              <tr class="table" bgcolor="#006666"> 
                <td align="LEFT" width="120" valign="top"><b><font color="#FFFFFF">Knowledge 
                  Script</font></b></td>
                <td align="LEFT" width="300" valign="top"><b><font color="#FFFFFF">What 
                  it does</font></b></td>
              </tr>
              <tr> 
                <td class="table" width="120" valign="top"><p class="table">NT_CpuLoaded</p></td>
                <td width="300" valign="top">
                  <p class="table">Monitors the overall CPU load for a single-processor 
                    system (CPU processor instance 0) against the following thresholds:</p>
                  <ul class="table">
                    <li class="tabli">CPU usage: 90%</li>  
                    <li class="tabli">CPU queue length (the maximum number of 
                      processes waiting in the queue to run): 2</li>
                  </ul>
                  <p class="table">If both thresholds are exceeded, the Knowledge 
                    Script generates an event.</p>
                  <p class="table">Schedule: Every 30 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top"><p class="table">NT_MemUtil&nbsp;</p></td>
                <td width="300" valign="top"> 
                  <p class="table">Monitors the amount of memory usage against 
                    these thresholds:</p>
                  <ul class="table">
                    <li class="tabli">Physical m<span class="table"><span class="table"><span class="table">emory 
                      used: 80%</span></span></span></li>
                    <li class="tabli"><span class="table"><span class="table"><span class="table"> 
                      Virtual memory used: 80%</span></span></span></li>
                    <li class="tabli"><span class="table"><span class="table"><span class="table"> 
                      Paging file</span></span></span> used: 90%</li>
                  </ul>
                  <p class="table"> If any threshold is exceeded, the Knowledge 
                    Script generates an event.</p>
                  <p class="table">Schedule: Every 30 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top"><p class="table">NT_ServerBusy</p></td>
                <td width="300" valign="top"> 
                  <p class="table">Monitors Windows NT server activity against 
                    these thresholds:</p>
                  <ul class="table">
                    <li class="tabli"> Number of active sessions: 50</li>
                    <li class="tabli">Number of files open: 200</li>
                  </ul>
                  <p class="table">If either threshold is exceeded, the Knowledge 
                    Script generates an event.</p>
                  <p class="table">Schedule: Every 10 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top"><p class="table">NT_ServiceDown&nbsp;</p></td>
                <td width="300" valign="top">
                  <p class="table">Checks the status of all services that are 
                    configured to start automatically.&nbsp; If any service is 
                    not running, the Knowledge Script generates an event and restarts 
                    the service. The Graphing Data class returns a value of 100 
                    when a service is running and a value of 0 when a service 
                    is down.</p>
                  <p class="table">Schedule: Every 1 hour.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top"><p class="table">NT_TopCpuProcs&nbsp;</p></td>
                <td width="300" valign="top">
                  <p class="table">Monitors the percentage of CPU usage for all 
                    processes and identifies the top five processes consuming 
                    the most CPU. When the percentage of the total CPU usage exceeds 
                    90%, the Knowledge Script generates an event.</p>
                  <p class="table">Schedule: Every 30 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top"><p class="table">NT_TopMemoryProcs&nbsp;</p></td>
                <td width="300" valign="top">
                  <p class="table">Monitors the memory usage for all processes 
                    and identifies the top five processes consuming the most memory. 
                    When the total memory usage for all processes exceeds 10 MB, 
                    the Knowledge Script generates an event.</p>
                  <p class="table">Schedule: Every 30 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
            </table>
<p><a name="wmi"></a><b>Knowledge Scripts that monitor WMI resources</b></p>
            <table border="0" cellspacing="0" cellpadding="3" class="table" width="420">
              <tr class="table" bgcolor="#006666"> 
                <td align="LEFT" width="120" valign="top"><b><font color="#FFFFFF">Knowledge 
                  Script</font></b></td>
                <td align="LEFT" width="300" valign="top"><b><font color="#FFFFFF">What 
                  it does</font></b></td>
              </tr>
              <tr> 
                <td width="120" valign="top">
                  <p class="table">WMI_EventConsumer</p>
                </td>
                <td width="300" valign="top"> 
                  <p class="table">Queries the WMI event log and forwards any 
                    events that it finds to the AppManager event table. The events 
                    generated by this Knowledge Script depend on the type of WMI 
                    services installed on the managed computer.</p>
                  <p class="table">Schedule: Every 5 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top"> 
                  <p class="table">WMI_LogSizes</p>
                </td>
                <td width="300" valign="top"> 
                  <p class="table">Monitors the size of these WMI log files: winmgmt.log, 
                    mofcomp.log, wbemcore.log, wbemprox.log, and wmiprov.log.&nbsp; 
                    This Knowledge Script sets a maximum size of 10 KB for any 
                    individual log file and a maximum size of 30 KB for the sum 
                    of all log files. If either threshold is exceeded, the Knowledge 
                    Script generates an event.</p>
                  <p class="table">Schedule: Every 1 hour.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top">
                  <p class="table">WMI_ResourceHigh</p>
                </td>
                <td width="300" valign="top">
                  <p class="table">Monitors the CPU and memory consumption for 
                    WMI processes. If CPU usage exceeds 30%, or if memory usage 
                    exceeds 1 MB, the Knowledge Script generates an event.</p>
                  <p class="table">Schedule: Every 10 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
              <tr> 
                <td width="120" valign="top">
                  <p class="table">WMI_ServiceDown</p>
                  </td> 
                <td width="300" valign="top"> 
                  <p class="table">Monitors the Windows Management (WinMgmt) service. 
                    If the service is not running, the Knowledge Script generates 
                    an event and restarts the service. The Graphing Data class 
                    returns a value of 100 when a service is running and a value 
                    of 0 when a service is down.</p>
                  <p class="table">Schedule: Every 5 minutes.</p>
                </td>
              </tr>
              <tr> 
                <td colspan="2" width="100%" height="1" bgcolor="#006666"></td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
    <td>&nbsp;</td>
  </tr>
  <tr> 
    <td bgcolor="#FFFFFF" width="640" height="19" colspan="3" valign="top"><img src="line.gif" width="640" height="19"></td>
  </tr>
  <tr> 
    <td bgcolor="#FF9900" width="150" valign="top"><img src="logo.gif" width="150" height="66"></td>
    <td valign="top"> 
      <table border="0" width="450" cellspacing="0" cellpadding="0">
        <tr>
          <td width="20" height="20" valign="top"><img src="spacer.gif" width="10" height="10"></td>
          <td width="430" valign="top">
            <p class="smallprint">Copyright &copy; 1999, NetIQ Corporation. All 
              rights reserved.</p>
            </td>
        </tr>
      </table>
      <p>&nbsp;</p>
      </td>
    <td>&nbsp;</td>
  </tr>
</table>
</body>
</html>
