<HTML>
<HEAD>
<TITLE>WBEM PerlScript Example</TITLE>
<SCRIPT LANGUAGE="PerlScript"> 

use OLE;
use Win32::OLE;

	
	sub window_onload() 
	{
#		$loc = Win32::OLE->new("WbemScripting.SWbemLocator");
#		$service = $loc->ConnectServer();
		$service = $window->locator->ConnectServer();
		$service->{Security_}->{ImpersonationLevel}=3;
		$process = $service->Get('Win32_Service.Name="Winmgmt"');
		$window->document->{all}->info->{innerText} = $process->{DisplayName};
	}
</SCRIPT>
</HEAD>
<BODY>
The name of the service is 
<SPAN ID="info">
unknown
</SPAN>.
<OBJECT ID="locator" CLASSID="CLSID:76A64158-CB41-11D1-8B02-00600806D9B6"></OBJECT>
</BODY>
</HTML>
