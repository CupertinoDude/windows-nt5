//////////////////////////////////////////////////////////////////////////////////////////////
//
// ExceptionHandler.cpp
// 
// Copyright (C) 1998, 1999 Microsoft Corporation. All rights reserved.
//
// Abstract :
//
//   This is the implementation of CAppManExceptionHandler
//
// History :
//
//   05/06/1999 luish     Created
//
//////////////////////////////////////////////////////////////////////////////////////////////

#include "ExceptionHandler.h"
#include "AppManDebug.h"

//To flag as DBG_EXCEPTION
#ifdef DBG_MODULE
#undef DBG_MODULE
#endif

#define DBG_MODULE  DBG_EXCEPTION

//////////////////////////////////////////////////////////////////////////////////////////////
//
//////////////////////////////////////////////////////////////////////////////////////////////

CAppManExceptionHandler::CAppManExceptionHandler(void)
{
  FUNCTION("CAppManExceptionHandler::CAppManExceptionHandler (void)");

  m_hResult = E_UNEXPECTED;
}

//////////////////////////////////////////////////////////////////////////////////////////////
//
//////////////////////////////////////////////////////////////////////////////////////////////

CAppManExceptionHandler::CAppManExceptionHandler(HRESULT hResult, LPCSTR /*lpFilename*/, const DWORD /*dwLineNumber*/)      // Get rid of /W4 warning.
{
  FUNCTION("CAppManExceptionHandler::CAppManExceptionHandler (HRESULT hResult, LPCSTR lpFilename, const DWORD dwLineNumber)");

  m_hResult = hResult;
}

//////////////////////////////////////////////////////////////////////////////////////////////
//
//////////////////////////////////////////////////////////////////////////////////////////////

CAppManExceptionHandler::~CAppManExceptionHandler(void)
{
  FUNCTION("CAppManExceptionHandler::~CAppManExceptionHandler (void)");
}

//////////////////////////////////////////////////////////////////////////////////////////////
//
//////////////////////////////////////////////////////////////////////////////////////////////

STDMETHODIMP CAppManExceptionHandler::GetResultCode(void)
{
  FUNCTION("CAppManExceptionHandler::GetResultCode ()");

  return m_hResult;
}