<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Metabase Snapshot Writer and NT Backup</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="description" CONTENT="Describes Metabase Snapshot Writer and how it interacts with NTbackup. Describes restoring the Metabase using NTbackup.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="bak">Metabase Snapshot Writer</a></h1>

<h3>Metabase Snapshot Writer</h3>

<p>Metabase Snapshot Writer (MSW) uses COM interfaces to ensure NTbackup creates a stable and reliable backup of the metabase. MSW is automatically activated when NTbackup is called to back up the metabase.
MSW determines if one of the drive volumes NTbackup is assigned to back up contains the metabase.bin file. If so, MSW flushes the data from the metabase in RAM to the metabase.bin file. 
If not, MSW waits for the next call for NTbackup. Next, MSW prevents new information from being added to the RAM metabase for a maximum of two minutes, while NT Backup backs up metabase.bin. When NT Backup finishes, MSW releases the write lock on the metabase in RAM. The following graphic illustrates the MSW activation and functionality.</p>

<img src="iisnapshot.gif" alt="A graphic about how MSW works.">

<p class="note"><strong>Note</strong>&nbsp;&nbsp;&nbsp;Metabase Snapshot Writer supports NTbackup, it is not a part of the Configuration Backup/Restore application that runs from the <a href="iiabuti.htm">IIS snap-in</a>.</p>

<p><font color="#0000FF"><strong>Important</strong></font>&nbsp;&nbsp;&nbsp;NTbackup does not invoke Metabase Snapshot Writer when restoring the metabase.bin file. Before restoring the metabase with NTbackup, stop the WWW (World Wide Web Publishing) service to prevent IIS from writing to the metabase.bin file.</p>

<p><strong>Related Topics</strong></p>
<ul>
<li>For more information about NT backup, see the Windows documentation by selecting <strong>Help</strong> on the <strong>Start</strong> menu and search for the keyword "ntbackup."</li>
<li>For more information about stopping and restarting the WWW service, see <a href="iicodira.htm">Restarting IIS</a>.

<li>For an Introduction to the metabase, see </li><a href="../asp/aint1aud.htm">Introduction to the IIS Metabase</a>.</li>
<li>For information about Backing up the Metabase, see <a href="iitasks.htm">Backing Up the Metabase</a>.</li>
<li>For information about Restoring the Metabase, see <a href="iirestore.htm">Restoring the Metabase</a>.</li>

<span style="display:none"><LAYER VISIBILITY=HIDE> 
(The following words are used by Search; they are not intended to be displayed on the page.)
W3SVC, NTbackup NT Backup
</layer></span>

</font>
</body>
</html>
