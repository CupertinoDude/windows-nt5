<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Constructing an Interactive Form</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Procedural information on how to make a custom interactive form by using simple cut-and-paste and search-and-replace techniques on a sample script.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana, Arial, Helvetica">

<h1><a name="H1_42157057">Constructing an Interactive Form</a></h1>

<p>You can use IIS to get information from visitors to your Web site, and to respond to your visitors on the basis of the information they give you. This section provides a procedure that is designed to help you customize a simple interactive form to meet your information-gathering needs. The procedure assumes that you do not know HTML, a scripting language, or a programming language, and it does not teach you these. Instead, you will use cut-and-paste and search-and-replace techniques to construct a working form that sends data to a sample database included with IIS. Because the database is created in Microsoft Access, you can view and edit the gathered data either by opening the database in Access, or by using another script, which is provided in <a href="iivewdb.htm">Viewing a Database in a Browser</a>.</p>

<big>To create the Web page that gathers the data</big><!--</p>--><br>
<ol>
<li>Open the file Sampform.asp in a text editor such as Notepad. Sampform.asp is located in your Winnt\Help\Iishelp\Iis\Htm\Core directory.</li>
<li>Replace the text between the opening and closing &lt;title&gt;&lt;/title&gt; tags and the opening and closing &lt;h1&gt;&lt;/h1&gt; tags with a title and a heading for the page. If you have trouble finding the text, search for the word <em>Replace</em>.</li>
<li>Preview the file in your browser by typing the path and file name in the <strong>Address</strong> bar. Because you are viewing the file directly with a file-open command rather than having the Web server process it, the script at the beginning of the file is visible. When the file is served as a document on your Web site, the server removes the script from the page before sending the page to the visitor&#146;s browser.</li>
<p><strong>Tip</strong>&nbsp;&nbsp;&nbsp;If the heading seems too large for your page, reduce the height of the letters by changing the 1 in the opening and closing &lt;h1&gt;&lt;/h1&gt; tags to a 2.<!--</p>--><br>
<li>Save the file to your home directory. (C:\Inetpub\Wwwroot is the default home directory used by Setup). Save the file in text-only format with the name sampform.asp.</li>
<p><strong>Tip</strong>&nbsp;&nbsp;&nbsp;To prevent Notepad from adding .txt to the file name, select <strong>All Files(*.*)</strong> as the <strong>Save as Type</strong> option.<!--</p>--><br>
</ol>

<h2><a name="H2_42159556">Adding Elements</a></h2>

<p>You are now ready to paste in the sections of script that display elements such as text boxes, check boxes, and radio buttons. You can add these in any order. You are not required to use all the elements in your page, but each element can only be used once. For instance, the element called First Text Box can only be used once. If you need another text box, you must use either Second Text Box, or one of the memo boxes for the next text box on the page. The following is a list of the form elements available:</p>

<table border="1" cellpadding="4" cellspacing="1" width="90%">
<tr>
<th bgcolor='#C0C0C0' width="21%">Element Name</th>
<th bgcolor='#C0C0C0' width="30%">Element</th>
<th bgcolor='#C0C0C0' width="49%">Description</th></tr>
<tr><td>First Text Box</td>
<td rowspan="4">Label:<br><input  type="TEXT" size="25"></td>
<td rowspan="4">These four text boxes can be used for input expected to be less that 255 characters. Use these for items such as names or e-mail addresses.</td></tr>
<tr><td>Second Text Box</td></tr>
<tr><td>Third Text Box</td></tr>
<tr><td>Fourth Text Box</td></tr>
<tr><td>First Memo Box</td>
<td rowspan="2">Label:<br><textarea name="FirstMemoBox" rows="4" cols="30"></textarea></td>
<td rowspan="2">These two boxes have unlimited length and can be used when content may be large. Use these in places where visitors are invited to leave comments.</td></tr>
<tr><td>Second Memo Box</td></tr>
<tr><td>First Check Box</td>
<td rowspan="2"><input type="CHECKBOX">Label</td>
<td rowspan="2">These boxes return True if the item is checked and False if the item is not checked. Selecting one of these boxes has no effect on the other box.</td></tr>
<tr><td>Second Check Box</td></tr>
<tr><td>Radio Buttons</td>
<td><input type="RADIO">Label:<br><input type="RADIO">Label:<br><input type="RADIO">Label:
<td>This element give users a single, mutually exclusive choice of three options. If the user selects the first option, 1 is returned. If the user selects the second option, 2 is returned. If the user selects the third option, 3 is returned.</td></tr>
</table>
<p>&nbsp;</p>

<big>To add the fields to your form</big><!--</p>--><br>
<ol>
<li>It is a good idea to plan your form by using the list of available elements above and sketching the form on a piece of paper before creating the page online. That way you can experiment with different elements and how you might want to place them.</li>
<li>Copy and paste the following sections of code into your Web page by using the order you sketched out in step 1. Be sure that all your code is placed after the &lt;!-- ===Paste form elements below this line=== --&gt; comment and before the &lt;!-- ===Paste form elements above this line== --&gt; comment.</li>

<p><strong>Tip</strong>&nbsp;&nbsp;&nbsp;When you copy, if you include the starting and ending comments before and after each section of code, your finished page is much easier to read and edit at a later date. The comments are not displayed on the page when viewed in a browser. <!--</p>--><br>
<pre>
&lt;!-- ===Start First Text Box Element Section=== --&gt;

&lt;p&gt; Replace this text with a label or caption for the first text box: &lt;/p&gt;
&lt;p&gt;&lt;input type="Text" name="FirstTextBox"&gt;&lt;/p&gt;

&lt;!-- ===End First Text Box Element Section=== --&gt;



&lt;!-- ===Start Second Text Box Element Section=== --&gt;

&lt;p&gt; Replace this text with a label or caption for the second text box: &lt;/p&gt; 
&lt;p&gt;&lt;input type="Text" name="SecondTextBox"&gt;&lt;/p&gt;

&lt;!-- ===End Second Text Box Element Section=== --&gt;



&lt;!-- ===Start Third Text Box Element Section=== --&gt;

&lt;p&gt; Replace this text with a label or caption for the third text box: &lt;/p&gt;
&lt;p&gt;&lt;input type="Text" name="ThirdTextBox"&gt;&lt;/p&gt;

&lt;!-- ===End Third Text Box Element Section=== --&gt;



&lt;!-- ===Start Fourth Text Box Element Section=== --&gt;

&lt;p&gt; Replace this text with a label or caption for the fourth box: &lt;/p&gt;
&lt;p&gt;&lt;input type="Text" name="FourthTextBox"&gt;&lt;/p&gt;

&lt;!-- ===End Fourth Text Box Element Section=== --&gt;



&lt;!-- ===Start First Memo Box Element Section=== --&gt;

&lt;p&gt; Replace this text with a label or caption for the first memo box: &lt;/p&gt; 
&lt;p&gt;&lt;textarea name="FirstMemoBox" rows=6 cols=70&gt;&lt;/textarea&gt;&lt;/p&gt;

&lt;!-- ===End First Memo Box Element Section=== --&gt;



&lt;!-- ===Start Second Memo Box Element Section=== --&gt;

&lt;p&gt; Replace this text with a label or caption for the second memo box: &lt;/p&gt;
&lt;p&gt;&lt;textarea name="SecondMemoBox" rows=6 cols=70&gt;&lt;/textarea&gt;&lt;/p&gt;

&lt;!-- ===End Second Memo Box Element Section=== --&gt;



&lt;!-- ===Start First Check Box Element Section=== --&gt;

&lt;p&gt;&lt;input type="CHECKBOX" name="FirstCheckBox" value="true" &gt; Replace this text with a label or caption for the first check box: &lt;/p&gt;

&lt;!-- ===End First Check Box Element Section=== --&gt;



&lt;!-- ===Start Second Check Box Element Section=== --&gt;

&lt;p&gt;&lt;input type="CHECKBOX" name="SecondCheckBox" value="true" &gt; Replace this text with a label or caption for the second check box: &lt;/p&gt;

&lt;!-- ===End Second Check Box Element Section=== --&gt;



&lt;!-- ===Start Radio Buttons Element Section=== --&gt;

&lt;p&gt;&lt;input name="RadioButtons" type="RADIO" value="1"&gt; Replace this text with a label or caption for the first option. &lt;br&gt;
&lt;input name="RadioButtons" type="RADIO" value="2"&gt; Replace this text with a label or caption for the second option. &lt;br&gt;
&lt;input name="RadioButtons" type="RADIO" value="3"&gt; Replace this text with a label or caption for the third option. &lt;/p&gt;

&lt;!-- ===End Radio Buttons Element Section=== --&gt;
</pre>

<li>Replace the text labels accompanying each element with appropriate text. To find these quickly and easily, search for the word <em>Replace</em>.</li>
<li>Save the changes you have made to your file.</li>
<li>Preview the file in your browser to be sure the elements are in the correct order and that the text labels are displaying correctly. Again, you can ignore the script that is visible at the top of the page above the heading. If you do not see the changes you have made, use the browser&#146;s Refresh button.</li>
</ol>

<h2><a name="H2_42165875"></a>Accessing the Database</h2>

<p>Now that the form is complete, you must edit the statements that insert data into the database so they match the fields in your form. The Sampform.asp file contains references to all the available fields and the input they receive. You must remove the references for elements you did not include in your form. The following table displays the element name and the corresponding field name.</p>

<table border="1" cellpadding="4" cellspacing="1" width="40%">
<tr>
<th bgcolor='#C0C0C0'>Element</th>
<th bgcolor='#C0C0C0' align=middle>Field Name</th></tr>
<tr>
<td>First Text Box</td><td align=middle>TB1</td></tr>
<tr>
<td>Second Text Box</td><td align=middle>TB2</td></tr>
<tr>
<td>Third Text Box</td><td align=middle>TB3</td></tr>
<tr>
<td>Fourth Text Box</td><td align=middle>TB4</td></tr>
<tr>
<td>First Memo Box</td><td align=middle>MB1</td></tr>
<tr>
<td>Second Memo Box</td><td align=middle>MB2</td></tr>
<tr>
<td>First Check Box</td><td align=middle>CB1</td></tr>
<tr>
<td>Second Check Box</td><td align=middle>CB2</td></tr>
<tr>
<td>Radio Buttons</td><td align=middle>RB</td></tr>
</table><br>

<big>To edit the database field references</big><!--</p>--><br>

<ol>
<li>Search for the text <em>cm.commandtext=</em> to find the insert statement.</li>
<li>Inside the parentheses following the word <em>SampleDb</em> are all of the database field names separated by commas. Delete any field name you are not using, and the separating comma that follows that name. For example, if you used only the First Text Box, Second Text Box, and First Check Box, your field section would now appear as: SampleDb(TB1,TB2,CB1)</li>
<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;Regardless of the order of the elements on your page, do not change the order of the field names in the statement.</p>
<li>Inside the parentheses following the word <em>VALUES</em> are nine questions marks separated by commas. The number of question marks must equal the number of elements you used in your form. Delete extra question marks, and the separating comma that follows the question mark. For example, if you used only the First Text Box, Second Text Box,and First Check Box, your values section would now appear as: VALUES (?,?,?)</li>
<li>Following the the <em>cm.commandtext=</em> statement are the parameter statements. For any elements you did not use in your page, place an apostrophe before each of the two lines listed below the element parameter statement. For example, if you did not use the Second Text Box, the statement would now appear as:</li>

<p>'Second Text Box Parameter Statement<br>
'set objparam=cm.createparameter(, 200, , 255, strTB2)<br>
'cm.parameters.append objparam<!--</p>--><br>

<li>Save your changes and preview your file by typing <strong>//Localhost/Sampform.asp</strong> in the <strong>Address</strong> bar of the browser.</li>
</ol>


<p><strong>Related Topics</strong></p>
<ul>
<li>For more information on using interactive forms and databases, see <a href="../asp/iiwadata.htm">Accessing a Data Source</a>.</li>
<li>To use a script to view your database, see <a href="iivewdb.htm">Viewing a Database in a Browser</a>.</li>
</ul>


<hr class="iis" size="1"><p align=center><em><a href="../../../common/colegal.htm">&copy; 1997-1999 Microsoft Corporation. All rights reserved.</a></em></p> 

</font>
</body>
</html>
