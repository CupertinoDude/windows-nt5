<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Restarting IIS</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Restarting the IIS Services">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="restart">Restarting IIS</a></h1>

<p>With IIS, you can stop and restart your computer when applications misbehave or become unavailable. Because several Internet services run in one process, Internet services shut down and restart differently from other Windows services, you should use  the <a href="iiabuti.htm">IIS snap-in</a> and not the Computer Management Services snap-in to restart your Internet services. Using Reliable Restart, IIS automatically restarts when applications become defective. If you do not want IIS to restart automatically, see <a href="#relirestart">To disable Reliable Restart</a> below.</p> 

<big>To restart IIS</big><br>

<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a> select the <strong>Computer</strong> icon for which you wish to restart IIS, and click <strong>Action</strong>. 
<li>Click <strong>Restart IIS</strong>. The Stop/Start/Reboot dialog box appears.</li>
<li> From the drop-down menu, select <strong>Restart Internet Services</strong>.</li>

<p><b>Note</b>&nbsp;&nbsp;You also have the option to Start Internet Services, Stop Internet Services, or Reboot the computer. To stop Internet services, you must disable Reliable Restart.</p>

<li type="1">Click <b>OK</b>. IIS restarts the Web service on the selected computer.</li>
</ol>


<h3>Reliable Restart</h3>
<p>Reliable Restart automatically restarts your Internet services if the Inetinfo.exe process terminates abnormally or if you use Windows Task Manager or Kill.exe to stop Internet services. Reliable Restart is enabled by default. You must disable Reliable Restart to restrict this automatic restart feature.</p>

<p><big><a name="relirestart">To disable Reliable Restart</a></big></p>
<ol>
<li>Right-click <strong>My Computer</strong>, and click <b>Manage</b>. The Computer Management window appears</li>.
    
<li>Expand the <strong>Services and Applications</strong> tree in the left pane, and click <b>Services</b>. All Windows services display in the right pane.</li> 
    
<li>Right-click <strong>IIS Admin Service</strong>, and click <b>Properties</b>. The IIS Admin Service Properties dialog box appears.</li>
<li>Click the <strong>Recovery</strong> tab, and choose <strong>Take No Action</strong> for each of the drop-down menus.</li>
<li>Click <b>OK</b>. </li>
</ol>

<h3>Restarting IIS using the command-line</h3>
<p>You can also restart IIS and disable Reliable Restart using the command prompt and Iisreset.exe. See the following command-line usage and parameters.</p>

<font face="courier">
<table border="0" cellpadding="4" cellspacing="1" width="95%">

<tr>
<td align="Left" valign="top" colspan="2"><a name="timeout"><strong>iisreset [computername]</strong><br>&nbsp;</a></td>
</tr>

<tr>
<td valign="Top">/RESTART</td>
<td valign="Top">Stop and then restart all Internet services.</td>
</tr>

<tr>
<td valign="Top">/START </td>
<td valign="Top">Start all Internet services.</td>
</tr>

<tr>
<td valign="Top">/STOP</td>
<td valign="Top">Stop all Internet services.</td>
</tr>

<tr>
<td valign="Top">/REBOOT </td>
<td valign="Top">Reboot the computer.</td>
</tr>

<tr>
<td valign="Top">/REBOOTONERROR&nbsp;&nbsp</td>
<td valign="Top">Reboot the computer if an error occurs when starting, stopping, or restarting Internet services.</td>
</tr>

<tr>
<td valign="Top">/NOFORCE</td>
<td valign="Top">Do not forcefully terminate Internet services if attempting to stop them gracefully fails.</td>
</tr>

<tr>
<td valign="Top">/TIMEOUT:val</td>
<td valign="Top">Specify the <a href="iitime.htm#timetable">timeout value</a> (in seconds) to wait for a successful stop of Internet services. On expiration of this timeout the computer can be rebooted if the /REBOOTONERROR parameter is specified. The default value is 20s for restart, 60s for stop, and 0s for reboot.</td>
</tr>

<tr>
<td valign="Top">/STATUS</td>
<td valign="Top">Display the status of all Internet services.</td>
</tr>

<tr>
<td valign="Top">/ENABLE </td>
<td valign="Top">Enable restarting of Internet Services on the local system.</td>
</tr>

<tr>
<td valign="Top">/DISABLE</td>
<td valign="Top">Disable restarting of Internet Services on the local system.</td>
</tr>

</table>
</font>


<p><strong>Related Topics</strong></p>

For information on starting and stopping individual Web and FTP sites, see <a href="iiststp.htm">Starting and Stopping Sites</a>.


<hr class="iis" size="1"><p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>


</font>
</body>
</html>
