<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Viewing a Database in a Browser</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Procedural information on how to use a script to view and delete data in the sample database.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana, Arial, Helvetica">

<h1><a name="H1_42173908"></a>Viewing a Database in a Browser</h1>

<p>Using a database to collect information left by visitors is a safe and simple way to make your Web site more useful. Once information is entered into a database, you can either open the database in the application in which it was originally created, or you can set up a Web page containing another script so you can view and edit the data with a Web browser. This topic provides a sample script you can use without editing to view the sample database provided with IIS. You can give visitors access to this script if you want them to be able to view the database. You can also customize the script to delete data in the sample database, or you can change the script to view other databases you have created.</p>

<big>To view the sample database in a browser</big><br>

<ol>
<li>Copy Viewdb.asp from your Winnt\Help\Iishelp\Iis\Htm\Core directory to Winnt\System32\Inetsrv\Iisadmin\Tour directory.</li>
<li>Open your browser and connect to <a href="http://localhost/iisadmin/tour/viewdb.asp">http://Localhost/Iisadmin/Tour/Viewdb.asp</a>.</li>
<p><strong>Tip</strong>&nbsp;&nbsp;&nbsp;If you plan to view your database frequently, add this address to your Favorites list by using the Favorites feature of your Web browser. When you view the database, always refresh the page to be sure you are seeing the current data, and not a cached copy that is out of date.<br>

<p><strong><span style="color: #0000FF"><font color="#0000FF">Important</font></span></strong>&nbsp;&nbsp;&nbsp;The Tour folder has special permissions that prevent access to any pages stored here, unless the access is made from the local computer. Remote visitors are not able to view the contents of the Tour folder in their browsers.</p>
</ol>

<p class="bigfix">&nbsp;</p>
<big>To delete entries from the database by using a browser</big><br>

<ol>
<li>Copy Viewdb.asp from your Winnt\Help\Iishelp\Iis\Htm\Core directory to Winnt\System32\Inetsrv\Iisadmin\Tour directory.</li>
<li>Open the file in a text editor, such as Notepad.</li>
<li>Search for the text <em>'Response.Write "&lt;td width=&gt;&lt;center&gt;Delete Record&lt;/center&gt;&lt;/td&gt;"</em> and remove the apostrophe at the beginning of the line.</li>
<li>Search for the text <em>'Response.Write "&lt;td align=left valign=top bgcolor='#ffffff'&gt;&lt;a href=viewdb.asp?id=" & rst(0) & "&gt;Delete&lt;/a&gt;&lt;/td&gt;"</em> and remove the apostrophe at the beginning of the line.</li>
<li>Save the file in text-only format with the name Viewdb.asp.</li>
<p><strong>Tip</strong>&nbsp;&nbsp;&nbsp;To prevent Notepad from adding .txt to the file name, select <strong>All Files(*.*)</strong> as the <strong>Save as Type</strong> option.<br>
<li>Open your browser and connect to <a href="http://localhost/iisadmin/tour/viewdb.asp">http://Localhost/Iisadmin/Tour/Viewdb.asp</a>.</li>
<li>To delete a row, click the <strong>Delete</strong> link in the left column of the row.</li>
<p><strong><font color="#FF0000">Caution</strong></font>&nbsp;&nbsp;&nbsp;Deleting a row cannot be undone.<br> 
</ol>

<p class="bigfix">&nbsp;</p>
<big>To allow visitors to view or delete database entries</big><br>

<ol>
<li>Copy Viewdb.asp from your Winnt\Help\Iishelp\Iis\Htm\Core directory to your home directory. (C:\Inetpub\Wwwroot is the default home directory used by Setup).</li>
<li>Search for the text <em>'Database path statement for restricted viewing of the database.</em> and place an apostrophe in front of the <em>strProvider</em> line directly below it.</li>
<li>Search for the text <em>'Database path statement to allow visitors to view the database.</em> and remove the apostrophe in front of the <em>strProvider</em> line directly below it.</li>
<li>If you want visitors to be able to delete entries in the database, make the modifications described in the earlier deleting entries procedure.</li>
<li>Add a link to the Viewdb.asp page on your home page.</li>
</ol>

<p><strong>Related Topics</strong></p>
<ul>
<li>For more information on using interactive forms and databases, see <a href="../asp/iiwadata.htm">Accessing a Data Source</a>.</li>
<li>To use a form to send data to your database, see <a href="iiconfm.htm">Constructing an Interactive Form</a>.</li>
</ul>

<hr class="iis" size="1"><p align=center><em><a href="/iishelp/common/colegal.htm">&copy; 1997-1999 Microsoft Corporation. All rights reserved.</a></em></p> 

</font>
</body>
</html>
