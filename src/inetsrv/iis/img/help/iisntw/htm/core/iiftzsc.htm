<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html><head><title>Using Fortezza Security in IIS</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="description" CONTENT="Includes conceptual and procedural information on Fortezza security features, such as smart cards.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">
<h1><A NAME="H1_448399553"></A>Using Fortezza Security in IIS</h1>

<h2><A NAME="H2_448399642"></A>Fortezza Background</h2>

<p>The U.S. government security standard, commonly called Fortezza, is supported in IIS. This standard satisfies the Defense Message System security architecture with a cryptographic mechanism that provides message confidentiality, integrity, authentication, and access control to messages, components, and systems. These features can be implemented both with server and browser software and with PCMCIA card hardware. Fortezza is a widely used mechanism within the U.S. government. For more information see the Fortezza Developer's Guide (run by the National Security Agency and the U.S. Department of Defense) at <a HREF="http://go.microsoft.com/fwlink/?LinkId=1769" target="_blank"><b>Fortezza</b></a>.</p>

<h2><A NAME="H2_448400416"></A>Using Fortezza</h2>

<p>To implement Fortezza security in IIS, perform the following procedures. These steps will fully integrate your Fortezza schema into IIS, so that you can operate in accordance with the standards outlining Fortezza security.</p>

<h3>To Use Fortezza Certificates</h3>

<p>A Fortezza card (a type of PCMCIA card, similar to those used in notebook computers and other small devices) contains a user certificate to authenticate the user of the card; this certificate works in much the same way that server and client certificates work in IIS. To make these Fortezza certificates available to IIS, you must copy them to a secure store on the computer:</p>

<ol>
	<li>Obtain a non-export copy of Schannel.dll from the <A HREF="http://www.microsoft.com/isapi/redir.dll?prd=ie&ar=security" target="_blank">Microsoft Web site</A> at http://www.microsoft.com/security/.</li>
	<li>Install the card reading equipment and its drivers. For information, see the card reader documentation.</li>
	<LI>Install the Cryptographic Service Provider (CSP) provided by the equipment supplier. For information, see the card reader documentation.</LI>
	<LI>Run the command&#150;line utility <STRONG>Fortutil.exe</STRONG>.</LI>
</ol>

<P>The utility provides functions that can install, confirm, and delete that the card certificate and other associated information. To enable this feature, type the appropriate commands at the command line:</P>

<TABLE BORDER="1" CELLSPACING="2" CELLPADDING="2">
<TR BGCOLOR="#C0C0C0">
	<TD ALIGN="CENTER"><STRONG>Action</STRONG></TD>
	<TD ALIGN="CENTER"><STRONG>Command</STRONG></TD>
	<TD ALIGN="CENTER"><STRONG>Parameters</STRONG></TD>

</TR>

<TR>
	<TD><STRONG>Add certificate</STRONG></TD>
	<TD><code>fortutil.exe /a</code></TD>
	<TD>Web site name; Card serial number; PIN; card personality</TD>

</TR>
<TR>
	<TD><STRONG>Confirm certificate</STRONG></TD>
	<TD><code>fortutil.exe /q</code></TD>
	<TD>Web server name</TD>
</TR>
<TR>
	<TD><STRONG>Delete certificate</STRONG></TD>
	<TD><code>fortutil.exe /r</code></TD>
	<TD>Web site name</TD>
</TR>
<TR>
	<TD><STRONG>Help</STRONG></TD>
	<TD><code>fortutil.exe /?</code></TD>
	<TD>None</TD>
</TR>
</TABLE>


<p><STRONG>Note</STRONG>&nbsp;&nbsp;&nbsp;Any Fortezza certificates copied to the server can be used as certificate in the Web Server Certificate Wizard, CTL Wizard, or the Windows certificate features.</p>



<p><strong><font color="#0000FF">Important</font></strong>&nbsp;&nbsp;&nbsp;If the card is removed from the reader while the Web service is running and then re-inserted, it might cause SSL connection errors. If these errors occur, the Web service needs to be restarted with the card in the reader.</P>

<hr class="iis" size="1"><p align=center><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
