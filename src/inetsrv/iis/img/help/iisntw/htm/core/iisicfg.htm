<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>

<TITLE>#config</TITLE>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information. The #config directive specifies the format used for error messages, dates, and file sizes returned to the client browser.">

<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000"><font face="Verdana,Arial,Helvetica">

<H2><A NAME="_k2_config"></A>#config</H2>

<P>The <b> #config</b> directive specifies the string to be used for SSI error messages, and the format to be used for dates and file sizes returned by #flastmod, #fsize. You must surround a directive with HTML comment delimiters.</P>

<P>By default, this directive can be used only in STM pages; it cannot be used in ASP pages. To perform these tasks with ASP script, you can use
the <b> FileSystemObject</b> object which is documented at <a href="http://www.microsoft.com/isapi/redir.dll?prd=msdn&amp;pver=6.0&amp;ar=scripting" target="_blank">MSDN</a> under VBScript or
JScript.</P>

<h6><STRONG>Syntax</STRONG></h6>

<P><STRONG>&lt;!-- #config </STRONG><em>Output</em><STRONG> = </STRONG><em>String</em> <STRONG>--&gt;</STRONG></P>

<h6><STRONG>Parameters</STRONG></h6>

<P><em>Output</em></P>

<P>Specifies the output to be formatted. The output can be one of the following:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all width=100%>

<TR VALIGN="top">
<TD width=20%><STRONG>Output</STRONG></TD>
<TD width=80%><STRONG>Meaning</STRONG></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>ERRMSG</TD>
<TD width=80%>Overrides the message returned to the client browser when an error occurs during the processing of an SSI directive. By default, the error message provides debugging information that details exactly what went wrong. To suppress these details, provide a short, simple error message, such as "An SSI error has occurred." The
  <i> String</i> parameter contains the new error message.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>TIMEFMT</TD>
<TD width=80%>Specifies the format in which dates should be returned to the client browser with the #flastmod directive. The String parameter specifies the format. You can extract individual portions of the date, such as the day of the week or the month, by using formatting tokens in String. (The formatting tokens are the same as those you would use for the ANSI C strftime function).
  <p><font face="Verdana,Arial,Helvetica"><strong>Note</strong>&nbsp;&nbsp;The time and date functions below use the language set with the C library locale rather than the operating system locale. The C library locale is usually set to English.</font></p>
<P>%a</P>

<P>Abbreviated name for day of the week (for example, Mon).</P>

<P>%A</P>

<P>Complete name for day of the week (for example, Monday). </P>

<P>%b</P>

<P>Abbreviated month name (for example, Feb).</P>

<P>%B</P>

<P>Complete month name (for example, February).</P>

<P>%c</P>

<P>Date and time representation that is appropriate for the C locale (for example, 05/06/01 12:51:32).</P>

<P>%d</P>

<P>Day of the month as a decimal number (01–31)</P>

<P>%H</P>

<P>Hour in 24-hour format (00–23).</P>

<P>%I</P>

<P>Hour in 12-hour format (01–12).</P>

<P>%j</P>

<P>Day of the year as a decimal number (001–366).</P>

<P>%m</P>

<P>Month as a decimal number (01–12).</P>

<P>%M</P>

<P>Minute as a decimal number (00–59).</P>

<P>%p</P>

<P>Current C locale's A.M. or P.M. indicator for 12-hour format (for example, PM).</P>

<P>%S</P>

<P>Second as a decimal number (00–59).</P>

<P>%U</P>

<P>Week of the year as a decimal number, with Sunday as the first day of the week (00–51).</P>

<P>%w</P>

<P>Day of the week as a decimal number, with Sunday as the first day (0–6).</P>

<P>%W</P>

<P>Week of the year as a decimal number, with Monday as the first day of the week (00–51).</P>

<P>%x</P>

<P>Date representation for the current C locale (for example, 05/06/01).</P>

<P>%X</P>

<P>Time representation for the current C locale (for example, 12:51:32).</P>

<P>%y</P>

<P>Year without the century as a decimal number (for example, 01).</P>

<P>%Y</P>

<P>Year with the century as a decimal number (for example, 2001).</P>

<P>%z, %Z</P>

<P>Time-zone name or abbreviation; no characters if time zone is unknown.</P>

<P>%%</P>

<P>Percent sign.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=18%>SIZEFMT</TD>
<TD width=82%>Configures the output of the #fsize directive to display the file size in kilobytes or bytes. The String parameter can have one of two values: "ABBREV" displays file size in kilobytes, and "BYTES" displays file size in bytes.</TD>
</TR>
</TABLE><BR>

<P><strong><font color="#0000FF">Important</strong></font>&nbsp;&nbsp;&nbsp;The file containing this directive must use a file name extension that is mapped to the SSI interpreter; otherwise, the Web server will not process the directive. By default, the file name extensions .stm, .shtm, and .shtml are mapped to the SSI interpreter
(ssinc.dll).</P>

<P>An STM page using the #echo directive must be run by itself, or by calling it from an ASP page with Response.Redirect. Calling an STM page from an ASP page with Server.Transfer, Server.Execute, or #include will not work because that would force the STM page to go through asp.dll instead of through ssinc.dll.</P>

<P>If you have the <a href="iiabuti.htm">IIS Snap-in</a> installed, you can modify default extension mappings and add new mappings;
<font face="Verdana,Arial,Helvetica">

see <A HREF="iiwarndf.htm">Setting Application Mappings</A>.

</font>
 Since you cannot map a file extension to more than one executable, you cannot use this directive in ASP files. ASP files are already mapped to the asp.dll and must stay that way.</P>

<H6><b>Example</b></H6>

<p>--- SSI.stm ---</p>

<PRE>&lt;!-- #config ERRMSG = &quot;An error occurred processing a directive.&quot; --&gt;</PRE>

<PRE>SSI.stm was last formatted on 
&lt;!-- #config TIMEFMT = &quot;%A, the %d of %B, %Y, at %H:%M&quot; --&gt;
&lt;!-- #flastmod FILE = &quot;ssi.stm&quot; --&gt;
&lt;BR&gt;

The size of SSI.stm in bytes is
&lt;!-- #config SIZEFMT = &quot;BYTES&quot; --&gt;
&lt;!-- #fsize FILE = &quot;ssi.stm&quot; --&gt;
&lt;BR&gt;&lt;BR&gt;

This line will print out the ERRMSG configured above&lt;BR&gt;
&lt;!-- #config SIZEFMT = &quot;BYTE&quot; --&gt;
</PRE>

<hr class="iis" size="1">
<p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</BODY>
</HTML>
