<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Enabling Client Certificates</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="description" CONTENT="Procedural information on how to require users to log on with a client certificate when they attempt to access restricted directories and files.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="enablingcertificates">Enabling Client Certificates</a></h1>

<p>You can require users attempting to access your Web site to log on with a client certificate. Requiring a client certificate, however, does not protect your content from unauthorized access. Any user with a client certificate can establish a secure connection and access your resource.  To protect your Web content from unauthorized access you must do either of the following:</p>

<ul>
<li>Use Basic, Digest, or integrated Windows authentication, in addition to requiring a client certificate.</li>
<li>Create a Windows account mapping for client certificates. For more information, see <a href="iimapsc.htm">Mapping Client Certificates to User Accounts</a>.</li>
</ul>

<p><strong><font color="#0000FF">Important</font></strong></p>

<ul>
<li>Your Web server cannot process client certificates unless you have previously installed a server certificate and enabled your server's secure communication features. For more information about authentication and certificates, see <a href="iiabasc.htm">About Authentication</a> and <a href="iiocrsc.htm">Obtaining a Server Certificate</a>.</li>
<li>When you attempt to set properties for a specific Web site, your Web server will prompt you for permission to reset the properties of individual directories and files in the Web site.  If you choose to reset these properties, your previous  settings will be replaced by the new settings. The is also true for setting properties for a directory containing subdirectories or files with previously set security properties.  For more information about setting properties, see Properties and Inheritance of Properties on Sites  in <a href="iivsovr.htm">About Web and FTP Sites</a>.</li>
</ul>

<p class="bigfix">&nbsp;</p>

<big>To enable client certificates</big><br>

<ol>	
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, select a Web site, directory, or file, and open its property sheets.</li>
<li>If you have not previously obtained a server certificate, select the <strong>Directory Security</strong> property sheet, under <strong>Secure Communications</strong>, click <strong>Server Certificate</strong>. For more information, see <a href="iikeysc.htm">Using the New Security Task Wizards</a>.</li>
<li>If you have previously obtained a server certificate, select the <strong>Directory Security</strong> or <strong>File Security</strong> property sheet, then under <strong>Secure Communications</strong>, click <strong>Edit</strong>.</li>
<li>In the <strong>Secure Communications</strong> dialog box, select the <strong>Require secure channel (SSL)</strong> check box.  Requiring  a secure channel means that user cannot connect to this site without using a secure link (that is, the link's URL must begin with https://).</li>
<li>Under <strong>Client certificates</strong> select one of the following to enable client certificate authentication:</li>

<ul>
<li><strong>Accept client certificates</strong>&nbsp;Users can access the resource with a client certificate, but the certificate is not required.</li>
<li><strong>Require client certificates</strong>&nbsp;The server will request a client certificate before connecting the user to the resource.  Users without a valid client certificate will be denied access.</li>
<li><strong>Ignore client certificates</strong>&nbsp;Users with or without a client certificate will be granted access.</li>
</ul>

</ol>


<hr class="iis" size="1">
<p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
