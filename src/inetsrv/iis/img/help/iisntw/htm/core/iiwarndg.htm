<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Installing ISAPI Filters</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Procedural information on how to install an ISAPI filter on a Web site.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="installingisapifilters">Installing ISAPI Filters</a></h1>

<p>Like ISAPI extensions, ISAPI filters are programs that respond when the Web server receives an HTTP request. However, unlike ISAPI extensions, ISAPI filters are always run in the server process.ISAPI filters are different from applications because they are driven by Web server events rather than by a client request. You can associate an ISAPI filter with a particular Web server event; the filter is then notified every time its associated event occurs.  For example, a filter could be notified when a Read or Write event occurs and then encrypt the raw data to be returned to the client.</p>

<p>You can install filters for all sites on a server (global filters), and you can install filters for individual Web sites.  If you install both global filters and site filters, the two filter lists are merged for the site.</p>

<p>When several filters have registered for the same event, they are called sequentially.  Filters with a higher priority are run before filters with a lower priority.  If several filters have the same priority, global filters set in the master properties are run before filters set at the site level.  Filters with the same priority at the same inheritance level are run according to the order in which they were loaded. You can change the filter load order on the property sheets for the Web server or Web site.</p> 

<big>To add a filter to a Web server or Web site</big><!--</p>--><br>

<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, select the Web server or Web site, and open its property sheets.</li>
<li>Click the <strong>ISAPI Filters</strong> tab.</li>

<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;If you are adding filters to a Web site, you will not see any global filters inherited from the Web server's master properties.  You will see only the filters installed for the Web site, even though both sets of filters are run.</p>

<li>Click the <strong>Add</strong> button.</li>
<li>Type the name of the filter in the <strong>Filter Name</strong> box and either type or browse for the DLL file in the <strong>Executable</strong> box.</li>
<li>Click <strong>OK</strong>.</li>
<li> To change the load order of a filter, use the arrows.</li>

<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;You can only change the load order of filters with the same priority.</p>

<li>If you have added or changed a global filter, you must stop and restart the Web server to load the new filters into memory.  A filter added at the Web site level is automatically loaded when you add it.</li>
</ol>

<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;If an HTTP request triggers an event for which the filter is registered, the filter will receive the data contained in the request regardless of whether the request is for a file, a CGI application, or an ISAPI extension.</p>

<hr class="iis" size="1"><p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
