<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Caching Applications</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Procedural topic explaining how to set CGI script timeouts, cache ISAPI DLLs, and change the cache size for ASP pages.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="H1_37719647">Caching Applications</a></h1>

<p>By adjusting several settings associated with Web applications that run on your server, you can fine-tune server performance. Logging usage data, such as number of requests and the time they were made, can help you determine how to make the adjustments.  For more information on logging server activity, see <a href="iilogsa.htm">Logging Web Site Activity</a>. For additional information on performance issues, see <a href="iiabtpm.htm">About Performance Tuning</a>.</p>

<p>The following settings are covered:</p>

<ul>
<li>Setting the CGI Script Timeout</li>
<li>Caching ISAPI extensions</li>
<li>Caching ASP Script Files</li>
</ul>

<h2><a name="H2_37720440">Setting the CGI Script Timeout</a></h2>

<p>In addition to the timeout associated with the connection, you can set a timeout value for CGI scripts. The timeout value is the amount of time a CGI script is given to execute.  CGI applications inherit the timeout setting for the entire Web site.  You can change the setting for the entire Web site or for an isolated application.</p>

<big>To set the timeout value:</big><br>

<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, select the <strong>Computer</strong> icon, and open its property sheets. </li>

<li>Under <strong>Master Properties</strong>, select <strong>WWW Service</strong>, and click the <strong>Edit</strong> button.</li>
<li>Click the <strong>Home Directory</strong> tab.</li>
<li> Click the <strong>Configuration</strong> button.</li>
<li>Click the <strong><a href="iipy_35.htm">Process Options</a></strong> tab, and type the timeout period in the <strong>CGI Script Timeout</strong> text box.</li>
</ol>

<h2><a name="H2_37722380">Caching ISAPI extensions</a></h2>

<p>ISAPI DLLs can be loaded and cached so that further requests can be processed without calling them again. Otherwise, the DLLs are unloaded after they are run.  Caching reduces the time a user waits for a DLL to load and most ISAPI extensions (including Active Server Pages) benefit from caching. You should clear this option only for special circumstances, such as debugging ISAPI extensions.</p>

<big>To enable caching:</big><br>

<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, select the Web site or the starting point directory of an application.</li>
<li>Open the directory's property sheets, and click the <strong>Home Directory</strong>, <strong>Virtual Directory</strong>, or  <strong>Directory</strong> tab.</li>
<li> Click the <strong>Configuration</strong> button.</li>
<li>On the <strong><a href="iipy_34.htm">Mappings</a></strong> tab, select the <strong>Cache ISAPI extensions</strong> check box.</li>
</ol>

<h2><a name="cachingaspscriptfiles">Caching ASP Script Files</a></h2>

<p> ASP processes the files containing ASP scripts, stores these processed files in a cache, and serves the cached files to clients. Caching ASP files enhances performance because cached ASP scripts are not processed each time they are called. You can further improve performance by changing the number of cached files for all applications with low (in process) or medium (pooled) protection, or individually for applications with high (isolated) application protection.</p>

<p><strong>To change the settings for caching ASP files:</strong></p>

<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, select the desired Web site, virtual directory, or directory, and select its property pages.</li>
<li>Click the <strong>Home Directory</strong> tab for a Web site, the <strong>Virtual Directory</strong>tab a virtual directory, or the <strong>Directory</strong> tab for a directory.</li>
<li>In the Application Settings section, set <strong>Application Protection</strong> to <strong>High (Isolated)</strong>, and click <strong>Apply</strong>.
<li>Click the <strong>Configuration</strong> button. </li>

<p><strong>Note</strong>&nbsp;&nbsp;If the <strong>Configuration</strong> button is not active, the directory or starting point does not contain an isolated application. You can create a new application by clicking the <strong>Create</strong> button.</P>
<li>Click the <strong>Cache Options</strong> tab.
<li>To cache all requested .asp files, select <strong>Cache all requested ASP files</strong>. To set the maximum number of files cached in memory, type a value in the text box (files in excess of this number are persisted to the disk cache).</li>
<li>To limit the total number of ASP files cached, select <strong>Limit ASP files cached to:</strong>, and enter a value in the text box.</li>
<li>To turn off the cache, select <strong>Do not cache ASP files</strong>.</li>
</ol>

<hr class="iis" size="1"><p align=center><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
