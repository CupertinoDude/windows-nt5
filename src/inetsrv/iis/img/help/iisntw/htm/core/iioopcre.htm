<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Configuring Recycling Events</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Describes how to configure Process Recycling events.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana, Arial, Helvetica">

<h1><a name="ConfiguringProcessRecyclingEvents">Configuring Process Recycling Events</a></h1>

Process recycling events can be configured from the user interface (UI) or by directly editing the metabase. To reduce the possiblity of errors you should configure IIS from the UI whenever possible.

<p>Before configuring process recycling events, you should understand why process recycling is configured at different levels of the metabase and when the properties are inherited by other levels.</P>

<p>There are four metabase keys that are used to configure process recycling, as described in <a href="iioopapr.htm">About Process Recycling</a>. They are PeriodicRestartTime, PeriodicRestartRequests, PeriodicRestartSchedule and ShutdownTimeLimit.  Of the four, only the <a href="../asp/apro0y44.htm">ShutdownTimeLimit</a> metabase key cannot be configured from the UI. See <a href="#ConfiguringWithoutUI">Configuring Events without the UI</a> for information about configuring the ShutdownTimeLimit metabase key.</p>

<h2><a name="ConfiguringEventsUsingTheUserInterface">Configuring Events Using the UI</a></h2>
Process recycling events are configured in the UI using the the <a href="iiabuti.htm">IIS snap-in</a>. The steps in the configuration process differ depending on the level of IIS you are configuring.

<p><strong><font color="#0000FF">Important</font></strong>&nbsp;&nbsp;&nbsp;The W3SVC (IISWebService) level is the only level that Process Recycling settings for Pooled out-of-process (OOP) applications are available.

<H3>To configure the W3SVC (IISWebService) level</H3>
<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, right-click the computer icon, and click <b>Properties</b>.
</p>
<li>Select the <b>Internet Information Services</b> tab. Under the <b>Master Properties</b> section, select <b>WWW Service</b> from the Master Properties list, and click <b>Edit</b>.
<p>
<li>Select the <b>Home Directory</b> tab.
<p>
<li>In the <b>Application Settings</b> section, click <b>Configuration</b>.
<p>
<li>Select the <b>Process Options</b> tab.
</ol>
<p>You are now on the Process Options property sheet. For information about how to configure process recycling events using this property sheet, see <a href="#ProcessOptionspage">Process Options Property Sheet</a>

<p><strong><font color="#0000FF">Important</font></strong>&nbsp;&nbsp;&nbsp;Process Recycling settings for Isolated OOP applications can only be configured at the three levels listed below using the UI. A prerequisite to configuring at these levels with the UI is that an Isolated application exists at the level you are enabling Process Recycling on. Otherwise, the Recycling Options on the Process Options properties sheet will be grayed out and un-available. For information about creating an application, see <a href="iiwarnde.htm">Creating Applications</a>.

<H3>To configure the W3SVC/<i>n</i>/ROOT (IISWebVirtualDir) level</H3>
<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, right-click the virtual directory that you want to configure, and select <b>Properties</b> from the list. 
<p>
<li>Select the <b>Virtual Directory</b> tab.
<p>
<li>In the <b>Application Settings</b> section, click <b>Configuration</b>.
<p>
<li>Select the <b>Process Options</b> tab.
</ol>
<p>You are now on the Process Options property sheet. For information about how to configure Process Recycling events using this property sheet, see <a href="#ProcessOptionspage">Process Options Property Sheet</a>

<H3>To configure the W3SVC/<i>n</i>/ROOT/WebVirtualDir (IISWebVirtualDir) level</H3>
<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, right-click the directory within a virtual directory that you want to configure, and select <b>Properties</b> from the list. 
<p>
<li>Select the <b>Directory</b> tab.
<p>
<li>In the <b>Application Settings</b> section, click <b>Configuration</b>.
<p>
<li>Select the <b>Process Options</b> tab.
</ol>
<p>You are now on the Process Options property sheet. For information about how to configure Process Recycling events using this property sheet, see <a href="#ProcessOptionspage">Process Options Property Sheet</a>

<H3>To configure the W3SVC/<i>n</i>/ROOT/WebVirtualDir/WebDir (IISWebDirectory) level</H3>

<ol>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, right-click the Web directory within a virtual directory that you want to configure, and select <b>Properties</b> from the list. 
<p>
<li>Select the <b>Directory</b> tab.
<p>
<li>In the <b>Application Settings</b> section, click <b>Configuration</b>.
<p>
<li>Select the <b>Process Options</b> tab.
</ol>

<p>You are now on the Process Options property sheet. For information about how to configure Process Recycling events using this property sheet, see <a href="#ProcessOptionspage">Process Options Property Sheet</a>

<h3><a name="ProcessOptionspage">Process Options Property Sheet</a></h3>

<img src="iioop1.jpg" alt="Process Options property sheet.">

<p>From this property sheet you can configure the following:</p>
<p>
<ul>
<li>If you choose to recycle applications after a set amount of time, select the <strong>Recycle Application Process after <i>(# of)</i> minutes</strong> check box and enter a whole number in the <b>minutes</b> text box. Entering the number "0" in the <b>minutes</b> field disables this feature. NOTE: This recycling event may not occur exactly on the threshold, it may occur shortly thereafter due to load on the server. 
</li>
<li>If you choose to recycle applications after a set number of requests, select the <strong>Recycle Application Process after <i>(# of)</i> requests</strong> check box and enter a whole number in the <b>requests</b> text box. Entering the number "0" in the <b>requests</b> field disables this feature.
</li>
<li>If you choose to recycle applications at a certain time each day, select the <strong>Recycle Application at the following times during the day:</strong> check box and use the <strong>Add Time</strong> button to add a time of day, or multiple times per day. The default value is an empty sting.
</li>
</ul></p>

<h2><a name="ConfiguringWithoutUI">Configuring Events without the UI</a></h2>

<p>Configuring Process Recycling events without the UI allows you to configure these settings at any level of the metabase. You may want to do this for finer control of where settings can be inherited from. However, this approach requires an understanding of the following:</p>
<p>
<ul>
<li>How inheritance works
<li>The metabase keys that are unique to Process Recycling
<li>An understanding of the AppIsolated metabase key
</ul>
<p>Before configuring Process Recycling without the UI, you should review <a href="iiooplai.htm">Levels and Inheritance</a>.

<p>You can use the following methods to configure process recycling without using the UI:
<ul>
<li>Active Directory Service Interfaces (ADSI)
<li>A Metabase Editor, such as MetaEdit, included with the Windows 2000 Resource Kit.
</ul></p>

<p>See the <a href="../asp/adsi0aat.htm">ADSI Reference</a> for information about using ADSI. You can use the <a href="../adminsamples/adsutil.htm">IIS Admin Script Utility (adsutil)</a> with ADSI to configure the metabase.</p>

<h2><a name="RelatedResources">Related Resources</a></h2>

<p>The following resources provide related information:</p>
<ul>
<li><a href="iiwarndc.htm">About Applications</a>&nbsp;&nbsp;&nbsp;Conceptial information about applications, their starting point, and about the different processes an application can run in.</li>
<li><a href="iiisol.htm">Isolating Applications</a>&nbsp;&nbsp;&nbsp;Step-by-step instruction about how to configure an application to run in different processes.</li>
<li><a href="../asp/adsi0aat.htm">ADSI Reference</a>&nbsp;&nbsp;&nbsp;The ADSI Reference section describes properties and methods that are exposed by the IIS Admin Objects.</li> 
<li><a href="../adminsamples/adsutil.htm">IIS Admin Script Utility (adsutil)</a>&nbsp;&nbsp;&nbsp;The IIS administration utility uses VBScript with ADSI to manipulate the IIS configuration.</li> 
</ul>

<hr class="iis" size="1"><p align=center><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

<span style="display:none"><LAYER VISIBILITY=HIDE> 
(The following words are used by Search; they are not intended to be displayed on the page.)
W3SVC
</layer></span>

</font>
</body>
</html>
