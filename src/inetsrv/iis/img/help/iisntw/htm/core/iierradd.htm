<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Adding a Custom Error Message</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Procedural information on how to add custom HTTP error messages.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="H1_37701508">Adding a Custom Error Message</a></h1>

<p>You can map custom error messages to a file or to a URL by using the <strong>Custom Errors</strong> property sheet in the IIS snap-in.</p>

<p><big>To customize an error message by mapping to a file</big></p>
 
<ol>
<li>Create a file that contains your custom error message, and place the file in a directory.</li>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, select the Web site, virtual directory, directory, or file in which you want to customize HTTP errors, and click <strong>Properties</strong>.</li>
<li>Select the <strong>Custom Errors</strong> property sheet.</li>
<li>Select the HTTP error that you want to change.</li>
<li>Click the <strong>Edit Properties</strong> button.</li>
<li>Select <strong>File</strong> from the <strong>Message Type</strong> box.</li>
<li>Type the path and file name that points to your customized error message, or use the <strong>Browse</strong> button to locate the file on your computer's hard disk.</li>
<li>Click <strong>OK</strong>.</li>
</ol>

<p><big>To customize an error message by mapping to a URL</big></p>
 
<ol>
<li>Create a file that contains your custom error message, and place it in a virtual directory.</li>
<li>In the <a href="iiabuti.htm">IIS snap-in</a>, select the Web site, virtual directory, directory, or file in which you want to customize HTTP errors, and click the <strong>Properties</strong> button.</li>
<li>Select the <strong>Custom Errors</strong> property sheet.</li>
<li>Select the HTTP error that you want to change.</li>
<li>Click the <strong>Edit Properties</strong> button.</li>
<li>Select <strong>URL</strong> from the <strong>Message Type</strong> box.</li>
<li>Type the URL which points to your customized error message by entering the path to the URL beginning with the virtual directory name.</li>
<li>Click <strong>OK</strong>.</li>
</ol>

<p><strong>Notes</strong></p>

<ul>
<li>If you have an ASP file defined to handle a custom error, the script is invoked as a URL that passes context. For example, if you have an .asp file called Handle405.asp that is defined to handle HTTP 405 errors and a 405 error occurs when a user tries to access Example.htm, Handle405.asp file is invoked as if the user had typed <strong>http://example.microsoft.com/handle405.asp?405;http://example.microsoft.com/example.htm
</strong> in the Web browser.</li>

<li>If you are using static custom error files (HTML files), you should always use the File option.  If you plan to develop an application (by using ISAPI or ASP) to handle errors, then use the URL option. Note that the error status is handed to the application in the URL parameters and it is the application's responsibility to set the HTTP header status; otherwise, the HTTP response status will be "HTTP&nbsp;1.1 200 OK."</li>

<li>If you are using Internet Explorer&nbsp;5.0 with Windows, Internet Explorer may replace the following custom errors with its own HTTP error. If the file size of the custom error is smaller than the size listed, the custom error is not used:

<p>403, 405, 410 - must be greater than 256 bytes<br>
400, 404, 406, 408, 409, 500, 500.12, 500.13, 500.15, 501, 505 - must be greater than 512 bytes</p></li>
</ul>

<hr class="iis" size="1"><p align=center><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
