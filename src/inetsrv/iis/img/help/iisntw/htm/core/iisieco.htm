<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML dir=ltr>
<HEAD>

<TITLE>#echo</TITLE>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information. The #echo directive instructs the Web server to insert the value of an environment variable into an HTML page.">

<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000"><font face="Verdana,Arial,Helvetica">

<H2><A NAME="_k2_echo"></A><SUP></SUP>#echo</H2>

<P>The <b> #echo</b> directive instructs the Web server to display the value of a server variable. You must surround a directive with HTML comment delimiters.</P>

<P>By default, this directive can be used only in STM pages; it cannot be used in ASP pages. For ASP pages, you can access the server variables by using the <a href="../asp/vbob5vsj.htm"><b>Request.ServerVariables</b></a> 
collection.</P>
<H6>Syntax</H6>

<P><STRONG>&lt;!-- #echo var = </STRONG><em>VariableName</em> <STRONG>--&gt;</STRONG></P>

<H6>Parameters</H6>

<P class=dt><em>VariableName</em></P>

<P class=indent>Specifies the name of the variable whose value you want to insert. The variable can be one of the following:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all width=100%>

<TR VALIGN="top">
<TD width=20%><STRONG>Variable</STRONG></TD>
<TD width=80%><STRONG>Meaning</STRONG></TD>
</TR>

<TR VALIGN="top">
<TD width=20%>ALL_HTTP</TD>
<TD width=80%>All HTTP headers that were not already parsed into one of the other variables described in this table. These variables are of the form HTTP_<em>header field name</em>. The headers consist of a null-terminated string with the individual headers separated by
  carriage return line feeds.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>AUTH_TYPE</TD>
<TD width=80%>This contains the type of authentication used. For example, the string will be "Basic" if Basic authentication is used, and it will be "integrated Windows authentication" for integrated authentication. Other authentication schemes will have other strings. Because new authentication types can be added to the Web server, it is not possible to list all the string possibilities. If the string is empty, then no authentication is used.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>AUTH_PASSWORD</TD>
<TD width=80%>The value entered in the client's authentication dialog box. This variable is available only if Basic authentication is used. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>AUTH_USER</TD>
<TD width=80%>The value entered in the client's authentication dialog box. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>CONTENT_LENGTH</TD>
<TD width=80%>The number of bytes that the script can expect to receive from the client.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>CONTENT_TYPE</TD>
<TD width=80%>The content type of the information supplied in the body of a POST request.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>DOCUMENT_NAME</TD>
<TD width=80%>The current file name.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>DOCUMENT_URI</TD>
<TD width=80%>The virtual path to the current document.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>DATE_GMT</TD>
<TD width=80%>The current date in Greenwich Mean Time (GMT).</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>DATE_LOCAL</TD>
<TD width=80%>The current date in the local time zone.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>GATEWAY_INTERFACE</TD>
<TD width=80%>The revision of the CGI specification used by the Web server. The revision is returned in the format CGI/<em>revision</em>.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>HTTP_ACCEPT</TD>
<TD width=80%>Special-case HTTP header. Values of the accept fields are concatenated, and separated by a comma (,). For example, if the following lines are part of the HTTP header: 
<P><CODE>&nbsp;&nbsp;&nbsp;accept: */*; q=0.1<BR>
 &nbsp; accept: text/html<BR>
 &nbsp; accept: image/jpeg</CODE></P>

<P>the HTTP_ACCEPT variable will have a value of:</P>

<P><CODE>&nbsp;&nbsp;&nbsp;*/*; q=0.1, text/html, image/jpeg</CODE></P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>LAST_MODIFIED</TD>
<TD width=80%>The date that the current document was last modified.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>PATH_INFO</TD>
<TD width=80%>Additional path information, as given by the client. This consists of the trailing part of the URL after the script name, but before the query string, if any.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>PATH_TRANSLATED</TD>
<TD width=80%>This is the value of PATH_INFO, but with any virtual path expanded into a directory specification.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>QUERY_STRING</TD>
<TD width=80%>The information that follows the question mark (?) in the URL that referenced this script.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>QUERY_STRING_UNESCAPED</TD>
<TD width=80%>Unescaped version of the query string; that is, a version that is not URL encoded. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>REMOTE_ADDR</TD>
<TD width=80%>The IP address of the client or agent of the client (for example, gateway or firewall) that sent the request.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>REMOTE_HOST</TD>
<TD width=80%>The host name of the client or agent of the client (for example, gateway or firewall) that sent the request. IIS&nbsp;2.0 and 3.0 returned an IP address for this parameter. </TD>
</TR>

<TR VALIGN="top">
<TD width=20%>REMOTE_USER</TD>
<TD width=80%>This contains the user name of the client if the client went through authentication by the server. This comes back as an empty string if Anonymous Access is enabled on the application.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>REQUEST_METHOD</TD>
<TD width=80%>The HTTP request method.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>SCRIPT_NAME</TD>
<TD width=80%>The name of the script program being executed.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>SERVER_NAME</TD>
<TD width=80%>The server’s host name, or IP address, as it should appear in self-referencing URLs.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>SERVER_PORT</TD>
<TD width=80%>The TCP/IP port on which the request was received.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>SERVER_PORT_SECURE</TD>
<TD width=80%>A string of either 0 or 1. If the request is being handled on the secure port, this will be 1. Otherwise, it will be 0.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>SERVER_PROTOCOL</TD>
<TD width=80%>The name and version of the information retrieval protocol relating to this request. This is usually HTTP/1.0. The protocol is returned in the format <em></em>name/version</em>.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>SERVER_SOFTWARE</TD>
<TD width=80%>The name and version of the Web server answering the request. The server information is returned in the format name/version.</TD>
</TR>

<TR VALIGN="top">
<TD width=20%>URL</TD>
<TD width=80%>Gives the base portion of the URL. Parameter values will not be included. The value is determined when the Web server parses the URL from the header.</TD>
</TR>
</TABLE>&nbsp;<font face="Verdana,Arial,Helvetica">

<P><strong><font color="#0000FF">Important</strong></font>&nbsp;&nbsp;&nbsp;The file containing this directive must use a file name extension that is mapped to the SSI interpreter; otherwise, the Web server will not process the directive. By default, the file name extensions .stm, .shtm, and .shtml are mapped to the SSI interpreter
(ssinc.dll).</P>

<P>An STM page using the #echo directive must be run by itself, or by calling it from an ASP page with Response.Redirect. Calling an STM page from an ASP page with Server.Transfer, Server.Execute, or #include will not work because that would force the STM page to go through asp.dll instead of through ssinc.dll.</P>

<P>If you have the <a href="iiabuti.htm">IIS Snap-in</a> installed, you can modify default extension mappings and add new mappings;
see <A HREF="iiwarndf.htm">Setting Application Mappings</A>. Since you cannot map a file extension to more than one executable, you cannot use this directive in ASP files. ASP files are already mapped to the asp.dll and must stay that way.</P>

<H6><b>Example</b></H6>

<p>This example uses the #echo directive to insert a URL into the ACTION value of a FORM statement.</p>

<p>--- Echo.asp ---</p>

<pre>&lt;FORM NAME=&quot;RunEcho&quot; METHOD=&quot;POST&quot; ACTION=&quot;Echo.asp&quot;&gt;
&lt;INPUT TYPE=&quot;SUBMIT&quot; VALUE=&quot;Run the #echo Directive&quot; NAME=&quot;RunEcho&quot;&gt;
&lt;/FORM&gt;
&lt;%
If Len(Request.Form(&quot;RunEcho&quot;)) Then
  Response.Redirect(&quot;Echo.stm?Echo.asp&quot;)
End If
%&gt;
</pre>

<p>--- Echo.stm ---</p>

<pre>&lt;H3&gt;Inside Echo.stm&lt;/H3&gt;
AUTH_TYPE is &lt;!-- #echo var=&quot;AUTH_TYPE&quot;--&gt;&lt;BR&gt;
&lt;FORM NAME=&quot;Return&quot; METHOD=&quot;POST&quot; ACTION=&quot;&lt;!-- #echo var=&quot;QUERY_STRING&quot;--&gt;&quot;&gt;
&lt;INPUT TYPE=&quot;SUBMIT&quot; VALUE=&quot;Return to Previous Page&quot; NAME=&quot;Return&quot;&gt;
&lt;/FORM&gt;
</pre>

</font>
<hr class="iis" size="1">
<p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</BODY>
</HTML>
