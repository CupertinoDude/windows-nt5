<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Restoring the Metabase</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="description" CONTENT="Restoring the Metabase">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="bak">Restoring the Metabase</a></h1>

<p>IIS provides new functionality to Configuration Backup/Restore located from the <a href="iiabuti.htm">IIS snap-in</a>. Web site administrators can restore copies of a secure or insecure backup of the metabase to other computers. You can also restore the metabase using the legacy method.</p>

<h3>Issues restoring the metabase backup</h3>

<p><big>Restoring a secure backup</big>&nbsp;&nbsp;&nbsp;
The password is stored within the metabase backup and used to encrypt the session key. This password cannot be changed, and if forgotten, renders that metabase backup unrestoreable.

<p><big>Restoring an insecure backup</big>&nbsp;&nbsp;&nbsp;
Metabase backups are not password protected. Anyone can restore an insecure backup to any computer. 

<p><big>Restoring a legacy backup</big>&nbsp;&nbsp;&nbsp;
The legacy methodology uses the machine key (unique to a particular installation of the OS) and the system key (generated by IIS) to encrypt the backup. Therefore, legacy metabase backups can only be restored to the same installation of the operating system (OS) that they are created from. 

<p><big>Content Files</big>&nbsp;&nbsp;&nbsp;
Configuration Backup/Restore does not save your content files. When restoring the metabase backup to a different server, you must copy your content files as well. Also, the content files must exist on the same drive letter that was used by the original server. 

<p><big>SSL Certificates</big>&nbsp;&nbsp;&nbsp;
If you use an SSL (secure socket layer) Certificate on your Web server and restore the metabase backup to a different installation of the OS, an error occurs if the certificate is not available or installed. If a site's SSL Certificate is missing, connections are dropped, and IIS displays a "page unavailable" error. The server logs the following warning in the event log:
The solution is to reinstall the certificate into the same certificate store and restart IIS. Failure to restart IIS after reinstalling the certificate results in continued error logs and dropped connections. For more information about installing SSL Certificates, see <a href="iisslsc.htm">Setting Up SSL on Your Server</a>.</p>


<a name="TorestoreyourMetabaseBackup"><h3>To restore the metabase backup</h3>
<ol>
<li> In the <a href="iiabuti.htm">IIS snap-in</a>, select the <strong>Computer</strong> icon under <strong>Internet Information Services</strong>.</li>
<li>Click the <strong>Action</strong> button, and select <strong>Backup/Restore Configuration</strong>.</li>
<li>Under <strong>Previous backups</strong>, select the file name from the list, and click <strong>Restore</strong>. If prompted for a password, enter the password chosen to secure the backup.</li>
</ol>

<p><a name="RelatedTopics"><strong>Related Topics</strong></p>
<ul>
<li>For information about backing up the metabase, see <a href="iitasks.htm">Backing Up the Metabase</a>.</li>
<li>For information about metabase keynames and paths, property inheritance, security and reliability, see <a href="../asp/aint1aud.htm">Introduction to the IIS Metabase</a>.</li>
<li>For more information about installing SSL Certificates, see <a href="iisslsc.htm">Setting Up SSL on Your Server</a>.</li>
<li>For information about restarting IIS, see <a href="iicodira.htm">Restarting IIS
</a>.</li>
</ul>

<hr class="iis" size="1"><p align=center><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>


</font>


</body>
</html>
