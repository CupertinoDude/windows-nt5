<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Detecting Unauthorized Access</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Procedural and conceptual information on how to archive and review security logs to detect unauthorized access attempts.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="H1_37697000">Detecting Unauthorized Access</a></h1>

<p>You can review IIS logs and Windows security logs to monitor security events over extended periods of time. You can then use the Microsoft Management Console to view the Windows Security Log. The IIS logs can be viewed by using any text editor or word processor. For more information about viewing IIS logs, see <a href="iilogsa.htm">Logging Site Activity</a>.</p>

<p>In the Windows Security Log, you can detect unauthorized access attempts, which can appear as warning or error log entries. You can also archive these logs for later use. For more information about auditing, consult the Windows documentation.</p>

<big>To detect possible security problems by reviewing the Windows Security Log</big><br>

<ol>
<li>Click <strong>Start</strong>, point to <strong>Settings</strong>, click <strong>Control Panel</strong>, double-click <strong>Administrative Tools</strong>, then double-click <strong>Computer Management</strong>.</li>
<li>Expand <strong>System Tools</strong>.</li>
<li>Expand <strong>Event Viewer</strong>.</li>
<li>Select <strong>Security Log</strong>.</li>

<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;If you are not able to view the security log, then the user account you are using does not have privileges to do so. This happens because the domain-level security policies override the local computer-level security policies, which means that you can be logged on as the Administrator of your local computer, but not have access to its security log. To get these permissions, see your network administrator. For more information about security policies, see the Windows documentation.</p>


<li>Inspect the logs for suspicious security events, including the following:</li>

<ul>
<li>Invalid logon attempts.</li>
<li>Failed use of privileges.</li>
<li>Failed attempts to access and modify .bat or .cmd files.</li>
<li>Attempts to alter security privileges or the audit log.</li>
<li>Attempts to shut down the server.</li>
</ul>
</ol>



<big>To archive a Windows Security Log</big><br>
<ol>
<li>Click <strong>Start</strong>, point to <strong>Settings</strong>, click <strong>Control Panel</strong>, double-click <strong>Administrative Tools</strong>, then double-click <strong>Computer Management</strong>.</li>
<li>Expand <strong>System Tools</strong>.</li>
<li>Expand <strong>Event Viewer</strong>.</li>
<li>Select <strong>Security</strong>.</li>
<li>On the <strong>Action</strong> menu, click <strong>Save Log File As</strong>.</li>
<li>In the <strong>Save As</strong> dialog box, select the directory you want to save the file to, and type in a name for the file.</li>
<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;The security log can be saved as an event (.evt) file, a text (.txt) file, or a comma-delimited (.csv) file.</p>
</ol>



<big>To open an archived Windows Security Log</big><br>
<ol>
<li>Click <strong>Start</strong>, point to <strong>Settings</strong>, click <strong>Control Panel</strong>, double-click <strong>Administrative Tools</strong>, then double-click <strong>Computer Management</strong>.</li>
<li>Expand <strong>System Tools</strong>.</li>
<li>Expand <strong>Event Viewer</strong>.</li>
<li>On the <strong>Log</strong> menu, select <strong>Security</strong>.</li>
<li>On the <strong>Action</strong> menu, point to <strong>New</strong> and click <strong>Log View</strong>.</li>
<li>In the <strong>Add Another Log View</strong> dialog box, select <strong>Saved (opens a previously saved log)</strong> and browse to the file.</li>
<li>In the <strong>Log type</strong> drop-down list, select <strong>Security</strong>.</li>
<li>Click <strong>OK</strong> to open the file in the viewer.</li>
</ol>

<big>To detect possible security problems by reviewing IIS log files</big><br>
<ol>
<li>In a text editor, such as Notepad, open the log file. For more information about log files, see <a href="iilogsa.htm">Logging Site Activity</a>.</li>
<li>Inspect the logs for suspicious security events, including the following:</li>

<ul>
<li>Multiple failed commands attempting to run executable files or scripts. (You should closely monitor the Scripts directory.) </li>
<li>Excessive failed logon attempts from a single IP address, with the possible intention of increasing network traffic or denying access to other users.
<li>Failed attempts to access and modify .bat or .cmd files.</li>
<li>Unauthorized attempts to upload files to a directory containing executable files.</li>
</ul>
</ol>


<hr class="iis" size="1"><p align=center><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
