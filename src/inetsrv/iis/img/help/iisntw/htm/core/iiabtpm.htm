<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>About Performance Tuning</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion	
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Conceptual information about using tools in Windows&nbsp;2000 to monitor your Web server's performance. Includes recommendations for implementing an effective monitoring strategy, and which tools to use for specific situations.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="H1_37678224">About Performance Tuning</a></h1>

<p>To provide a satisfactory experience for users, you must make sure that server performance is optimal. Hardware needs vary depending on the service provided. For example, the FTP service uses less memory than the Web service. In addition, Active Server Pages (ASP) applications, Common Gateway Interface (CGI) scripts, database queries, and video files are more processor-intensive than static HTML pages. Performance also changes over time as traffic and site content change. To efficiently tune performance, the server administrator must plan a monitoring strategy using a variety of tools.</p>

<p>This topic includes the following sections:</p>

<ul>
<li><a href="#TestingandTuning">The Cyclical Nature of Testing and Tuning</a></li>
<li><a href="#PerformanceTuning">Tools Used to Monitor Performance</a></li>
<li><a href="#DiskOptimization">Disk Optimization</a></li>
</ul>

<h2><a name="TestingandTuning">The Cyclical Nature of Testing and Tuning</a></h2>
<p>Performance testing and tuning is an ongoing process. To test and tune effectively, you must begin by planning your evaluation strategy. The first step is to measure the current level of performance. Because performance of the server can vary greatly over time, be sure to monitor long enough to capture a true picture of activity on the server.</p>

<p>To improve server performance, examine all parts of the system for potential bottlenecks. Bottlenecks can be caused by inadequate or improperly configured hardware, or by software settings in either IIS or Windows&nbsp;XP. A good monitoring plan checks on performance in all areas.</p>

<p>Once you know how your server is performing, you can begin to make changes aimed at improving performance. Changes should be made one change at a time because it becomes difficult to assess the impact of multiple changes.</p>

<p>After each change is made, continue to monitor to see if the change had the desired effect, or if it had undesirable side effects. Because changes to one resource can cause bottlenecks to appear in other areas, you need to check on the performance of all resources after you make a change. Once you have assessed the impact of a change, you can determine whether further changes are necessary.</p>

<h2><a name="PerformanceTuning">Tools Used to Monitor Performance</a></h2>

<p>Monitoring the server is a crucial part of server administration.  By using appropriate monitoring tools, you can detect server problems, evaluate the result of changes to your Web site content, and plan upgrades to make your sites more accessible to users.</p>

<p>The best choice of monitoring tool and method depends on the information you need. For example, if you are trying to measure the overall load on your Web server, you can use Performance Monitor to render a week-long plot, showing information such as the number of computer connections and file transfers. As another example, if you notice a slowdown in your server's performance, you can check for errors in Event Viewer, the tool for viewing logs generated by Windows&nbsp;XP.</p>

<p>You can also monitor your server by examining logs generated by IIS. These logs extend beyond those generated by Windows&nbsp;XP. For information about logging, see the topics listed in <a href="iilogsa.htm">Logging Site Activity</a>.</p>


<p>The following monitoring tools, available in some editions of Windows&nbsp;XP, can provide both moment-to-moment and summary information:</p>

<ul>
<li><a href="#Sysmon">Performance Monitor</a></li>
<li><a href="#eventviewer">Event Viewer</a></li>
<li><a href="#Taskman">Task Manager</a></li>
<li><a href="#Netmon">Network Monitor</a></li>
</ul>


<p>In addition to the tools built into Windows&nbsp;XP, you can use other performance monitoring tools. For more information, see <a href="../asp/perf1w13.htm">Performance and Scalability Testing</a>.</p>

<h3><a name="Sysmon">Performance Monitor</a></h3>

<p>Performance Monitor is a powerful MMC snap-in that you can use to monitor your server&#146;s activity and summarize its performance at selected intervals.  With this tool, you can display performance data in real time charts or reports, collect data in files, and generate alerts
when critical events occur. The data can be used to determine the cause of
system bottlenecks and to fine-tune system and application performance.</p>

<p>The following are three methods to access the Performance Monitor:</p>

<ul>
  <li>From the <b>Start</b> menu, click <b>Programs</b>, click <b>Administrative
    Tools</b>, and click on <b>Performance</b>.</li>
  <li>From the <b>Start</b> menu, click <b>Run</b>, type <b>perfmon</b>
    in the text box, and press ENTER. 
  <li>Type <b>perfmon</b> from any command prompt window.</li>
</ul>

<p>Performance Monitor examines the output of <em>Performance Counters</em> that monitor the activity of specific
<em>Performance Objects</em>, that is, specific services or mechanisms controlling server resources.
For example, if you click on the button with a plus sign in Performance Monitor, you can view a
performance object called Web Service and a list of counters that monitor such
things as bytes received per second or connection attempts per second. From this
window, you can add and remove counters to the graphic display of Performance Monitor, or you can configure the counters to log in a particular
way. Numerous counters running at the same time can cause a small decrease in
performance, so be selective.&nbsp;</p>

<p>Windows&nbsp;XP includes hundreds of counters such as those for disk usage and TCP activity. IIS installs
its own counters, including Web service counters, FTP service counters, counters for Active Server Pages applications, and global counters for IIS. The Web and FTP service counters and Active Server Pages
object counters monitor connection activity for scripts, while the Internet Information Services global counters monitor things such as bandwidth usage and caching activity for all IIS services.
Counters typically measure in terms of how much, how many, or how long. Keep
this in mind when selecting what counters you want to display.</p>

<p>Performance Monitor is designed to provide both short-term and long-term information about the load on your server and sites. The following table
lists some Performance Monitor counters that are useful to monitor your server, and provides ideal
average values for each counter. The Performance Monitor graph plots on a scale of
zero to 100, so it may be necessary to change the scale for individual counters
that register small values.&nbsp;</p>

<table border=1 width=95% cellpadding=1 cellspacing=1>
<caption align=top></caption>
<tr><th>Object\Counter</th><th>Ideal Value</th></tr>
<tr><td>Memory\Pages/sec</td><td>0&#150;20 (if over 80, indicates trouble).</td></tr>
<tr><td>Memory\Available Bytes</td><td>At least 20 MB.</td></tr>
<tr><td>Memory\Committed Bytes</td><td>Not more than about 75 percent of physical memory size.</td></tr>
<tr><td>Memory\Pool Nonpaged Bytes</td><td>Steady (slow rise may indicate a memory leak).</td></tr>
<tr><td>Processor\% Processor Time</td><td>Less than 75 percent.</td></tr>
<tr><td>Processor\Interrupts/sec</td><td>Depends on processor. Up to 1,000 for 486/66 processors; 3,500 for P90; more than 7,000 for P200. Lower is better. </td></tr>
<tr><td>Processor\System Processor Queue Length</td><td>2 or less.</td></tr>
<tr><td>(Logical or Physical) Disk \ % Disk Time</td><td>As low as possible.</td></tr>
<tr><td>(Logical or Physical) Disk \ Avg. Disk Queue Length</td><td>Less than 2.</td></tr>
<tr><td>(Logical or Physical) Disk \ Avg Disk Bytes/Transfer</td><td>As high as possible.</td></tr>
<tr><td>Internet Information Services Global\File Cache Hits %</td><td>As high as possible, though the value depends on the content of the site.</td></tr>
<tr><td>Web Service\Bytes Total/sec</td><td>As high as possible.</td></tr>
<tr><td>Active Server Pages\Request Wait Time</td><td>ASP\Request Execution Time</td></tr>
<tr><td>Active Server Pages\Requests Queued</td><td>Zero.</td></tr>
<tr><td>Active Server Pages\Transactions/sec</td><td>As high as possible.</td></tr></table>

<p>For more detailed information about using Performance Monitor, see the Windows&nbsp;XP
documentation. For a
complete list of counters provided by IIS, see <a href="iicntpm.htm">Counters Reference</a>.</p>

<h3><a name="eventviewer">Event Viewer</a></h3>

<p>Windows&nbsp;XP includes an event-logging service, which records events such as errors or the successful starting of a service. These event logs are viewed by using Event Viewer. You can use Event Viewer to monitor system, security, and application event logs. With this information you can better understand the sequence and types of events that led up to a particular performance problem. For details about how to use Event Viewer, see the Windows&nbsp;XP
documentation.</p>

<h3><a name="Taskman">Task Manager</a></h3>
<p>Task Manager can be used to view ongoing tasks and threads. It can also be used to change the assigned priority of processes. However, once the process has completed, the new priority setting is lost. CPU and memory usage can be seen in real time, but information is not saved over time. For more detailed information about using Task Manager, see the Windows&nbsp;XP
documentation.</p>

<h3><a name="Netmon">Network Monitor</a></h3>

<p>Network Monitor captures information on traffic to and from a computer, and gives detailed information about the frames being sent and received. This tool can help you analyze complex patterns of network traffic. By using it, you can view the header information included in HTTP and FTP requests to your server. Generally, you need to design a <em>capture filter</em>, which functions like a database query and singles out a subset of the frames being transmitted. You can also use a <em>capture trigger</em> that responds to events on your network by initiating an action, such as starting an executable file.
A light version of Network Monitor ships with some versions of Windows XP. A
complete version of Network Monitor ships with Systems Management Server. For details about Network Monitor, see the Windows&nbsp;XP
documentation, including the Windows&nbsp;Resource Kits.</p>

<h2><a name="DiskOptimization">Disk Optimization</a></h2>

<p>Hard-disk bottlenecks are most often seen on sites with very large file sets that are accessed randomly. How often IIS needs to access the hard disk is directly related to the amount of RAM and the number and size of requested files. If the amount of RAM is small and either a large number of different files are being requested, or the size of the requested files is large, IIS is unable to maintain copies of the files in RAM for faster access. In this case, IIS must access the files from the hard disk. The access speed and size of the hard disk determine how quickly IIS can locate a requested file.</p>

<p>To monitor your disk drives, use Performance Monitor to log the percentage of CPU utilized, network card saturation, and the &#37; Disk Time counter of the Physical Disk object. If the &#37 Disk Time counter is high, but the CPU and network card are not saturated, the disk drive is creating a bottleneck. For more information on Physical Disk &#37 Disk Time, see the Windows&nbsp;XP
documentation.</p>

<p>To improve disk access, use a redundant array of independent drives (RAID) and striped disk sets. If your server is used heavily for database work, you may want to consider running
the most current version and appropriate version of the Windows server on a different machine because your database will compete with IIS for memory, CPU, and disk resources. If you must run Windows
XP on the same machine as your database server, you may need either gigabytes of RAM, so you can minimize access delays, or a drive controller with a large RAM cache. You should also maintain redundancy, so that you are not forced to restore from backup copies when a single drive ceases to function. Many newer controllers permit "hot swapping," so that when a drive fails, it can be replaced without forcing server downtime. Even so, it's a good idea to maintain proper backups, and to keep one copy off-site.</p>


<hr class="iis" size="1"><p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
