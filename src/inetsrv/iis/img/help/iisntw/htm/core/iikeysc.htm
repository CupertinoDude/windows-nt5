<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Using the New Security Task Wizards</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="Conceptual and procedural information on the new security task wizards. Includes information on the Web Server Certificate Wizard, the CTL Wizard, and the Permissions Wizard.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#ffffff" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="managingkeypairs">Using the New Security Task Wizards</a></h1>

<p>Internet Information Services now comes with three new security task wizards that simplify most of the security tasks necessary to maintain a secure Web site. You can use the Web Server Certificate Wizard to manage Secure Sockets Layer (SSL) features in IIS and server certificates. Certificates are used in negotiating a secure link between your server and a user's browser. You can use the CTL Wizard to manage certificate trust lists (CTLs). Certificate trust lists are lists of trusted certification authorities for each Web site or virtual directory. You can use the Permissions Wizard to assign Web and NTFS access permissions to Web sites, virtual directories, and files on your server.</p>

<ul>
<li><A href="#aboutwizard">About the Wizards</a>
<li><A href="#accesswizard">Accessing the Wizards</a></li>
</ul>

<a name="aboutwizard"></a>
<H2><A NAME="H2_448403304"></A>About the Wizards</H2>
<P>The Certificate, CTL, and Permissions wizards perform many of the tasks formerly done in the <a href="iiabuti.htm">IIS snap-in</a>. With the exception of the Permissions Wizard, these functionalities are no longer accessible in the <a href="iiabuti.htm">IIS snap-in</a>.</P>

<a name="TheWebServerCertificateWizard"></a>
<H3>The Web Server Certificate Wizard</H3>
<P>Obtaining, configuring, and renewing server certificates can now all be done through one interface in the Web Server Certificate Wizard. The wizard can detect whether a server certificate has already been installed and if it is about to expire. You can use the wizard to replace the server certificate with another one from a certification authority (CA), from an online CA, such as Microsoft Certificate Services, or from a file previously obtained in Key Manager. You can also reassign a certificate from one Web site to another Web site. You can also use the wizard to view certificates.</P>

<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;Online requests for server certificates can only be made to Enterprise Certificate Services. The IIS Web Server Certificate Wizard will not recognize a stand-alone Certificate Services on the same machine. Use the offline certificate request to save the request to a file, and then process as an offline request (see the Certificate Services documentation). Online enrollment using local Enterprise Certificate Services is not affected.</p>

<P><STRONG>Note</STRONG>&nbsp;&nbsp;&nbsp;If you are not using an online certification authority, you will need to save the request file generated by the Web Server Certificate Wizard to disk and send it to the CA. When the response is received, you can start the wizard and it will begin where it left off before. If you are replacing a certificate, IIS will continue to use the old certificate until the new request is completed. For a list of certification authorities supporting Internet Information Services, see <A href="iiocrsc.htm">Obtaining a Server Certificate</a>.</P>

<H3>The CTL Wizard</H3>
<P>You can use the CTL Wizard to create and configure certificate trust lists (CTLs). A CTL is a list of trusted certification authorities (CA) for a particular Web site. By configuring your CTL, you can allow certificates issued by one CA to be used but not from another CA. CTLs are especially useful for Internet Service Providers (ISPs) who have several Web sites on their server and who need to have a different list of approved certification authorities for each site. CTLs are available only at the Web site level and are not available for FTP sites.</P>

<H3>The Permissions Wizard</H3>
<P>The Permissions wizard takes a scenario–driven approach in setting up Web and FTP permissions, NTFS access permissions, and authentication schemes. Rather than setting each area with a separate user interface, you select the scenario that most closely resembles your site's needs and the wizard sets all of the access permissions and authentication schemes for you. One of the great advantages of this is that the wizard will ensure that Web (or FTP) and NTFS permissions are properly coordinated and that the correct authentication scheme is used. All of the settings can still be changed in the <a href="iiabuti.htm">IIS snap-in</a>. The scenarios are:</P>
<OL>
<LI><STRONG>Public Web Site</STRONG>. 
  This is the most common configuration, in which the information on the site is 
  intended for public consumption over the Internet. It uses anonymous 
  authentication and allows users to view all files and access Active Server 
  Pages applications on your Web server. It also gives administrators complete 
  control over the site. 
  

<LI><STRONG>Secure Web Site</STRONG>. This configuration is used for corporate extranets, which are intranets accessed over the Internet. Information on the site is intended for restricted consumption. It uses  Basic, Digest, or integrated Windows authentication.  It allows only authorized users to view all files and access Active Server Pages applications on your Web server. It also gives administrators complete control over the site.</LI></OL>
<P><STRONG>Note</STRONG>&nbsp;&nbsp;&nbsp;If you choose to inherit all security 
settings when running the Permissions Wizard, customers might be denied access 
to the Web site. To correct this, open the <STRONG>Home Directory</STRONG> 
property sheet for the Web site and select <STRONG>Read</STRONG> and 
<STRONG>Scripts only</STRONG> permissions. When prompted, have all virtual 
directories and files inherit these settings.</P>



<a name="accesswizard"></a><h2><A NAME="H2_448406908"></A>Accessing the Wizards</h2>
<p>To access the Web Server Certificate Wizard and the CTL Wizard from the <a href="iiabuti.htm">IIS snap-in</a>:</p>
<ol>
<li>Select a site, directory, or file, and open its property sheets.</li>
<li>On the <strong>Directory Security</strong> property sheet, under <strong>Secure Communications</strong> click <strong>Server Certificate</strong> to access the Web Server Certificate Wizard and change 
  settings regarding your certificates. 
  
<li>On the <strong>Directory Security</strong> or <strong>File Security</strong> property sheet, under <strong>Secure Communications</strong> click <strong>Edit</strong>. Under <strong>Enable certificate trust list</strong> click either <strong>New</strong> or <strong>Edit</strong> to access the CTL Wizard and change settings 
  regarding your certificate trust lists.</li>             
</ol>

<p><strong>Note</strong></p>
<ul>
<li>You must have a server certificate installed to access 
  the Web Server Certificate Wizard or the CTL Wizard. 
  
<li>You must enable certificate trust lists to use the <strong>New</strong> and <strong>Edit</strong> buttons.</li>
</ul>

<p><b>To access the Permissions Wizard from the Internet <a href="iiabuti.htm">IIS snap-in</a>:</b></p>
<ol>
<li>Choose the Web or FTP site and click the <strong>Action</strong> menu. 
  
<li>From the list, point to <strong>All Tasks</strong> and then click <strong>Permission Wizard</strong>.</li>
</ol>

<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;Use the following guidelines when assigning IP addresses, Web sites, and SSL ports to your server certificates:</p>

<ul>
	<li>You <em>cannot</em> assign 
  multiple server certificates per Web site. 
  
	<li> You <em>can</em> assign a certificate to multiple Web sites.
	<li>You <em>can</em> assign multiple 
  IP addresses per Web site. 
  
	<li>You <em>can</em> assign multiple SSL ports per Web site.</li>
</ul>


<hr class="iis" size="1">
<p align="center"><em><A href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
