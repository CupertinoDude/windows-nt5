<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr><head><title>Backing Up the Metabase</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="description" CONTENT="Backing Up the Metabase">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">

<h1><a name="bak">Backing Up the Metabase</a></h1>

<p>IIS provides three methods to back up the metabase. Using Configuration Backup/Restore, you can create a secure backup or insecure backup of your metabase. With the new functionality to Configuration Backup/Restore in the <a href="iiabuti.htm">IIS snap-in</a>, Web site administrators can also restore copies of the metabase to other computers. These back up methods provide a way to restore only your metabase settings, not your content files. As with previous versions of IIS, you can programmatically create a legacy backup of the metabase; however, you can not restore legacy backups of the metabase to other computers.</p>

<strong>Secure Backup</strong><br>
Using this method, the Web site administrator provides a password that is then used to encrypt the metabase backup. Password information is stored in the metabase backup header, which indicates a password was used to create the backup. After the password is encrypted and stored in the metabase backup, it cannot be changed. Only administrators who know the password can restore the metabase backup. See <a href="#TocreateabackupwithaPassword">To create a secure backup (Password Required)</a>

<p><strong>Insecure Backup</strong><br>
Using this method, the Web site administrator chooses not to supply a password. The metabase backup is encrypted with a blank password and anyone can restore the metabase backup. See <a href="#TocreateabackupwithoutaPassword">To create an insecure backup (Password Not Required)</a></li>
<p>
<strong>Legacy Backup</strong><br>
Using this method, the Web site administrator can create metabase backups programmatically. However, they must be restored either programmatically or using Configuration Backup/Restore from the <a href="iiabuti.htm">IIS snap-in</a>.
<p>

<p><strong><font color="#0000FF">Important</font></strong>&nbsp;&nbsp;&nbsp;The legacy back up method is not recommended and therefore not described. When you create backups programmatically, IIS implements the legacy method used in IIS 5.0. Therefore, you can only restore legacy metabase backups to the operating system on which the backup was created.
</li>
</ul>


<h3><a name="TocreateabackupwithaPassword">To create a secure backup (Password Required)</h3>

<ol>
<li> In the <a href="iiabuti.htm">IIS snap-in</a>, select the <strong>Computer</strong> icon under <strong>Internet Information Services</strong>.</li>
<li>Click <strong>Action</strong>, and select <strong>Backup/Restore Configuration</strong>.</li>
<li> Click <strong>Create backup</strong>.</li>
<li>Type a name in the <strong>Configuration backup name</strong> text box.</li>
<li> Select the <strong>Encrypt backup using password</strong> check box, and type a password into the <strong>Password</strong> text box.</li>
<li>Click <strong>OK</strong>, and click <strong>Close</strong>. By default, the backup file is stored in the <br>\Winnt\System32\Inetsrv\MetaBack directory.</li>
</ol>


<a name="TocreateabackupwithoutaPassword"><h3>To create an insecure backup (Password Not Required)</h3>
<ol>
<li> In the <a href="iiabuti.htm">IIS snap-in</a>, select the <strong>Computer</strong> icon under <strong>Internet Information Services</strong>.</li>
<li>Click <strong>Action</strong>, and select <strong>Backup/Restore Configuration</strong>.</li>
<li> Click <strong>Create backup</strong>.</li>
<li>Type a name in the <strong>Configuration backup name</strong> text box.</li>
<li>Click <strong>OK</strong>, and click <strong>Close</strong>.</li>
</ol>

<p><a name="RelatedTopics"><strong>Related Topics</strong></p>
<ul>
<li>For information about metabase keynames and paths, property inheritance, security and reliability, see <a href="../asp/aint1aud.htm">Introduction to the IIS Metabase
</a>.</li>
<li>For information about restoring the metabase, see <a href="iirestore.htm">Restoring the Metabase</a>.</li>
</ul>

<hr class="iis" size="1"><p align=center><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
