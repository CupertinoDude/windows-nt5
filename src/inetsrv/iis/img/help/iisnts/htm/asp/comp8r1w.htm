<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ChooseContent</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H2><A NAME="_choosecontent"></A><SUP></SUP>ChooseContent</H2>

<P>The <B>ChooseContent </B>method retrieves an HTML content string from the <A HREF="/iishelp/iis/htm/asp/comp0mw5.htm">Content Schedule File</A> and displays it on the current page. The method retrieves a new content string each time the script is run, such as when a user opens or reloads a page.</P>

<H6>Syntax</H6>

<P><I>ContRot</I><B> .ChooseContent( </B><I>content-schedule-path </I><B>) </B></P>

<P><B>&nbsp;</B></P>

<H6>Parameters</H6>

<DL>
<DT><I>content-schedule-path</I></DT>

<DD>Specifies the location of the Content Schedule file.

<P>This parameter can be specified either as a relative or virtual path. For example, if the Content Schedule file, ContRot.txt, and the .asp file that called <B>ChooseContent</B> both resided in the directory /MyApp/Data/, where MyApp is a virtual directory on the server, then either the full virtual path (/MyApp/Data/ContRot.txt) or the relative path (ContRot.txt) could be specified for <I>content-schedule-path</I>.


<P class=tl>The <U>Content Rotator Component</U> calls the <B>Server.MapPath</B> method to map the specified path to a physical directory. For more information, see the <A HREF="/iishelp/iis/htm/asp/vbob7838.htm"><B>Server Object</B></A> reference pages.
</DD>
</DL>

<H6>Return Value</H6>

<P>Returns an HTML content string from the Content Schedule file.</P>

<P><span class=le><B>Note</B></span></P>

<P>Because the <U>Content Rotator Component</U> uses a random generator to select which of the weighted content strings is displayed, a string may be repeated. This is most likely to occur if there are few entries in the Content Schedule file, or if one entry is weighted much higher than the others.</P>

<H6>Example</H6>

<P>The following example gets a new tip from the ContRot.txt file in the /Data/ virtual directory.</P>

<P>--- ContRot.asp ---</P>

<PRE><CODE>&lt;% 
  Set objContRot = Server.CreateObject("MSWC.ContentRotator") 
%&gt;
&lt;%= objContRot.ChooseContent("/Data/ContRot.txt") %&gt;  </CODE></PRE>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
