<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Metabase Structure</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H2><A NAME="_k2_metabase_structure"></A><SUP></SUP>Metabase Structure</H2>

<P>Most configuration settings for IIS reside in a storage facility, similar to the Windows registry, called the metabase. You should become familiar with how the metabase operates, how the information contained within the metabase is organized, and how you can access that information.</P>

<P>The metabase is organized in a hierarchical structure that mirrors the structure of your IIS installation. Each node in the metabase structure is called a key, and each key can contain one or more IIS configuration values, called metabase properties. The IIS metabase keys correspond to the elements of IIS, and each key contains properties that affect the configuration of its associated element.</P>

<P><IMG SRC="/iishelp/iis/htm/asp/art/metaprop.gif" ALT="IIS Metabase Properties" BORDER=0></P>

<P>Most of the IIS configuration keys and values that were stored in the system registry for earlier versions of IIS are now stored as properties in the metabase. New keys and values have been added for finer and more flexible control of IIS. The metabase was designed to allow the same property to be set differently at different nodes. For example, the <B>MaxBandWidth</B> property setting can be a different value for each server.</P>

<P>The general structure of IIS is shown in the following figure, which is arranged by key types. The metabase structure of your IIS installation can consist of a varied number of elements, depending on your installation choices. Metabase keys associated with IIS elements are addressed by their paths within the metabase. See <A HREF="/iishelp/iis/htm/asp/aint59pv.htm">Key Names and Paths</A>.</P>

<P><IMG SRC="/iishelp/iis/htm/asp/art/iisaostr.gif" ALT="IIS Metabase Structure" BORDER=0></P>

<P>The top-level metabase key, named IISComputer, contains properties such as <B>MaxBandWidth</B>. These properties affect the overall execution of IIS on your computer. Two subkeys of the Computer key are associated with FTP services and Web services, respectively, and contain properties that affect all FTP and Web servers hosted on that computer.</P>

<P>Subkeys of the FTP service key are associated with individual FTP servers, and contain properties specific to each FTP server. A subkey of each FTP server key is associated with the root virtual directory for that server. Other subkeys are added to the root virtual directory key as you add virtual directories to your FTP servers. Each of these subkeys contains properties that affect the operation or configuration of the associated virtual directory. The Info key, directly subordinate to the FTP service key, also contains some properties associated with the FTP service.</P>

<P>Subkeys of the Web service key are associated with individual Web servers, their root virtual directories, subordinate virtual directories, disk directories, and files. A subkey of the Web service key affects the configuration of filters used by Web service operations. The Info key, directly subordinate to the Web service key, also contains some properties associated with the Web service.</P>

<P>Other keys directly subordinate to the top-level key contain properties that affect logging and MIME mappings. The IISADMIN key is used to record DCOM extensions to IIS.</P>

<P>Keys can also contain references to objects that can be used by the IIS Admin Objects. For example, the CertMapper key does not contain any metabase properties, but it does provide access to the <B>IIsCertMapper</B> object and its methods for mapping certificates.</P>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
