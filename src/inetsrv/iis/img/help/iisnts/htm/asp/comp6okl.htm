<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Rotator Schedule File</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H2><A NAME="_rotator_schedule_file"></A><SUP></SUP>Rotator Schedule File</H2>

<P>The Rotator Schedule File contains information that the Ad Rotator component uses to manage and display the various advertisement images. In it you can specify the details for the advertisements, such as the size of the advertisement space, the image files to use, and the percentage of time that each file should be displayed.</P>

<P>The Rotator Schedule file has two sections. The first section sets parameters that apply to all advertisement images in the rotation schedule. The second section specifies file and location information for each individual advertisement and the percentage of display time that each advertisement should receive. The two sections are separated by a line containing only an asterisk (*).</P>

<P>In the first section there are four global parameters, each consisting of a keyword and a value. All are optional. If you do not specify values for the global parameters, the Ad Rotator<B> </B>uses default values. In this case, the first line of the file must contain only an asterisk (*).</P>

<P>After you change a Rotator Schedule File, the IIS Services may need to be restarted to pick up the change.</P>

<H6>Syntax </H6>

<P>[<B>REDIRECT</B> <I>URL</I>]</P>

<P>[<B>WIDTH</B> <I>numWidth</I>]</P>

<P>[<B>HEIGHT</B> <I>numHeight</I>]</P>

<P>[<B>BORDER</B> <I>numBorder</I>]</P>

<P><B>*</B></P>

<P><I>adURL</I></P>

<P><I>adHomePageURL</I></P>

<P><I>Text</I></P>

<P><I>impressions</I> </P>

<P>&nbsp;</P>

<H6>Parameters</H6>

<DL>
<DT><I>URL</I></DT>

<DD>Specifies the path to the dynamic-link library (.dll) or application (.asp) file that implements redirection. This path can be specified either fully (http://MyServer/MyDir/redirect.asp) or relative to the virtual directory (/MyDir/redirect.asp).<BR>
</DD>

<DT><I>numWidth</I></DT>

<DD>Specifies the width<B> </B>of the advertisement on the page, in pixels. The default is 440 pixels.<BR>
</DD>

<DT><I>numHeight</I></DT>

<DD>Specifies the height<B> </B>of the advertisement on the page, in pixels. The default is 60 pixels.<BR>
</DD>

<DT><I>numBorder</I></DT>

<DD>Specifies the thickness of the hyperlink border around the advertisement, in pixels. The default is a 1-pixel border. Set this parameter to 0 for no border.<BR>
</DD>

<DT><I>adURL</I></DT>

<DD>The location of the advertisement image file.<BR>
</DD>

<DT><I>adHomePageURL</I></DT>

<DD>The location of the advertiser's home page. If the advertiser does not have a home page, put a hyphen (-) on this line to indicate that there is no link for this ad.<BR>
</DD>

<DT><I>Text</I></DT>

<DD>Alternate text that is displayed if the browser does not support graphics, or has its graphics capabilities turned off.<BR>
</DD>

<DT><I>impressions</I></DT>

<DD>A number between 0 and 10000 that indicates the relative weight of the advertisement. 

<P>For example, if a Rotator Schedule file contains three ads with <I>impressions</I> set to 2, 3, and 5, the first advertisement is displayed 20 percent of the time, the second 30 percent of the time, and the third 50 percent of the time.
</DD>
</DL>

<P><span class=le><B>Note</B></span></P>

<P>If the sum of the impressions parameters for all items exceeds 10000, an error will be generated the first time the Rotator Schedule file is accessed by a call to the <A HREF="/iishelp/iis/htm/asp/comp4z90.htm"><B>GetAdvertisement</B></A> method.</P>

<H6>Example </H6>

<P>The following script demonstrates how you can use a rotator schedule file to display a variety of advertisements and how to include a redirection file.</P>

<P>--- Adrot.txt ---</P>

<PRE><CODE>REDIRECT Adredir.asp 
WIDTH 340
HEIGHT 100 
BORDER 1 
*
http://www.microsoft.com/library/homepage/images/init_win2k.gif 
http://www.microsoft.com/windows2000/guide/professional/overview/
Introducing Microsoft Windows XP Professional!
20
http://www.microsoft.com/library/homepage/images/init_dotnet.gif 
-
Sponsored by Flyteworks
20 
http://www.microsoft.com/library/homepage/images/init_office.gif
http://www.microsoft.com/office/
The Tools of Microsoft Office 2000
80 
http://www.microsoft.com/library/homepage/images/ts_001025msnexp.gif
http://explorer.msn.com/home.htm
MSN Explorer!  It's here at last!
10 
 </CODE></PRE>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
