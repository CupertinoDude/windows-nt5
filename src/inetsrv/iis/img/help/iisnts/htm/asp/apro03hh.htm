<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>AuthPersistence</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H3><A NAME="_k2_authpersistence"></A><SUP></SUP>AuthPersistence</H3>

<P>This property specifies authentication persistence across requests on a connection. It is recommended that you set this property by setting the corresponding subflag to TRUE, which will automatically set a binary value for <B>AuthPersistence.</B></P>

<P>If the <B>AuthPersistSingleRequest</B> is set to TRUE, then authentication persists only for a single request. If <B>AuthPersistSingleRequestIfProxy</B> is set to TRUE, then authentication persists only for a single request if it is a proxy request and the request is not handled by Microsoft Proxy Server. (That is, if Proxy Server and IIS are running on the local computer, and the request is targeted to a remote server.) If <B>AuthPersistSingleRequestAlwaysIfProxy</B> is set to TRUE, then authentication is valid for a single request if the request is by proxy.</P>

<P><span class=le><B>Note</B></span>&nbsp;&nbsp;&nbsp;Only one sub-flag of <B>AuthPersistence</B> can be TRUE at one time. The subflags are <B>AuthPersistSingleRequest</B>,<B> AuthPersistSingleRequestIfProxy</B>, and <B>AuthPersistSingleRequestAlwaysIfProxy</B>. When one of these three properties is set to TRUE, the other two properties are automatically set to FALSE. The value of <B>AuthPersistence</B> always equals the value of the sub-flag that is set to TRUE.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Data type</TD>
<TD width=50%>Long</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default value</TD>
<TD width=50%>&amp;H00000080 (or <B>AuthPersistSingleRequestIfProxy</B>=TRUE)</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Inheritance</TD>
<TD width=50%>Inheritable</TD>
</TR>
</TABLE><BR>

<P>This single property contains the following file access permission flags.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro3038.htm"><B>AuthPersistSingleRequest</B></A></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro4ry1.htm"><B>AuthPersistSingleRequestAlwaysIfProxy</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro06m1.htm"><B>AuthPersistSingleRequestIfProxy</B></A></TD>
<TD width=50%>&nbsp;</TD>
</TR>
</TABLE><BR>

<H6>Access Locations</H6>

<P>This property is accessible at the following locations:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Metabase Path</B></TD>
<TD class=blue width=50%><B>Key Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC</TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore1p5x.htm"><B>IIsWebService</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore7zn6.htm"><B>IIsWebServer</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT</TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore8v5e.htm"><B>IIsWebVirtualDir</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT/<I>WebVirtualDir</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore8v5e.htm"><B>IIsWebVirtualDir</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT/<I>WebVirtualDir</I>/<I>WebDirectory</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore1jw9.htm"><B>IIsWebDirectory</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT/<I>WebVirtualDir</I>/<I>WebDirectory</I>/<I>WebFile</I></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore136t.htm"><B>IIsWebFile</B></A></TD>
</TR>
</TABLE><BR>

<H6>IIS Admin Base Object Information</H6>

<P>The following tables list additional information required only for code that uses the IIS Admin Base Object.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Metabase identifier</TD>
<TD width=50%><B>MD_AUTHORIZATION_PERSISTENCE</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>User type</TD>
<TD width=50%><B>IIS_MD_UT_FILE</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default bitmask setting</TD>
<TD width=50%><B>MD_AUTH_SINGLEREQUESTIFPROXY</B></TD>
</TR>
</TABLE><BR>

<H6>Bitmask Values</H6>

<TABLE border=0 cellpadding=5 cols=3 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Constant</B></TD>
<TD class=blue width=16%><B>Value</B></TD>
<TD class=blue width=34%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_AUTH_SINGLEREQUEST</B></TD>
<TD width=16%>0x00000040</TD>
<TD width=34%>Authentication is valid for a single request. IIS will reset the authentication at the end of the request, and force re-authentication on the next request of the session.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_AUTH_SINGLEREQUESTIFPROXY</B></TD>
<TD width=16%>0x00000080</TD>
<TD width=34%>Authentication is valid for a single request. IIS will reset the authentication at the end of the request if the current authenticated request is by proxy, and it is not the special case where IIS is running MSPROXY.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_AUTH_SINGLEREQUESTALWAYSIFPROXY</B></TD>
<TD width=16%>0x00000100</TD>
<TD width=34%>Authentication is valid for a single request. IIS will reset the authentication at the end of the request and force re-authentication on the next request if the current authenticated request is by any type of proxy.</TD>
</TR>
</TABLE><BR>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
