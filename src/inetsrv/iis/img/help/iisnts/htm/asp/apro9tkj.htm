<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>ScriptMaps</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H3><A NAME="_k2_scriptmaps"></A><SUP></SUP>ScriptMaps</H3>

<P>This metabase property specifies the file name extensions of applications used for script processor mappings. The List string requires <I>Extension</I>,<I> ScriptProcessor</I>, <I>Flags, IncludedVerbs</I>. <I>Extension</I> is the file name extension (such as .htm), <I>ScriptProcessor</I> is the full path to the DLL, <I>Flags</I> is the integer value corresponding to the requested behavior described below, and <I>IncludedVerbs</I> is a list of the verbs that this ISAPI DLL to handle. </P>

<P><span class=le><B>Note</B></span>&nbsp;&nbsp;&nbsp;In IIS version 4.0 and earlier, the syntax was to list <I>excluded</I> verbs rather than <I>included</I> verbs. In version 5.1, if no verbs are listed, a value of "all verbs" is assumed. It is recommended that you list the verbs you want your ISAPI filter or extension to handle.</P>

<P>Three possible flags are allowed for each extension mapping, so one of three possible values can be assigned to the <I>Flags</I> attribute.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Possible <I>Flag</I> values</B></TD>
<TD class=blue width=50%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>1</TD>
<TD width=50%>The script is allowed to run in directories given Script permission. If this value is not set, then the script can only be executed in directories that are flagged for Execute permission.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>4</TD>
<TD width=50%>The server attempts to access the PATH_INFO portion of the URL, as a file, before starting the scripting engine. If the file can't be opened, or doesn't exist, an error is returned to the client.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>5</TD>
<TD width=50%>Both of the above conditions are TRUE.</TD>
</TR>
</TABLE><BR>

<P>For example, to specify the file extension for the ISAPI "Test.dll" with a file extension of ".htm", you might provide the following List (string):<BR>
</P>

<PRE>".htm,C:\WINNT40\System32\inetsrv\Test.dll,5,GET, HEAD, POST"
</PRE>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Data type</TD>
<TD width=50%>List (string)</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default value</TD>
<TD width=50%>Empty list</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Inheritance</TD>
<TD width=50%>Inheritable</TD>
</TR>
</TABLE><BR>

<P><span class=le><B>Note</B></span>  IIS allows an "*" in place of the file name extension, which effectively routes all requests though the designated <I>ScriptProcessor</I>. This feature is useful when applying a custom ISAPI extension that will handle requests from all file types.</P>

<H6>Access Locations</H6>

<P>This property is accessible at the following locations:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Metabase Path</B></TD>
<TD class=blue width=50%><B>Key Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC</TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore1p5x.htm"><B>IIsWebService</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore7zn6.htm"><B>IIsWebServer</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT</TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore8v5e.htm"><B>IIsWebVirtualDir</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT/<I>WebVirtualDir</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore8v5e.htm"><B>IIsWebVirtualDir</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT/<I>WebVirtualDir</I>/<I>WebDirectory</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore1jw9.htm"><B>IIsWebDirectory</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I>/ROOT/<I>WebVirtualDir</I>/<I>WebDirectory</I>/<I>WebFile</I></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore136t.htm"><B>IIsWebFile</B></A></TD>
</TR>
</TABLE><BR>

<H6>IIS Admin Base Object Information</H6>

<P>The following tables list additional information required only for code that uses the IIS Admin Base Object.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Metabase identifier</TD>
<TD width=50%><B>MD_SCRIPT_MAPS</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Data type</TD>
<TD width=50%><B>MULTISZ_METADATA</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default bitmask value</TD>
<TD width=50%>Empty </TD>
</TR>

<TR VALIGN="top">
<TD width=50%>User type</TD>
<TD width=50%><B>IIS_MD_UT_FILE</B></TD>
</TR>
</TABLE><BR>

<H6>Bitmask value</H6>

<TABLE border=0 cellpadding=5 cols=3 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Constant</B></TD>
<TD class=blue width=18%><B>Value</B></TD>
<TD class=blue width=32%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_SCRIPTMAPFLAG_SCRIPT</B></TD>
<TD width=18%>0x00000001</TD>
<TD width=32%>Allowed to run if permission is set to Script.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_SCRIPTMAPFLAG_CHECK_PATH_INFO</B></TD>
<TD width=18%>0x00000004</TD>
<TD width=32%>Server checks PATH_INFO.</TD>
</TR>
</TABLE><BR>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
