<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>GetAllContent</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H2><A NAME="_getallcontent"></A><SUP></SUP>GetAllContent</H2>

<P>The <B>GetAllContent</B> method retrieves all of the HTML content strings from the Content Schedule file and writes them directly to the Web page as a list with an &lt;HR&gt; tag after each entry. </P>

<P>This method is typically used during authoring, to proofread the Content Schedule file.</P>

<H6>Syntax</H6>

<P><I>ContRot</I><B> .GetAllContent( </B><I>content-schedule-path </I><B>) </B></P>

<P><B>&nbsp;</B></P>

<H6>Parameters</H6>

<DL>
<DT><I>content-schedule-path</I></DT>

<DD>Specifies the location of the Content Schedule file. 

<P>This parameter can be specified either as a relative or virtual path. For example, if the Content Schedule file, ContRot.txt, and the .asp file that called <B>GetAllContent</B> both resided in the directory /MyApp/Data/, where MyApp is a virtual root on the server, then either the full virtual path (/MyApp/Data/ContRot.txt) or the relative path (ContRot.txt) could be specified for <I>content-schedule-path</I>.


<P class=tl>The <B>ContentRotator</B> object calls the <B>Server.MapPath</B> method to map the specified path to a physical directory. For more information, see the <A HREF="/iishelp/iis/htm/asp/vbob7838.htm"><B>Server Object</B></A> Reference pages.
</DD>
</DL>

<H6>Return Values</H6>

<P>None. </P>

<P><span class=le><B>Note</B></span></P>

<P>The Content Rotator component uses the Response.Write method to write output directly to the .asp page that called the GetAllContent method. For more information, see the <A HREF="/iishelp/iis/htm/asp/vbob5sj8.htm"><B>Response Object</B></A><I> </I>reference page<I>.</I></P>

<H6>Example</H6>

<P>The following example uses the <B>GetAllContent</B> method to display all of the entries in the Content Schedule file. </P>

<P>--- ContRot_AllContent.asp ---</P>

<PRE><CODE>&lt;H1&gt;Tips Stored in the Content Schedule File:&lt;/H1&gt;
&lt;% Set objContRot = Server.CreateObject("MSWC.ContentRotator") %&gt;
&lt;%=objContRot.GetAllContent("/Data/ContRot.txt") %&gt;
 </CODE></PRE>

<P>The preceding example produces HTML output such as the following:</P>

<PRE><CODE>&lt;H1&gt;Tips Stored in the Content Schedule File:&lt;/H1&gt;
&lt;hr&gt;
Don't run with scissors.
&lt;hr&gt;
&lt;FONT FACE="ARIAL,HELVETICA" SIZE="2"&gt;
  Be like a
  &lt;H1&gt;duck&lt;/H1&gt;
  calm on the surface, paddling like mad underneath.
&lt;/FONT&gt;
&lt;hr&gt;
&lt;IMG SRC="http://zone.msn.com/graphics/hotgames_msn.gif"&gt;
&lt;hr&gt;
Here's the &lt;A HREF="/data/controt.txt"&gt;secret link&lt;/A&gt; to your content file.
&lt;hr&gt;
 </CODE></PRE>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
