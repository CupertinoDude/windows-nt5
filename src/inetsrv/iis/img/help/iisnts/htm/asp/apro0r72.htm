<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>HcDoOnDemandCompression</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H3><A NAME="_k2_hcdoondemandcompression"></A><SUP></SUP>HcDoOnDemandCompression</H3>

<P>This metabase property specifies whether static files, such as .htm and .txt files, will be compressed if no compressed version of the file exists in the directory specified by <A HREF="/iishelp/iis/htm/asp/apro18mx.htm"><B>HcCompressionDirectory</B></A>.</P>

<P>At a global level, if this property is set to TRUE, and if IIS receives a request for static content, IIS will check the compression directory. If no corresponding compressed version of the requested file is found, IIS will send an <I>uncompressed</I> version of the requested file to the client browser while a background thread compresses the file. The newly compressed file will then be stored in the compression directory, and subsequent responses to requests for that file will be serviced directly from the directory.</P>

<P>If <B>HcDoOnDemandCompression</B> is set to FALSE at a global level, however, IIS will not compress static content files for which it finds no corresponding compressed version in the compression directory. In other words, an uncompressed version of the file will be returned for every request, unless a compressed version of the file already exists in the compression directory.</P>

<P>At an individual compression scheme level, <B>HcDoOnDemandCompression</B> indicates whether that particular compression scheme supports on-demand compression.</P>

<P>Because <B>HcDoOnDemandCompression</B> is not inheritable, in order for static on-demand compression to actually be enabled for a server, <B>HcDoOnDemandCompression</B> must be set to TRUE at both the global and individual scheme level.</P>

<P>If you change the value of this property at the individual compression scheme level, the Web service will need to be restarted for the change to take effect.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Data type</TD>
<TD width=50%>Boolean</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default value</TD>
<TD width=50%>TRUE</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Inheritance</TD>
<TD width=50%>Not inheritable</TD>
</TR>
</TABLE><BR>

<H6>Access Locations</H6>

<P>This property is accessible at the following locations:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Metabase Path</B></TD>
<TD class=blue width=50%><B>Key Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/Filters/Compression/Parameters</TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore4mcz.htm"><B>IIsCompressionSchemes</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/Filters/Compression/<I>Scheme</I></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore6sh1.htm"><B>IIsCompressionScheme</B></A></TD>
</TR>
</TABLE><BR>

<H6>IIS Admin Base Object Information</H6>

<P>The following table lists additional information required only for code that uses the IIS Admin Base Object.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Metabase identifier</TD>
<TD width=50%><B>MD_HC_DO_ON_DEMAND_COMPRESSION</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Data type</TD>
<TD width=50%><B>DWORD_METADATA</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>User type</TD>
<TD width=50%><B>IIS_MD_UT_SERVER</B></TD>
</TR>
</TABLE><BR>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
