<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CpuLoggingMask</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H3><A NAME="_k2_cpuloggingmask"></A><SUP></SUP>CpuLoggingMask</H3>

<P>This metabase property specifies which process accounting and throttling fields should be written to the IIS log file. All enabled fields will be written on every process accounting log. All values logged are for the reset interval in which the logging occurs.</P>

<P><span class=le><B>Note</B></span>&nbsp;&nbsp;&nbsp;Because process accounting in IIS uses Windows Job Objects to monitor CPU times for an entire process, process accounting will log and throttle only applications that are isolated in a separate process from IIS.</P>

<P>This property contains the following flags:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro2jtz.htm"><B>CpuEnableLogging</B></A></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro15np.htm"><B>CpuEnableProcType</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro92yb.htm"><B>CpuEnableActiveProcs</B></A></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro8ss3.htm"><B>CpuEnableTerminatedProcs</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro87p0.htm"><B>CpuEnableEvent</B></A></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro1h9v.htm"><B>CpuEnableTotalProcs</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro852d.htm"><B>CpuEnableKernelTime</B></A></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro1bxh.htm"><B>CpuEnableUserTime</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro1hir.htm"><B>CpuEnablePageFaults</B></A></TD>
<TD width=50%>&nbsp;</TD>
</TR>
</TABLE><BR>

<P>You can also change the logging mask flags by directly manipulating the flags contained in <B>CpuLoggingMask</B> by using the hexadecimal values described in the following tables.</P>

<P>Process throttling and process accounting are independently controlled by several other metabase properties. In order to enable process accounting you must set <A HREF="/iishelp/iis/htm/asp/apro2jtz.htm"><B>CpuEnableLogging</B></A> (which is a member of <B>CpuLoggingMask</B>) to TRUE, and set at least one other <B>CpuLoggingMask </B>property to TRUE. It is also necessary to set at least one member flag of the <A HREF="/iishelp/iis/htm/asp/apro0eib.htm"><B>CpuLoggingOptions</B></A>, set <A HREF="/iishelp/iis/htm/asp/apro02ss.htm"><B>CpuLoggingInterval</B></A> to a nonzero value, and set either <A HREF="/iishelp/iis/htm/asp/apro7hus.htm"><B>CpuAppEnabled</B></A> or <A HREF="/iishelp/iis/htm/asp/apro709w.htm"><B>CpuCgiEnabled</B></A>, as appropriate, to TRUE.</P>

<P>To properly activate process throttling, <A HREF="/iishelp/iis/htm/asp/apro7vdw.htm"><B>CpuLimitsEnabled</B></A> must be set to TRUE, and at least one of the following properties should be set to TRUE:&nbsp; <A HREF="/iishelp/iis/htm/asp/apro7e9g.htm"><B>CpuLimitLogEvent</B></A>, <A HREF="/iishelp/iis/htm/asp/apro0mm1.htm"><B>CpuLimitPriority</B></A>, <A HREF="/iishelp/iis/htm/asp/apro65rk.htm"><B>CpuLimitProcStop</B></A>, or <A HREF="/iishelp/iis/htm/asp/apro9k85.htm"><B>CpuLimitPause</B></A>.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Data type</TD>
<TD width=50%>Long</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default value</TD>
<TD width=50%>All Member Flags = TRUE</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Inheritance</TD>
<TD width=50%>Inheritable</TD>
</TR>
</TABLE><BR>

<H6>Access Locations</H6>

<P>This property is accessible at the following locations:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Metabase Path</B></TD>
<TD class=blue width=50%><B>Key Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC</TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore1p5x.htm"><B>IIsWebService</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore7zn6.htm"><B>IIsWebServer</B></A></TD>
</TR>
</TABLE><BR>

<H6>IIS Admin Base Object Information</H6>

<P>The following tables list additional information required only for code that uses the IIS Admin Base Object.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Metabase identifier</TD>
<TD width=50%><B>MD_CPU_LOGGING_MASK</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>User type</TD>
<TD width=50%><B>IIS_MD_UT_SERVER</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default bitmask setting
<P class=atl><span class=le><B>Note</B></span>&nbsp;&nbsp;&nbsp;Multiple bits are set by default.</P>
</TD>
<TD width=50%><B>MD_CPU_ENABLE_LOGGING</B>
<P><B>MD_CPU_ENABLE_EVENT</B></P>

<P><B>MD_CPU_ENABLE_PROC_TYPE</B></P>

<P><B>MD_CPU_ENABLE_USER_TIME</B></P>

<P><B>MD_CPU_ENABLE_KERNEL_TIME</B></P>

<P><B>MD_CPU_ENABLE_PAGE_FAULTS</B></P>

<P><B>MD_CPU_ENABLE_TOTAL_PROCS</B></P>

<P><B>MD_CPU_ENABLE_ACTIVE_PROCS</B></P>

<P><B>MD_CPU_ENABLE_TERMINATED_PROCS</B></P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default bitmask value</TD>
<TD width=50%>0x800000FF</TD>
</TR>
</TABLE><BR>

<H6>Bitmask Values</H6>

<TABLE border=0 cellpadding=5 cols=3 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Constant</B></TD>
<TD class=blue width=18%><B>Value</B></TD>
<TD class=blue width=32%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_LOGGING</B></TD>
<TD width=18%>0x80000000</TD>
<TD width=32%>Specifies whether process accounting is enabled.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_EVENT</B></TD>
<TD width=18%>0x00000001</TD>
<TD width=32%>Log site events, such as start, stop, and site process throttling.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_PROC_TYPE</B></TD>
<TD width=18%>0x00000002</TD>
<TD width=32%>Log the process type.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_USER_TIME</B></TD>
<TD width=18%>0x00000004</TD>
<TD width=32%>Log the total user CPU time, as a percentage of total CPU time, in 1/1000ths of a percent.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_KERNEL_TIME</B></TD>
<TD width=18%>0x00000008</TD>
<TD width=32%>Log the total kernel CPU time, as a percentage of total CPU time, in 1/1000ths of a percent.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_PAGE_FAULTS</B></TD>
<TD width=18%>0x00000010</TD>
<TD width=32%>Log the total number of page faults.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_TOTAL_PROCS</B></TD>
<TD width=18%>0x00000020</TD>
<TD width=32%>Log the total number of processes.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_ACTIVE_PROCS</B></TD>
<TD width=18%>0x00000040</TD>
<TD width=32%>Log the total number of active processes.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_TERMINATED_PROCS</B></TD>
<TD width=18%>0x00000080</TD>
<TD width=32%>Log the total number of terminated processes.</TD>
</TR>
</TABLE><BR>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
