<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>CpuLoggingOptions</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H3><A NAME="_k2_cpuloggingoptions"></A><SUP></SUP>CpuLoggingOptions</H3>

<P>This metabase property contains flags that specify how IIS should log CPU times for services, servers, or applications. You can use this property to configure IIS to sum the CPU times of CGI applications only, of ISAPI extensions and ASP applications only, or of all applications.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Data type</TD>
<TD width=50%>Long</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default value</TD>
<TD width=50%>1</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Inheritance</TD>
<TD width=50%>Inheritable</TD>
</TR>
</TABLE><BR>

<P><span class=le><B>Note</B></span>&nbsp;&nbsp;&nbsp;Because process accounting in IIS uses Windows Job Objects to monitor CPU times for an entire process, process accounting will log and throttle only applications that are isolated in a separate process from IIS.</P>

<P>You can also directly manipulate the bit flags within <B>CpuLoggingOptions </B>by using the hexadecimal values in the following Bitmask Values table.</P>

<P>Process throttling and process accounting are independently controlled by several other metabase properties. In order to enable process accounting you must set <A HREF="/iishelp/iis/htm/asp/apro2jtz.htm"><B>CpuEnableLogging</B></A> (which is a member of <A HREF="/iishelp/iis/htm/asp/apro252j.htm"><B>CpuLoggingMask</B></A>) to TRUE, and set at least one other <A HREF="/iishelp/iis/htm/asp/apro252j.htm"><B>CpuLoggingMask</B></A> property to TRUE. It is also necessary to set at least one member flag of the <B>CpuLoggingOptions</B>, set <A HREF="/iishelp/iis/htm/asp/apro02ss.htm"><B>CpuLoggingInterval</B></A> to a nonzero value, and set either <A HREF="/iishelp/iis/htm/asp/apro7hus.htm"><B>CpuAppEnabled</B></A> or <A HREF="/iishelp/iis/htm/asp/apro709w.htm"><B>CpuCgiEnabled</B></A>, as appropriate, to TRUE.</P>

<P>To properly activate process throttling, <A HREF="/iishelp/iis/htm/asp/apro7vdw.htm"><B>CpuLimitsEnabled</B></A> must be set to TRUE, and at least one of the following properties should be set to TRUE:&nbsp; <A HREF="/iishelp/iis/htm/asp/apro7e9g.htm"><B>CpuLimitLogEvent</B></A>, <A HREF="/iishelp/iis/htm/asp/apro0mm1.htm"><B>CpuLimitPriority</B></A>, <A HREF="/iishelp/iis/htm/asp/apro65rk.htm"><B>CpuLimitProcStop</B></A>, or <A HREF="/iishelp/iis/htm/asp/apro9k85.htm"><B>CpuLimitPause</B></A>. </P>

<P>This property contains the following flags:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro33on.htm"><B>CpuEnableAppLogging</B></A></TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro365j.htm"><B>CpuEnableAllProcLogging</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><A HREF="/iishelp/iis/htm/asp/apro2m3r.htm"><B>CpuEnableCgiLogging</B></A></TD>
<TD width=50%>&nbsp;</TD>
</TR>
</TABLE><BR>

<H6>Access Locations</H6>

<P>This property is accessible at the following locations:</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Metabase Path</B></TD>
<TD class=blue width=50%><B>Key Type</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC</TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore1p5x.htm"><B>IIsWebService</B></A></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>/LM/W3SVC/<I>N</I> </TD>
<TD width=50%><A HREF="/iishelp/iis/htm/asp/aore7zn6.htm"><B>IIsWebServer</B></A></TD>
</TR>
</TABLE><BR>

<H6>IIS Admin Base Object Information</H6>

<P>The following tables list additional information required only for code that uses the IIS Admin Base Object.</P>

<TABLE border=0 cellpadding=5 cols=2 frame=box rules=all>

<TR VALIGN="top">
<TD width=50%>Metabase identifier</TD>
<TD width=50%><B>MD_CPU_LOGGING_OPTIONS</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>User type</TD>
<TD width=50%><B>IIS_MD_UT_SERVER</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>Default bitmask setting</TD>
<TD width=50%><B>MD_CPU_ENABLE_ALL_PROC_LOGGING</B></TD>
</TR>
</TABLE><BR>

<H6>Bitmask Values</H6>

<TABLE border=0 cellpadding=5 cols=3 frame=box rules=all>

<TR VALIGN="top">
<TD class=blue width=50%><B>Constant</B></TD>
<TD class=blue width=18%><B>Value</B></TD>
<TD class=blue width=32%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_DISABLE_ALL_LOGGING</B></TD>
<TD width=18%>0x00000000</TD>
<TD width=32%>Do not log CPU information.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_ALL_PROC_LOGGING</B></TD>
<TD width=18%>0x00000001</TD>
<TD width=32%>Log the sum of CPU time used by applications and CGI.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_CGI_LOGGING</B></TD>
<TD width=18%>0x00000002</TD>
<TD width=32%>Log the CPU time used by CGI applications.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%><B>MD_CPU_ENABLE_APP_LOGGING</B></TD>
<TD width=18%>0x00000004</TD>
<TD width=32%>Log the CPU time used by ISAPI and ASP applications.</TD>
</TR>
</TABLE><BR>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
