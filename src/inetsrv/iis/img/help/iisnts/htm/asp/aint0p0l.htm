<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Property Inheritance</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H2><A NAME="_k2_property_inheritance"></A><SUP></SUP>Property Inheritance</H2>

<P>You can use the property inheritance feature of the metabase to configure your IIS installation with few settings, and to minimize the amount of memory required for the metabase. Most metabase properties are inheritable, meaning that they are not explicitly set at a specific key and will inherit values assigned at higher-level keys. For example, you can set file and directory permissions such as <B>AccessScript</B>, <B>AccessExecute</B> and <B>AccessWrite</B> at the W3SVC level to apply to all files and directories in all server instances, or you can set them at the W3SVC/2/ROOT level to apply to all files and directories for the second Web server only. You can then set different permissions for individual subdirectories and files by explicitly setting them at lower levels. For example, you might set the <B>AccessExecute</B> permission property to TRUE for specific directories, virtual directories, or files, such as ...W3SVC/1/ROOT/VDir1/VDir1a, ...W3SVC/1/ROOT/VDir2/Dir2d, and ...W3SVC/1/ROOT/VDir2/Dir3/File1, and so on. </P>

<P>The default settings for <B>AccessScript</B>, <B>AccessExecute</B>, and <B>AccessWrite</B> are all FALSE. The way inheritance works is that wherever you set the value of an inheritable property, all instances of that property in the remaining subnodes will be set automatically. If you use IIS snap-in (also called the Internet Services Manager) to set an inheritable property, a dialog box will ask you if you are sure you want to change the value for all the subnodes. However, if you use a script or the command line to set an inheritable property, the values will be propagated immediately.</P>

<P>In the following example, <B>AccessScript</B> is set to TRUE at the Web service level (.../W3SVC), <B>AccessExecute</B> to TRUE at the root level (.../W3SVC/1/ROOT), and <B>AccessWrite</B> to TRUE at the file level (.../W3SVC/<I>n</I>/ROOT/<I>VDir/Dir/File</I>). The round ball represents where the user sets the property value and the arrows show the path of inheritance as the value is propagated through the subnodes.</P>

<P><IMG SRC="/iishelp/iis/htm/asp/art/inherit.gif" ALT="Inheritance Example" BORDER=0></P>

<P>Most metabase properties are inheritable, except for a few that are used only at specific keys. Some properties in the metabase are lists of values, such as the <B>ServerBindings</B> property.</P>

<P>Flag properties, such as file access permissions, are often combined into one DWORD by use of bitmasking. The entire set of flags is stored together and inherits together. For example, if you change one of the file access permissions, such as <B>AccessExecute</B> for a directory, the entire set of file access permissions is stored at the metabase key for that directory.</P>

<P>Each metabase property is described in detail in the <A HREF="/iishelp/iis/htm/asp/apro3usl.htm">Administration Property Reference</A>. This reference includes information about whether each property is inheritable. Also, properties that are stored as part of a larger set are identified as flags; for example, see the property <A HREF="/iishelp/iis/htm/asp/apro2n1v.htm"><B>AccessFlags</B></A>.</P>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
