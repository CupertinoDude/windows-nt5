<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Metabase Security and Reliability</TITLE>
<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script>
<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT><META NAME="DESCRIPTION" CONTENT="Internet Information Services reference information">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services"> 
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<H2><A NAME="_k2_metabase_security_and_reliability"></A><SUP></SUP>Metabase Security and Reliability</H2>

<H6>Metabase Access Control</H6>

<P>The metabase key values are stored in a disk file, which is named Metabase.bin by default. The metabase is loaded from disk when IIS starts, stored to disk when IIS shuts down, and saved periodically while IIS is running. It is important to protect this file from unauthorized use. It is recommended that you store this file on an NTFS partition and use Windows security to protect it.</P>

<P>Metabase.bin is stored in the Inetsrv directory. You can move or rename the file and change the Windows registry setting that tells IIS where to find the file on startup. To relocate or rename the metabase file, you must stop IIS, move or rename the file, and modify the registry key LOCAL_MACHINE\SOFTWARE\Microsoft\INetMgr\Parameters. Then add a REG_SZ value, named MetadataFile, to this key. MetadataFile<B> </B>specifies the new complete path of the metabase file, including the drive letter and file name.</P>

<H6>Metabase Reliability</H6>

<P>You can implement your own custom backup policy for the metabase, or create specialized backup tools. Your application can use the methods provided by the <A HREF="/iishelp/iis/htm/asp/aore2xpu.htm"><B>IIsComputer</B></A> object (for IIS Admin Objects) or <B>IMSAdminBase</B> (for the IIS Admin Base Object) to manage metabase backups. You can store multiple backup versions in long-term storage, restore the metabase from a backup version of your choice, and enumerate and delete backups.</P>

<P><span class=le><B>Important&nbsp;&nbsp;&nbsp;</B></span>The metabase backup and restore functionality has been updated for IIS 5.1. Legacy metabase backups exist for versioning purposes, not for cross-machine replication. A legacy metabase backup must be restored only to the same machine on which it was originally created. For more information about creating and restoring metabase backups, see <a href="..\core\iitasks.htm">Backing Up the Metabase</a> and <a href="..\core\iirestore.htm">Restoring the Metabase</a>.</P>

<P>For more information, see the Advanced Programmatic Administration section in the Platform SDK.</P>
<hr class="iis" size="1">
<p align="center"><em><a href="../../../common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>
</BODY>
</HTML>
