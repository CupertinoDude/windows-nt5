<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html dir=ltr>
<head>
<title>Important Changes in ASP</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<META NAME="DESCRIPTION" CONTENT="This topic describes important differences between the current and previous release of ASP, such as default settings changes and behavior changes.">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">
<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000"><font face="Verdana,Arial,Helvetica">	

<h1><a name="whatschanged">Important Changes in ASP</a></h1>


<P>ASP has undergone several important changes and enhancements. If you are updating your application from a previous version of ASP, you should be aware of these changes.</P>

<p><strong>Note</strong>&nbsp;&nbsp;&nbsp;To learn about new ASP features, see <A HREF="iiwanew.htm">What's New in ASP</A>.</p>

<UL>

<LI><STRONG>Buffering On by Default</STRONG>&nbsp;In IIS&nbsp;4.0, response buffering was off by default. In IIS&nbsp;5.1, unless a script specifically turns off buffering, its output is always buffered. This means that the final output is sent to the client at the completion of processing or when the script calls the <STRONG>Response.Flush</STRONG> method.  When upgrading from IIS&nbsp;4.0 to IIS&nbsp;5.1, the IIS&nbsp;4.0 settings are maintained. Therefore, response buffering remains off until it is turned on. For more information, see the <A HREF="iiwacont.htm#buffcnt">Buffering Content</A> section in the Sending Content to the Browser topic.</LI><BR><BR>


<LI><STRONG>Response.IsClientConnected</STRONG>&nbsp;In IIS&nbsp;4.0, <STRONG>Response.IsClientConnected</STRONG> returned the correct information only if an ASP file sent content to the browser. In IIS&nbsp;5.1, an ASP file can use the <STRONG>IsClientConnected</STRONG> property prior to sending content to the browser.  For more information, see <A HREF="vbob1d0k.htm"><STRONG>IsClientConnected</STRONG></A>.</LI><BR><BR>


<LI><STRONG>Improved Include File Security</STRONG>&nbsp;In IIS&nbsp;4.0, when an include file resided in a virtual root mapped to a physical path,  ASP did not use the security credentials of the physical path to process the file.  In IIS&nbsp;5.1, ASP applies the credentials of the physical path when processing include files. For more information, see <A HREF="iiwainc.htm">Including Files</A>.</LI><BR><BR>

<LI><STRONG>Default Document Query String Behavior</STRONG>&nbsp;In IIS&nbsp;5.1, if an .asp (or .cdx) file is configured as the default document, it can now receive a query string from a URL that does not specify the default document. For example, the URLs <CODE>http://www.microsoft.com/default.asp?newuser=true</CODE> and <CODE>http://www.microsoft.com/?newuser=true</CODE> will both send a query string value to the default .asp file.</LI><BR><BR>


<LI><STRONG>Transaction Flags</STRONG>&nbsp;IIS&nbsp;4.0 used the <STRONG>required</STRONG>, <STRONG>requires new</STRONG>, and <STRONG>not supported</STRONG> transaction flags to indicate that ASP was starting a new transaction. In IIS&nbsp;5.1, this behavior is unchanged. However, if an .asp file executes a transacted .asp file using the new <STRONG>Server.Execute</STRONG> or <STRONG>Server.Transfer</STRONG> methods, then the transaction flag state is maintained for the second .asp file. If the second .asp file's transaction flags indicate that transactions are supported or required, then the existing transaction will be used and a new transaction will not be started.</LI><BR><BR>

<LI><STRONG>Behavior of Both-Modeled Objects</STRONG>&nbsp;A Both-Modeled COM object which does not support the Free-Threaded Marshaller will fail if it is stored in Application state. Both-Modeled components must aggregate the Free-Threaded Marshaller to be stored in Application state.</LI><BR><BR> 

<LI><STRONG>Configurable Entries Moved to the Metabase</STRONG>&nbsp;The following IIS&nbsp;4.0 registry entries are now in the metabase:</LI>
<UL>
	<LI>ProcessorThreadMax</li>
	<LI>ErrorsToNTLog</li>
</UL>

<P>For IIS&nbsp;5.1, all configurable parameters for ASP can be modified from the metabase.  For more information, see <A HREF="../core/iimbsovr.htm">About the Metabase</A>.</P>

<LI><STRONG>Security for Local Server COM Objects</STRONG>&nbsp;IIS uses a new Windows COM feature called <EM>cloaking</EM> to enable local server applications instantiated from an .asp file to have the security context of the originating client. In previous versions, the identity assigned to the local server COM object depended on the identity of the user who created the object instance.</LI><BR><BR>

<LI><STRONG>Objects Released Earlier</STRONG>&nbsp;In IIS&nbsp;4.0, COM objects were only released when ASP finished processing a page. In IIS&nbsp;5.1, if a COM object does not use the <STRONG>OnEndPage</STRONG> method and the reference count for the object is zero, then the object is released prior to the completion of processing.</LI><BR><BR>

</UL><BR><BR>

<hr class="iis" size="1">
<p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
