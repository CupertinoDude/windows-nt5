<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="ClientCertificate">
<meta name="description" content="Internet Information Services reference information">
<title>ClientCertificate</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>ClientCertificate</h3><p>The <b>ClientCertificate</b> collection holds fields of keys and
values from a security certificate that the client browser passes
to the Web server. These fields are specified in the X.509 version
3 standard for public key certificates. Because X.509 is not an
official standard, you may notice differences among certificates
obtained from certificate authorities. See <a href="http://www.microsoft.com/isapi/redir.dll?prd=external&amp;sbp=W3org&amp;pver=1.0&amp;ar=specs" target="_New"><b><b>World Wide Web Consortium Web site</b></b></a> for
an article titled <b>X509 Certificate</b>.</p><p>In order to populate the fields of the <b>ClientCertificate</b>
collection, both the Web server and the client browser must support
the SSL3.0/PCT1.0 protocol. The Web site must have SSL enabled and
request client certificates. Once SSL is enabled, the URL of the
Web site will start with "https://" instead of "http://". The
client browser must be capable of sending a certificate. If no
certificate is sent, the <b>ClientCertificate</b> collection
returns EMPTY.</p><p>To configure your Web server to request client certificates, see
<a href="sec_auth_certsetssl.htm"><b>Setting Up SSL on Your Server</b></a>.</p><p>To read the values in each field of the <b>ClientCertificate</b>
collection, pass in a key name and optional subfield name.</p><h6>Syntax</h6><p><b>Request.ClientCertificate(</b><i>Key</i>[<i>SubField</i>]
<b>)</b></p><p><b> </b></p><h6>Parameters</h6><dl><dt><i>Key</i></dt><dd>Specifies the name of the certification field to retrieve. A
client certificate consists of the following fields. 

<table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>Value</b></td><td width="" height="" colspan="1" rowspan="1"><b>Meaning</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">Certificate</td><td width="" height="" colspan="1" rowspan="1">A string containing the binary stream of the entire certificate
content in ASN.1 format. This is useful to discover if special <i>
SubFields</i> are present that are not listed below.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Flags</td><td width="" height="" colspan="1" rowspan="1">A set of flags that provide additional client certificate
information. If Flags is set to 1, a client certificate is present.
If Flags is set to 2, the last certificate in this chain is from an
unknown issuer.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Issuer</td><td width="" height="" colspan="1" rowspan="1">A string that contains a list of subfield values containing
information about the issuer of the certificate. If this value is
specified without a <i>SubField</i>, the <b>ClientCertificate</b>
collection returns a comma-separated list of subfields. For
example, C=US, O=Verisign, and so on.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">SerialNumber</td><td width="" height="" colspan="1" rowspan="1">A string that contains the certification serial number as an
ASCII representation of hexadecimal bytes separated by hyphens (-).
For example, 04-67-F3-02.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Subject</td><td width="" height="" colspan="1" rowspan="1">A string that contains a list of subfield values. The subfield
values contain information about the subject of the certificate. If
this value is specified without a <i>SubField</i>, the <b>
ClientCertificate</b> collection returns a comma-separated list of
subfields. For example, C=US, O=Msft, and so on.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">ValidFrom</td><td width="" height="" colspan="1" rowspan="1">A date specifying when the certificate becomes valid. This date
follows VBScript format and varies with international settings. For
example, in the U.S., 9/26/96 11:59:59 <span>
PM</span>. The year value is displayed as a four-digit number.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">ValidUntil</td><td width="" height="" colspan="1" rowspan="1">A date specifying when the certificate expires. The year value
is displayed as a four-digit number.</td></tr></table><br><br></dd><dt><i>SubField</i></dt><dd>An optional parameter you can use to a retrieve an individual
field in either the Subject or Issuer keys. This parameter is added
to the <i>Key</i> parameter as a suffix. For example, IssuerO or
SubjectCN. The following table lists some common S<i>ubField</i>
values. 

<table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>Value</b></td><td width="" height="" colspan="1" rowspan="1"><b>Meaning</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">C</td><td width="" height="" colspan="1" rowspan="1">Specifies the name of the country/region of origin.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">CN</td><td width="" height="" colspan="1" rowspan="1">Specifies the common name of the user. (This subfield is only
used with the Subject key.)</td></tr><tr><td width="" height="" colspan="1" rowspan="1">GN</td><td width="" height="" colspan="1" rowspan="1">Specifies a given name.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">I</td><td width="" height="" colspan="1" rowspan="1">Specifies a set of initials.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">L</td><td width="" height="" colspan="1" rowspan="1">Specifies a locality.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">O</td><td width="" height="" colspan="1" rowspan="1">Specifies the company or organization name.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">OU</td><td width="" height="" colspan="1" rowspan="1">Specifies the name of the organizational unit.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">S</td><td width="" height="" colspan="1" rowspan="1">Specifies a state or province.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">T</td><td width="" height="" colspan="1" rowspan="1">Specifies the title of the person or organization.</td></tr></table><p><i>SubField</i> values other than those listed in the preceding
table can be identified by their ASN.1 Object Identifier (OID). The
format of the OID is a list of numbers separated by a period (.). A
list of OIDs for your certificate can be obtained from the
authority that issued your certificate.</p></dd></dl><h6>Example</h6><p>You can iterate through the keys of the <b>ClientCertificate</b>
collection. This is demonstrated in the following example.</p><pre><code>&lt;%
  For Each strKey in Request.ClientCertificate
    Response.Write strkey &amp; " = " &amp; Request.ClientCertificate(strkey) &amp; "&lt;BR&gt;"
  Next
%&gt;
</code></pre><p>The following example retrieves the common name of the company
that issued the client certificate.</p><pre><code>&lt;%= Request.ClientCertificate("IssuerCN") %&gt;
</code></pre><p>The following example displays the expiration date of the client
certificate.</p><pre><code>This certification will expire on 
&lt;%= Request.ClientCertificate("ValidUntil") %&gt;
 
The following example uses the Flags key to test whether the issuer of the certificate is known.
&lt;%
  Const ceCertPresent = 1
  Const ceUnrecognizedIssuer = 2
  If Request.ClientCertificate("Flags") = ceUnrecognizedIssuer Then
    Response.Write "Unrecognized issuer"
  End If
%&gt;
</code></pre><p>The following example displays all the fields of a client
certificate.</p><pre><code>Issuer: &lt;%=Request.ClientCertificate("Issuer")%&gt;&lt;br&gt;
Subject: &lt;%=Request.ClientCertificate("Subject")%&gt;&lt;br&gt;

&lt;% cer=Request.ClientCertificate("Certificate") %&gt;
Certificate Raw Data: &lt;%=cer%&gt;&lt;br&gt;
Certificate length: &lt;%=len(cer)%&gt;&lt;br&gt;
Certificate Hex Data:
&lt;% For x=1 To 100 %&gt;
  &lt;%=hex(asc(mid(cer,x,1)))%&gt;&amp;nbsp;
&lt;% Next %&gt;
</code></pre><h6>Applies To</h6><p><a href="ref_vbom_reqo.htm"><b>Request Object</b></a></p><h6>See Also</h6><p><a href="ref_vbom_reqoccookie.htm"><b>Cookies</b></a>, <a href="ref_vbom_reqocf.htm"><b>Form</b></a>, <a href="ref_vbom_reqocqs.htm"><b>QueryString</b></a>, <a href="ref_vbom_reqocsv.htm"><b>ServerVariables</b></a>, <a href="http://www.microsoft.com/isapi/redir.dll?prd=msdn&amp;sbp=workshop&amp;pver=6.0&amp;ar=web&amp;sba=security" target="_New"><b><b>Security and Cryptography</b></b></a></p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
