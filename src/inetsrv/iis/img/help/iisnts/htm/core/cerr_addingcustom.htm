<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Adding_a_Custom_Error_Message">
<meta name="description" content="Procedural information on how to add custom HTTP error messages.">
<title>Adding a Custom Error Message</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Adding a Custom Error Message</h1><p>You can map custom error messages to a file or to a URL by using
the <b>Custom Errors</b> property sheet in the IIS snap-in.</p><h6>To customize an error message by mapping to a file</h6><ol><li>Create a file that contains your custom error message, and
place the file in a directory.</li><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
Web site, virtual directory, directory, or file in which you want
to customize HTTP errors, and click <b>Properties</b>.</li><li>Select the <b>Custom Errors</b> property sheet.</li><li>Select the HTTP error that you want to change.</li><li>Click the <b>Edit Properties</b> button.</li><li>Select <b>File</b> from the <b>Message Type</b> box.</li><li>Type the path and file name that points to your customized
error message, or use the <b>Browse</b> button to locate the file
on your computer's hard disk.</li><li>Click <b>OK</b>.</li></ol><h6>To customize an error message by mapping to a URL</h6><ol><li>Create a file that contains your custom error message, and
place it in a virtual directory.</li><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
Web site, virtual directory, directory, or file in which you want
to customize HTTP errors, and click the <b>Properties</b>
button.</li><li>Select the <b>Custom Errors</b> property sheet.</li><li>Select the HTTP error that you want to change.</li><li>Click the <b>Edit Properties</b> button.</li><li>Select <b>URL</b> from the <b>Message Type</b> box.</li><li>Type the URL which points to your customized error message by
entering the path to the URL beginning with the virtual directory
name.</li><li>Click <b>OK</b>.</li></ol><p> </p><p><b>Notes</b></p><ul><li>If you have an ASP file defined to handle a custom error, the
script is invoked as a URL that passes context. For example, if you
have an .asp file called Handle405.asp that is defined to handle
HTTP 405 errors and a 405 error occurs when a user tries to access
Example.htm, Handle405.asp file is invoked as if the user had typed


<pre><code>http://example.microsoft.com/handle405.asp?405;http://example.microsoft.com/example.htm</code></pre></li><li>If you are using static custom error files (HTML files), you
should always use the File option. If you plan to develop an
application (by using ISAPI or ASP) to handle errors, then use the
URL option. Note that the error status is handed to the application
in the URL parameters and it is the application's responsibility to
set the HTTP header status; otherwise, the HTTP response status
will be "HTTP 1.1 200 OK."</li><li>If you are using Internet Explorer 5.0 with Windows,
Internet Explorer may replace the following custom errors with its
own HTTP error. If the file size of the custom error is smaller
than the size listed, the custom error is not used:<br>
403, 405, 410 - must be greater than 256 bytes<br>
400, 404, 406, 408, 409, 500, 500.12, 500.13, 500.15, 501, 505 -
must be greater than 512 bytes</li></ul><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
