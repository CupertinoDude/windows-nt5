<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Global.asa_Reference">
<meta name="description" content="Internet Information Services reference information">
<title>Global.asa Reference</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Global.asa Reference</h1><p>The Global.asa file is an optional file in which you can specify
event scripts and declare objects that have session or application
scope. It is not a content file displayed to the users; instead it
stores event information and objects used globally by the
application. This file must be named Global.asa and must be stored
in the root directory of the application. An application can only
have one Global.asa file.</p><p>Global.asa files can contain only the following:</p><ul><li><a href="ref_scrpt_glappevnts.htm"><b>Application Events</b></a></li><li><a href="ref_scrpt_glsesevnt.htm"><b>Session Events</b></a></li><li><a href="ref_scrpt_globjdeclarns.htm"><b>OBJECT Declarations</b></a></li><li><a href="ref_scrpt_gltyplibdeclarns.htm"><b>TypeLibrary Declarations</b></a></li></ul><p>If you include script that is not enclosed by &lt;SCRIPT&gt;
tags, or that defines an object that does not have session or
application scope, the server returns an error. The server ignores
both tagged script that the application or session events do not
use, as well as any HTML in the file.</p><p>The scripts contained in the Global.asa file may be written in
any supported scripting language. If multiple event or object
scripts use the same scripting language, they can be combined
inside a single set of &lt;SCRIPT&gt; tags.</p><p>When you save changes to the Global.asa file, the server
finishes processing all of the current application requests before
it recompiles the Global.asa file. During that time, the server
refuses additional requests and returns an error message stating
that the request cannot be processed while the application is being
restarted.</p><p>After all of the current user requests have been processed, the
server deletes all active sessions, calling the <b>
Session_OnEnd</b> event for each session it deletes, closes the
application, and calls the <b>Application_OnEnd</b> event. The
Global.asa file is then recompiled. Subsequent user requests will
start the application and create new sessions, and trigger the <b>
Application_OnStart</b> and <b>Session_OnStart</b> events.</p><p>Procedures declared in the Global.asa file can only be called
from one or more of the scripts associated with the <b>
Application_OnStart</b>, <b>Application_OnEnd</b>, <b>
Session_OnStart</b>, and <b>Session_OnEnd</b> events. They are not
available to the ASP pages in the ASP-based application.</p><p>To share procedures across an application, you can declare the
procedures in a separate file, and then use server-side include
(SSI) statements to include the file in the ASP pages that call the
procedures. You typically give include files an .inc extension.</p><p><img src="note.gif" alt="note"><b>
      Note
      </b>The examples in this document use
Microsoft<sup>®</sup> Visual Basic<sup>®</sup> Scripting
Edition (VBScript) as the primary scripting language. However, ASP
scripts can be written in any supported scripting language, such as
JScript<sup>®</sup>. For more information on how to change the
primary language, see <a href="asp_basp_workingwithscript.htm"><b>Working with Scripting Languages</b></a>.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
