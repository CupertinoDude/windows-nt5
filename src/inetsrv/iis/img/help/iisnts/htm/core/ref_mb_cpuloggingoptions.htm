<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="CPULoggingOptions">
<meta name="description" content="This metabase property contains flags that specify how IIS should log CPU times for services, servers, or applications. You can use this property to configure IIS to sum the CPU times of CGI applications only, of ISAPI extensions and ASP applications only, or of all applications. ">
<title>CPULoggingOptions</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>CPULoggingOptions</h3><div><p>This metabase property contains flags that specify how IIS
should log CPU times for services, servers, or applications. You
can use this property to configure IIS to sum the CPU times of CGI
applications only, of ISAPI extensions and ASP applications only,
or of all applications.</p><p><img src="note.gif" alt="note"><b>
      Note
      </b>Because process accounting in IIS uses
Windows Job Objects to monitor CPU times for an entire process,
process accounting will log and throttle only applications that are
isolated in a separate process from IIS.</p><p>Process throttling and process accounting are independently
controlled by several other metabase properties. In order to enable
process accounting you must set <b>CpuEnableLogging</b> (which is a
member of <a href="ref_mb_CpuLoggingMask.htm"><b>CPULoggingMask</b></a>) to TRUE, and set at least one other <a href="ref_mb_CpuLoggingMask.htm"><b>CPULoggingMask</b></a> property
to TRUE. It is also necessary to set at least one member flag of
the <b>CpuLoggingOptions</b>, set <a href="ref_mb_CpuLoggingInterval.htm"><b>CPULoggingInterval</b></a>
to a nonzero value, and set either <a href="ref_mb_CpuAppEnabled.htm"><b>CPUAppEnabled</b></a> or <a href="ref_mb_CpuCgiEnabled.htm"><b>CPUCGIEnabled</b></a>, as
appropriate, to TRUE.</p><p>To properly activate process throttling, <a href="ref_mb_CpuLimitsEnabled.htm"><b>CPULimitsEnabled</b></a> must
be set to TRUE, and at least one of the following properties should
be set to TRUE: <a href="ref_mb_CpuLimitLogEvent.htm"><b>CPULimitLogEvent</b></a>, <a href="ref_mb_CpuLimitPriority.htm"><b>CPULimitPriority</b></a>, <a href="ref_mb_CpuLimitPriority.htm"><b>CPULimitPriority</b></a>, or <a href="ref_mb_CpuLimitPause.htm"><b>CPULimitPause</b></a>.</p></div><table width="100%" height=""><tr><td width="166" height="" colspan="1" rowspan="1"></td><td width="" height="" colspan="1" rowspan="1"></td></tr><tr><td width="166" height="" colspan="1" rowspan="1"><b>Attribute Name</b></td><td width="" height="" colspan="1" rowspan="1"><b>Attribute Value</b></td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Data Type</td><td width="" height="" colspan="1" rowspan="1">DWORD</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Attributes</td><td width="" height="" colspan="1" rowspan="1">INHERIT</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Default Value</td><td width="" height="" colspan="1" rowspan="1">CPUEnableAllProcLogging</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">MetaFlagsEx</td><td width="" height="" colspan="1" rowspan="1">CACHE_PROPERTY_MODIFIED</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">User Type</td><td width="" height="" colspan="1" rowspan="1">IIS_MD_UT_SERVER</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">StartingNumber</td><td width="" height="" colspan="1" rowspan="1"></td></tr><tr><td width="166" height="" colspan="1" rowspan="1">EndingNumber</td><td width="" height="" colspan="1" rowspan="1">0</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">ID</td><td width="" height="" colspan="1" rowspan="1">2146</td></tr></table><div><h3>Access Locations</h3><p>This property is accessible at the following locations:</p><table width="566" height=""><tr><td width="536" height="" colspan="2" rowspan="1"><div></div></td></tr><tr><td width="220" height="" colspan="1" rowspan="1"><b>Metabase Path</b></td><td width="316" height="" colspan="1" rowspan="1"><b>IIS Admin Object Type</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/2</td><td width="" height="" colspan="1" rowspan="1">IIsWebServer</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/Info/Templates/Public Web Site</td><td width="" height="" colspan="1" rowspan="1">IIsWebServer</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/Info/Templates/Secure Web Site</td><td width="" height="" colspan="1" rowspan="1">IIsWebServer</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC</td><td width="" height="" colspan="1" rowspan="1">IIsWebService</td></tr></table></div><h3>IIS Admin Base Object Information</h3><p>The following table lists additional information required only
for code that uses the IIS Admin Base Object.</p><table width="567" height=""><tr><td width="536" height="" colspan="2" rowspan="1"><div></div></td></tr><tr><td width="221" height="" colspan="1" rowspan="1">Metabase identifier</td><td width="316" height="" colspan="1" rowspan="1"><div>MD_CPU_LOGGING_OPTIONS</div></td></tr><tr><td width="221" height="" colspan="1" rowspan="1">Data type</td><td width="316" height="" colspan="1" rowspan="1">DWORD</td></tr><tr><td width="221" height="" colspan="1" rowspan="1">User type</td><td width="316" height="" colspan="1" rowspan="1">IIS_MD_UT_SERVER</td></tr></table><div><h3>Flags</h3><table width="100%" height=""><tr><td width="" height="" colspan="4" rowspan="1"><div></div></td></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>Name</b></td><td width="" height="" colspan="1" rowspan="1"><b>Value</b></td><td width="25%" height="" colspan="1" rowspan="1"><b>Metabase Bitmask Identifier</b></td><td width="" height="" colspan="1" rowspan="1"><b>Description</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">CPUEnableAllProcLogging</td><td width="" height="" colspan="1" rowspan="1"><div>1 | 0x1</div></td><td width="" height="" colspan="1" rowspan="1"><div>
MD_CPU_ENABLE_ALL_PROC_LOGGING</div></td><td width="" height="" colspan="1" rowspan="1"><div>Log the sum of CPU time
used by applications and CGI. This flag indicates whether IIS
should log total CPU times for all out-of-process ISAPI extensions
and ASP and CGI applications.</div></td></tr><tr><td width="" height="" colspan="1" rowspan="1">CPUEnableCGILogging</td><td width="" height="" colspan="1" rowspan="1"><div>2 | 0x2</div></td><td width="" height="" colspan="1" rowspan="1"><div>
MD_CPU_ENABLE_CGI_LOGGING</div></td><td width="" height="" colspan="1" rowspan="1"><div>Log the CPU time used
by CGI applications. This flag indicates whether IIS should log
total CPU times for CGI applications.</div></td></tr><tr><td width="" height="" colspan="1" rowspan="1">CPUEnableAppLogging</td><td width="" height="" colspan="1" rowspan="1"><div>4 | 0x4</div></td><td width="" height="" colspan="1" rowspan="1"><div>
MD_CPU_ENABLE_APP_LOGGING</div></td><td width="" height="" colspan="1" rowspan="1"><div>Log the CPU time used
by ISAPI and ASP applications. This flag indicates whether the
total number of active processes is recorded when process
accounting is performed.</div></td></tr></table></div><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
