<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="AuthPersistence">
<meta name="description" content="This property contains flags, as listed in the Flags section below, that specify authentication persistence across requests on a connection.">
<title>AuthPersistence</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>AuthPersistence</h3><p>This property contains flags, as listed in the Flags section
below, that specify authentication persistence across requests on a
connection.</p><table width="100%" height=""><tr><td width="166" height="" colspan="1" rowspan="1"></td><td width="" height="" colspan="1" rowspan="1"></td></tr><tr><td width="166" height="" colspan="1" rowspan="1"><b>Attribute Name</b></td><td width="" height="" colspan="1" rowspan="1"><b>Attribute Value</b></td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Data Type</td><td width="" height="" colspan="1" rowspan="1">DWORD</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Attributes</td><td width="" height="" colspan="1" rowspan="1">INHERIT</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Default Value</td><td width="" height="" colspan="1" rowspan="1">AuthPersistSingleRequestIfProxy</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">MetaFlagsEx</td><td width="" height="" colspan="1" rowspan="1">CACHE_PROPERTY_MODIFIED</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">User Type</td><td width="" height="" colspan="1" rowspan="1">IIS_MD_UT_FILE</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">StartingNumber</td><td width="" height="" colspan="1" rowspan="1"></td></tr><tr><td width="166" height="" colspan="1" rowspan="1">EndingNumber</td><td width="" height="" colspan="1" rowspan="1">0</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">ID</td><td width="" height="" colspan="1" rowspan="1">6031</td></tr></table><div><h3>Access Locations</h3><p>This property is accessible at the following locations:</p><table width="566" height=""><tr><td width="536" height="" colspan="2" rowspan="1"><div></div></td></tr><tr><td width="220" height="" colspan="1" rowspan="1"><b>Metabase Path</b></td><td width="316" height="" colspan="1" rowspan="1"><b>IIS Admin Object Type</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/2</td><td width="" height="" colspan="1" rowspan="1">IIsWebServer</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/Info/Templates/Public Web Site</td><td width="" height="" colspan="1" rowspan="1">IIsWebServer</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/Info/Templates/Secure Web Site</td><td width="" height="" colspan="1" rowspan="1">IIsWebServer</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC</td><td width="" height="" colspan="1" rowspan="1">IIsWebService</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/1/ROOT</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/1/ROOT/_vti_bin</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/1/ROOT/IISAdmin</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/1/ROOT/IISHelp</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/1/ROOT/MSADC</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/1/ROOT/Scripts</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/2/ROOT</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/2/ROOT/IISAdmin</td><td width="" height="" colspan="1" rowspan="1">IIsWebVirtualDir</td></tr></table></div><h3>IIS Admin Base Object Information</h3><p>The following table lists additional information required only
for code that uses the IIS Admin Base Object.</p><table width="567" height=""><tr><td width="536" height="" colspan="2" rowspan="1"><div></div></td></tr><tr><td width="221" height="" colspan="1" rowspan="1">Metabase identifier</td><td width="316" height="" colspan="1" rowspan="1"><div>MD_AUTHORIZATION_PERSISTENCE</div></td></tr><tr><td width="221" height="" colspan="1" rowspan="1">Data type</td><td width="316" height="" colspan="1" rowspan="1">DWORD</td></tr><tr><td width="221" height="" colspan="1" rowspan="1">User type</td><td width="316" height="" colspan="1" rowspan="1">IIS_MD_UT_FILE</td></tr></table><div><h3>Flags</h3><p>If the <b>AuthPersistSingleRequest</b> is set to TRUE, then
authentication persists only for a single request. If <b>
AuthPersistSingleRequestIfProxy</b> is set to TRUE, then
authentication persists only for a single request if it is a proxy
request and the request is not handled by Microsoft Proxy Server.
(That is, if Proxy Server and IIS are running on the local
computer, and the request is targeted to a remote server.) If <b>
AuthPersistSingleRequestAlwaysIfProxy</b> is set to TRUE, then
authentication is valid for a single request if the request is by
proxy.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>Only one flag of can be TRUE at one
time. When one of these flags is set to TRUE using programmatic
methods or the UI, the other two flags are automatically set to
FALSE. The value of <b>AuthPersistence</b> always equals the value
of the flag that is set to TRUE. When configuring this property by
directly editing MetaBase.XML, you must ensure that only one flag
is set to true at a time.</p><table width="100%" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>Name</b></td><td width="" height="" colspan="1" rowspan="1"><b>Value</b></td><td width="" height="" colspan="1" rowspan="1"><b>Metabase Bitmask Identifier</b></td><td width="" height="" colspan="1" rowspan="1"><b>Description</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">AuthPersistSingleRequest</td><td width="" height="" colspan="1" rowspan="1"><div>64 | 0x00000040</div></td><td width="" height="" colspan="1" rowspan="1"><div>
MD_AUTH_SINGLEREQUEST</div></td><td width="" height="" colspan="1" rowspan="1"><div>Setting this flag to
TRUE specifies that authentication will persist only across single
requests on a connection. IIS will reset the authentication at the
end of each request, and force re-authentication on the next
request of the session.</div></td></tr><tr><td width="" height="" colspan="1" rowspan="1">AuthPersistSingleRequest<br>
IfProxy</td><td width="" height="" colspan="1" rowspan="1"><div><p>128 | 0x00000080</p><p> </p></div></td><td width="" height="" colspan="1" rowspan="1"><div>
MD_AUTH_SINGLEREQUEST<br>
IFPROXY</div></td><td width="" height="" colspan="1" rowspan="1"><div>Setting this flag to
TRUE specifies that authentication will persist only across single
requests on a connection if the connection is by proxy. IIS will
reset the authentication at the end of the request if the current
authenticated request is by proxy and it is not the special case
where IIS is running MSPROXY.</div></td></tr><tr><td width="" height="" colspan="1" rowspan="1">AuthPersistSingleRequest<br>
AlwaysIfProxy</td><td width="" height="" colspan="1" rowspan="1"><div>256 | 0x00000100</div></td><td width="" height="" colspan="1" rowspan="1"><div>
MD_AUTH_SINGLEREQUEST<br>
ALWAYSIFPROXY</div></td><td width="" height="" colspan="1" rowspan="1"><div>Setting this flag to
TRUE specifies that authentication is valid for a single request if
by proxy. IIS will reset the authentication at the end of the
request and force re-authentication on the next request if the
current authenticated request is by proxy of any type.</div></td></tr></table></div><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
