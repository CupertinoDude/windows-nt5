<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="GetLastError">
<meta name="description" content="Internet Information Services reference information">
<title>GetLastError</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>GetLastError</h3><p>The <b>GetLastError</b> method returns an <a href="ref_vbom_aseo.htm"><b>ASPError Object</b></a> describing the
error condition that occurred. This method is available only before
the .asp file has sent any content to the client.</p><h6>Syntax</h6><p><b>Server.GetLastError</b><b>()</b></p><p><b> </b></p><h6>Remarks</h6><p>If a 500;100 custom error has been defined for an ASP
application, it may refer to an .asp file. In this case, when an
error occurs during the running of an .asp file within the
application, the server will automatically transfer to this ASP
page via the <a href="ref_vbom_seromtr.htm"><b>Transfer</b></a> method. All of the state information from
the executing ASP application will be available to the .asp file
that is handling the error. In addition, the <a href="ref_vbom_aseo.htm"><b>ASPError Object</b></a> will be
available, so you can expose the properties of the error through
the .asp file that you set up to handle the error.</p><p>The default Web site is configured to use the file
\iishelp\common\500-100.asp. You can either use this file for
processing ASP errors, or create your own. If you want to change
the .asp file for processing the 500;100 custom errors you can use
the Internet Information Services snap-in.</p>For more information see <a href="cerr_enablingasp.htm"><b>Enabling ASP Error Processing</b></a>.<p><img src="note.gif" alt="note"><b>
      Note
      </b>A 500;100 custom error will be generated if IIS
encounters an error while processing either an .asp file or the
application's Global.asa file.</p>
<h6>Example</h6><p>The following three examples demonstrate different sorts of
errors that will generate a 500;100 custom error. The three types
of errors are:</p><ul><li>Pre-processing errors</li><li>Script compiling errors</li><li>Run-time errors</li></ul><p>The first example demonstrates a pre-processing error, which IIS
will generate when it tries to include the file. This error will be
generated because the include statement is missing the file
parameter for the include statement. The second example
demonstrates a script compiling error. The scripting engine will
not compile this script because it is missing the keyword "next" in
a <b>For...Next</b> loop. The third example demonstrates a run-time
error that will be caught because the script attempts to divide by
0.</p><p>Example 1</p><pre><code>&lt;!--#include fil=inc.h  --&gt;
&lt;%
  response.write "hello"
%&gt;
</code></pre><p>Example 2</p><pre><code>&lt;%
  dim I
  for i=1 to 1
  nxt
%&gt;
</code></pre><p>Example 3</p><pre><code>&lt;%
  dim i,j
  dim sum
  sum=0
  j=0

  for i=1 to 10
    sum=sum+1
  next

  sum=sum/j
%&gt;
</code></pre><h6>Applies To</h6><p><a href="ref_vbom_sero.htm"><b>Server Object</b></a></p><h6>See Also</h6><p><a href="ref_vbom_aseo.htm"><b>ASPError Object</b></a></p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
