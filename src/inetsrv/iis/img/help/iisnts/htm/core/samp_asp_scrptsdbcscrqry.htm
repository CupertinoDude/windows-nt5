<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Scrollable_Query">
<meta name="description" content="Internet Information Services reference information">
<title>Scrollable Query</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h2>Scrollable Query</h2><h6>Overview</h6><p>When you design application for an Internet environment, you
will often want to limit the amount of information that a database
query returns to a client browser. This example demonstrates how a
script, using ASP and ADO, can limit the number of rows passed to
the client browser in any one chunk, but still allow the user to
browse through all the results of the query.</p><h6>Code Tour</h6><p>The script consists of several code sections that all work
together to accomplish this task. First, the database is accessed
as usual, creating a <b>Connection</b> object and <b>Recordset</b>
object. The <b>Recordset</b> object's <b>PageSize</b> property is
set to 4, and the recordset is opened and populated with the query
results from the database table Authors. The first logical page of
four result records are displayed in a table. Two buttons, PgUp and
PgDn, are provided so that the user can view other pages of the
recordset.</p><p>If a user clicks on a button, the page is accessed again, this
time using the <b>POST</b> method to pass some variables to the
next copy of itself. The variable <i>PageNo</i> is used to store
what page the user is currently viewing, while the <i>Mv</i>
variable is used to pass the scrolling direction to the next form.
If a user clicks on PgDn, for instance, the page is accessed again,
with <i>Mv</i> set to PgDn and <i>PageNo</i> set to 1. The script
would use that information to add 1 to the current page number, and
<b>AbsolutePage</b> could then be used to display the next page of
results.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>OLE DB must be properly configured on the
server for this sample to run properly.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
