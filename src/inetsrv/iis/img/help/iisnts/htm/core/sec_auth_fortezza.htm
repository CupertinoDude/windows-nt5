<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Using_Fortezza_Security_in_IIS">
<meta name="description" content="Includes conceptual and procedural information on Fortezza security features, such as smart cards.">
<title>Using Fortezza Security in IIS</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Using Fortezza Security in IIS</h1><h2>Fortezza Background</h2><p>The U.S. government security standard, commonly called Fortezza,
is supported in IIS. This standard satisfies the Defense Message
System security architecture with a cryptographic mechanism that
provides message confidentiality, integrity, authentication, and
access control to messages, components, and systems. These features
can be implemented both with server and browser software and with
PCMCIA card hardware. Fortezza is a widely used mechanism within
the U.S. government. For more information see the Fortezza
Developer's Guide (run by the National Security Agency and the U.S.
Department of Defense) at <a href="http://www.microsoft.com/isapi/redir.dll?prd=external&amp;sbp=Fortezza&amp;pver=1.0" target="_New"><b><b>Fortezza</b></b></a>.</p><h2><a name="H2_448400416"></a>Using
Fortezza</h2><p>To implement Fortezza security in IIS, perform the following
procedures. These steps will fully integrate your Fortezza schema
into IIS, so that you can operate in accordance with the standards
outlining Fortezza security.</p><h3>To Use Fortezza Certificates</h3><p>A Fortezza card (a type of PCMCIA card, similar to those used in
notebook computers and other small devices) contains a user
certificate to authenticate the user of the card; this certificate
works in much the same way that server and client certificates work
in IIS. To make these Fortezza certificates available to IIS, you
must copy them to a secure store on the computer:</p><ol><li>Obtain a non-export copy of Schannel.dll from the <a href="http://www.microsoft.com/isapi/redir.dll?prd=ie&amp;ar=security" target="_New"><b>Microsoft Web site</b></a> at
http://www.microsoft.com/security/.</li><li>Install the card reading equipment and its drivers. For
information, see the card reader documentation.</li><li>Install the Cryptographic Service Provider (CSP) provided by
the equipment supplier. For information, see the card reader
documentation.</li><li>Run the command line utility <b>Fortutil.exe</b>.</li></ol><p>The utility provides functions that can install, confirm, and
delete that the card certificate and other associated information.
To enable this feature, type the appropriate commands at the
command line:</p><table width="" height=""><tr><th width="" height="" colspan="1" rowspan="1">Action</th><th width="" height="" colspan="1" rowspan="1">Command</th><th width="" height="" colspan="1" rowspan="1">Parameters</th></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>Add certificate</b></td><td width="" height="" colspan="1" rowspan="1"><code>fortutil.exe /a</code></td><td width="" height="" colspan="1" rowspan="1">Web site name; Card serial number; PIN; card personality</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>Confirm certificate</b></td><td width="" height="" colspan="1" rowspan="1"><code>fortutil.exe /q</code></td><td width="" height="" colspan="1" rowspan="1">Web server name</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>Delete certificate</b></td><td width="" height="" colspan="1" rowspan="1"><code>fortutil.exe /r</code></td><td width="" height="" colspan="1" rowspan="1">Web site name</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>Help</b></td><td width="" height="" colspan="1" rowspan="1"><code>fortutil.exe /?</code></td><td width="" height="" colspan="1" rowspan="1">None</td></tr></table><p><img src="note.gif" alt="note"><b>
      Note
      </b>Any Fortezza certificates copied to the
server can be used as certificate in the Web Server Certificate
Wizard, CTL Wizard, or the Windows certificate features.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>If the card is removed from the reader
while the Web service is running and then re-inserted, it might
cause SSL connection errors. If these errors occur, the Web service
needs to be restarted with the card in the reader.</p><div class="search-terms">phrase 1, phrase 2, phrase 3</div>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
