<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Limit_Query_Results">
<meta name="description" content="Internet Information Services reference information">
<title>Limit Query Results</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h2>Limit Query Results</h2><h6>Overview</h6><p>In an Internet environment, it is often desirable to limit the
amount of information that a database query returns to a client
browser. This example demonstrates how a script, using ASP and ADO,
can limit the number of rows returned.</p><h6>Code Tour</h6><p>The sample first creates an instance of the <b>Connection</b>
object, and opens the OLE DB connection with this object's <b>
Open</b> method. <b>CreateObject</b> is used again to instantiate
an empty <b>Recordset</b> object. The <b>ActiveConnection</b>
property of the new <b>Recordset</b> object is set to point at the
open OLE DB connection, an SQL source string is assigned, and
cursor type specified. The key to limiting the results lies with
the <b>Recordset</b> object's <b>PageSize</b> property. For this
example, the value is set to 10, which indicates that ADO is to
return at most 10 records. Finally, the <b>Open</b> method is
called, and ADO searches for the first 10 records that fulfill the
SQL search string.</p><p>When ADO has returned and placed the results of the search into
the <b>Recordset</b> object, the script loops through the page,
displaying all fields of each record in a table. The script then
performs the typical housecleaning operations, closing both the
recordset and the connection.</p><p>It is important to realize that if the SQL query had returned
more than 10 records, this script would not display them. Instead,
the extra records would be deposited on one or more additional,
logical pages. The property <b>PageCount</b> indicates how many
logical pages of data were returned.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>OLE DB must be properly configured on the
server for this sample to run properly.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
