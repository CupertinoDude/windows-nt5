<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Caching_Applications">
<meta name="description" content="Procedural topic explaining how to set CGI script timeouts, cache ISAPI DLLs, and change the cache size for ASP pages.">
<title>Caching Applications</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Caching Applications</h1><p>By adjusting several settings associated with Web applications
that run on your server, you can fine-tune server performance.
Logging usage data, such as number of requests and the time they
were made, can help you determine how to make the adjustments. For
more information on logging server activity, see <a href="log_logging.htm"><b>Logging Site Activity</b></a>. For
additional information on performance issues, see <a href="perf_tune_about.htm"><b>About Performance Tuning</b></a>.</p><p>The following settings are covered:</p><ul><li>Setting the CGI Script Timeout</li><li>Caching ISAPI extensions</li><li>Caching ASP Script Files</li></ul><h2><a name="H2_37720440">Setting the CGI Script
Timeout</a></h2><p>In addition to the timeout associated with the connection, you
can set a timeout value for CGI scripts. The timeout value is the
amount of time a CGI script is given to execute. CGI applications
inherit the timeout setting for the entire Web site. You can change
the setting for the entire Web site or for an isolated
application.</p><p><b>To set the timeout value:</b></p><br><ol><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
<b>Computer</b> icon, and open its property sheets.</li><li>Under <b>Master Properties</b>, select <b>WWW Service</b>, and
click the <b>Edit</b> button.</li><li>Click the <b>Home Directory</b> tab.</li><li>Click the <b>Configuration</b> button.</li><li>Click the <a href="sa_ui_processoptionsps.htm"><b>Process Options Property Sheet</b></a> tab, and type the timeout period in the <b>CGI Script
Timeout</b> text box.</li></ol><h2><a name="H2_37722380">Caching ISAPI
extensions</a></h2><p>ISAPI DLLs can be loaded and cached so that further requests can
be processed without calling them again. Otherwise, the DLLs are
unloaded after they are run. Caching reduces the time a user waits
for a DLL to load and most ISAPI extensions (including Active
Server Pages) benefit from caching. You should clear this option
only for special circumstances, such as debugging ISAPI
extensions.</p><h6>To enable caching:</h6><br><ol><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
Web site or the starting point directory of an application.</li><li>Open the directory's property sheets, and click the <b>Home
Directory</b>, <b>Virtual Directory</b>, or <b>Directory</b>
tab.</li><li>Click the <b>Configuration</b> button.</li><li>On the <b>Mappings</b> tab, select the <b>Cache ISAPI
extensions</b> check box.</li></ol><h2><a name="cachingaspscriptfiles">
Caching ASP Script Files</a></h2><p>ASP processes the files containing ASP scripts, stores these
processed files in a cache, and serves the cached files to clients.
Caching ASP files enhances performance because cached ASP scripts
are not processed each time they are called. You can further
improve performance by changing the number of cached files for all
applications with low (in process) or medium (pooled) protection,
or individually for applications with high (isolated) application
protection.</p><p><b>To change the settings for caching ASP files:</b></p><ol><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
desired Web site, virtual directory, or directory, and select its
property pages.</li><li>Click the <b>Home Directory</b> tab for a Web site, the <b>
Virtual Directory</b>tab a virtual directory, or the <b>
Directory</b> tab for a directory.</li><li>In the Application Settings section, set <b>Application
Protection</b> to <b>High (Isolated)</b>, and click <b>
Apply</b>.</li><li>Click the <b>Configuration</b> button. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>If the <b>Configuration</b> button is not active,
the directory or starting point does not contain an isolated
application. You can create a new application by clicking the <b>
Create</b> button.</p>
</li><li>Click the <b>Cache Options</b> tab.</li><li>To cache all requested .asp files, select <b>Cache all
requested ASP files</b>. To set the maximum number of files cached
in memory, type a value in the text box (files in excess of this
number are persisted to the disk cache).</li><li>To limit the total number of ASP files cached, select <b>Limit
ASP files cached to:</b>, and enter a value in the text box.</li><li>To turn off the cache, select <b>Do not cache ASP
files</b>.</li></ol><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
