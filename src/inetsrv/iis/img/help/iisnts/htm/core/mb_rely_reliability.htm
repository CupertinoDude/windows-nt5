<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Metabase_Reliability">
<meta name="description" content="This section is about backing up and restoring the metabase.">
<title>Metabase Reliability</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Metabase Reliability</h1><div><p>This section contains the following topics:</p><ul><li><a href="mb_rely_backup.htm"><b>Backing Up the Metabase</b></a></li><li><a href="mb_rely_restore.htm"><b>Restoring the Metabase</b></a></li><li><a href="mb_rely_snapshot.htm"><b>Metabase Snapshot Writer</b></a></li><li><a href="mb_rely_rollback.htm"><b>Restoring the Metabase Using History Files</b></a></li></ul></div><p>Restoring the metabase configuration and metabase schema using
history files is hereafter referred to as metabase rollback.
Metabase rollback differs from metabase restore because metabase
rollback restores the MetaBase.xml and MBSchema.xml files from
history files, whereas metabase backup restores the MetaBase.xml
and MBSchema.xml files from backup files. This distinction is
subtle, but  important to understand.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>Restoring a backup from an earlier version of
IIS is not supported. After installing or upgrading to IIS 6.0, you
should perform a metabase backup to preserve your configuration
data.</p>
<table width="100%" height=""><tr><th width="33%" height="" colspan="1" rowspan="1">Metabase Rollback</th><th width="33%" height="" colspan="1" rowspan="1">Metabase Restore</th></tr><tr><td width="33%" height="" colspan="1" rowspan="1">Metabase and schema are restored from history
files.</td><td width="33%" height="" colspan="1" rowspan="1">Metabase and schema are restored from backup
files.</td></tr><tr><td width="33%" height="" colspan="1" rowspan="1">History files can only be restored on the same
installation of Windows that they were created from because they
are encrypted with the machine key.</td><td width="33%" height="" colspan="1" rowspan="1">Backup files can be restored to a different
installation of Windows, even on a different computer if they were
created using an administrator password.</td></tr><tr><td width="33%" height="" colspan="1" rowspan="1">History files are generated automatically,
programmatically, or on demand.</td><td width="33%" height="" colspan="1" rowspan="1">Backup files are generated on demand or scheduled
through the IIS snap-in, or via script.</td></tr><tr><td width="33%" height="" colspan="1" rowspan="1">Can be restored manually or using the IIS
snap-in.</td><td width="33%" height="" colspan="1" rowspan="1">Backup files can be restored from the IIS snap-in,
using APIs, or command line scripts.</td></tr></table><div><p><b>Related Topics</b></p><ul><li>For more information about metabase history, see <a href="mb_history_history.htm"><b>The Metabase History Feature</b></a>.</li></ul></div><div class="search-terms">phrase 1, phrase 2, phrase 3</div>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
