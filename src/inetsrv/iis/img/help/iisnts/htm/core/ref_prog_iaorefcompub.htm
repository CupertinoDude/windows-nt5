<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Backup">
<meta name="description" content="Internet Information Services reference information">
<title>Backup</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>Backup</h3><p>You can use the <b>Backup</b> method of the <a href="ref_prog_iaorefcompu.htm"><b>IIsComputer</b></a> object to
back up the metabase to a location you specify by providing a
backup location name of up to 100 characters in length. Multiple
metabase backups can be stored in a backup location.</p><h6>Syntax</h6><p><b>IIsComputer</b>.<b>Backup</b><i>BackupLocation</i>, <i>
BackupVersion</i>, <i>BackupFlags</i></p><p> </p><h6>Parameters</h6><dl><dt><i>BackupLocation</i></dt><dd>A string of up to 100 characters that specifies the backup
location. The storage mechanism will be determined by IIS. If an
empty string is specified, the backup will be stored in the default
location.<br></dd><dt><i>BackupVersion</i></dt><dd>Specifies the version number to be assigned to the backup. Must
be less than or equal to <b>MD_BACKUP_MAX_VERSION</b>. Can be set
to one of the following values. 

<table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>MD_BACKUP_HIGHEST_VERSION</b></td><td width="" height="" colspan="1" rowspan="1">Overwrite the highest existing backup version in the specified
backup location.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>MD_BACKUP_NEXT_VERSION</b></td><td width="" height="" colspan="1" rowspan="1">Use the next backup version number available in the specified
backup location.</td></tr></table></dd><dt><i>BackupFlags</i></dt><dd>One or more of the following flags. 

<table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>MD_BACKUP_FORCE_BACKUP</b></td><td width="" height="" colspan="1" rowspan="1">Force the backup even if the <b>SaveData</b> operation
specified by <b>MD_BACKUP_SAVE_FIRST</b> fails.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>MD_BACKUP_OVERWRITE</b></td><td width="" height="" colspan="1" rowspan="1">Back up even if a backup of the same name and version exists in
the specified backup location, overwriting if necessary.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><b>MD_BACKUP_SAVE_FIRST</b></td><td width="" height="" colspan="1" rowspan="1">Perform a <b>SaveData</b> operation before the backup. Default
if no flags are specified.</td></tr></table><br></dd></dl><h6>Remarks</h6><p>IIS determines the backup storage mechanism, so the backup
location name you provide does not necessarily translate to a
particular directory, file, or database storage mechanism. As
implemented in this release, metabase backups are stored as files
in the system32\inetsrv\MetaBack directory.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>The metabase backup and restore functionality
exists for versioning purposes, not for cross-machine replication.
However, you are not necessarily restricted to backing up and
restoring the computer from which you initiate the process. For
more information about backing up the metabase, see "Backing up the
Metabase" in the IIS product documentation.</p>
<h6>Code Example</h6><pre><code>&lt;% 
  Dim ComputerObj, iFlags 
  Set ComputerObj = GetObject("IIS://LocalHost") 
  'Backup to next available version number. 
  'Set flags to save the metabase first and 
  'force the backup even if save fails. 
  iFlags = (MD_BACKUP_SAVE_FIRST or MD_BACKUP_FORCE_BACKUP) 
  ComputerObj.Backup "MyBackups", MD_BACKUP_NEXT_VERSION, iFlags 
%&gt; 
</code></pre><h6>See Also</h6><p><a href="ref_prog_iaorefcompud.htm"><b>DeleteBackup</b></a>, <a href="ref_prog_iaorefcompue.htm"><b>EnumBackups</b></a>, <a href="ref_prog_iaorefcompur.htm"><b>Restore</b></a></p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
