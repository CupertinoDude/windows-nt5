<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Page_Counter_Component">
<meta name="description" content="Internet Information Services reference information">
<title>Page Counter Component</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Page Counter Component</h1><p>The Page Counter component creates a <b>PageCounter</b> object
that counts and displays the number of times a Web page has been
opened. At regular intervals the object writes the number of hits
to a text file so that in the event of a server shutdown, the data
is not lost. The Page Counter component uses an internal <b>Central
Management</b> object to record how many times each page in the
application has been opened.</p><p>When an instance of the <b>PageCounter</b> object is created on
a page by using the <b>Server.CreateObject</b> method, the object
retrieves the current hit count for the specified Web page from the
<b>Central Management</b> object. The object can then be
manipulated with the methods it exposes.</p><p>The Page Counter component uses the following files:</p><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>File Names</b></td><td width="" height="" colspan="1" rowspan="1"><b>Description</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">Pagecnt.dll</td><td width="" height="" colspan="1" rowspan="1">The Page Counter component.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_pgc.htm"><b>Hit Count Data file</b></a></td><td width="" height="" colspan="1" rowspan="1">The text file to which the Page Counter component saves the
current hit count.</td></tr></table><br><h6>Syntax</h6><p><b>Set</b><i>oVar</i><b>= Server.CreateObject(
"MSWC.PageCounter" )</b></p><p> </p><h6>Parameters</h6><dl><dt><i>oVar</i></dt><dd>Specifies the name of the <b>PageCounter</b> object created by
the call to <b>Server.CreateObject</b>.</dd></dl><h6>Registry Entries</h6><p>The Page Counter adds the key MSWC.PageCounter to the registry
when the object is compiled or registered. The key is added under
HKEY_CLASSES_ROOT and contains the following named values.</p><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>Named Value</b></td><td width="" height="" colspan="1" rowspan="1"><b>Description</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">File_Location</td><td width="" height="" colspan="1" rowspan="1">A string that specifies the path and filename of the Hit Count
Data file. The default filename is Hitcnt.cnt. This file is located
in your Windows directory.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Save_Count</td><td width="" height="" colspan="1" rowspan="1">A DWORD that specifies the number of hits before the hit count
is saved to the Hit Count Data file. Note that this is the total
number of hits, not the number of hits per page. The default value
is 25.</td></tr></table><br><h6>Methods</h6><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_pgc_hits.htm"><b>Hits</b></a></td><td width="" height="" colspan="1" rowspan="1">Displays the number of times that a specified URL has been
opened.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_pgc_phit.htm"><b>PageHit</b></a></td><td width="" height="" colspan="1" rowspan="1">Increments the Hit Count.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_pgc_reset.htm"><b>Reset</b></a></td><td width="" height="" colspan="1" rowspan="1">Sets the hit count for a specified page to 0.</td></tr></table><br><h6>Example</h6><p>The following example uses the <b>PageCounter</b> object to
track the number of visitors to the page and sends a special
message to the tenth visitor.</p><p>--- PageCount.asp ---</p><pre><code>&lt;% 
  Set MyPageCounter = Server.CreateObject("MSWC.PageCounter")
  HitMe = MyPageCounter.Hits
  If HitMe = 10 Then 
%&gt;
  You are the lucky 10th Customer!!! &lt;BR&gt;
&lt;% Else %&gt;
  Sorry, you are customer #&lt;%= HitMe %&gt; &lt;BR&gt;
&lt;% End If %&gt;
</code></pre><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
