<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Obtaining_a_Server_Certificate">
<meta name="description" content="Procedural information on how to obtain a server certificate for activating your Web server's SSL features. A server certificate enables users to authenticate your server, check the validity of Web content, and establish a secure connection.">
<title>Obtaining a Server Certificate</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Obtaining a Server Certificate</h1><a name="H1_37718888"></a><p>There are two ways to obtain a server certificate. You can <a href="#certserver"><b>issue your own certificate</b></a>, or you can
obtain a certificate from a <a href="#CAcerts"><b>certification
authority</b></a>. The following procedures explain how you can
implement certificates on your server. To learn more about
certificates, see <a href="sec_auth_certabout.htm"><b>About Certificates</b></a>.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>It is important to safeguard the certificate
and key pair; <i>always</i> back them up onto a disk and keep the
disk in a secure place.</p>
<ul><li><a href="#certserver"><b>To issue your own server
certificate</b></a></li><li><a href="#CAcerts"><b>To obtain a server certificate from a
certification authority</b></a></li><li><a href="#savekeys"><b>To create a backup copy of your server
certificate and private key</b></a></li></ul><a name="certserver"></a><h6>To issue your own server certificate</h6><br><p>Consider the following issues when deciding whether to issue
your own server certificates:</p><ul><li>Consider the features offered by the certificate service;
Microsoft Certificate Services 2.0 accommodates different
certificate formats and provides for auditing or logging of
certificate-related activity.</li><li>Compare the cost of issuing your own certificates against the
cost of buying a certificate from a certification authority.</li><li>Your organization may require an initial adjustment period to
to learn, implement, and integrate Certificate Services with
existing security systems and policies.</li></ul><ol><li>Use Certificate Services to create a customizable service for
issuing and managing certificates. You can create server
certificates for 

the Internet or for
corporate intranets, giving your organization
complete control over certificate management policies. For more
information, see the Microsoft Certificate Services
documentation.</li><li>Use the <a href="sec_auth_certtaskwiz.htm#TheWebServerCertificateWizard"><b>Web
Server Certificate Wizard</b></a> to request and install your server
certificate.</li></ol><p><b>Notes</b></p><ul><li>Online requests for server certificates can only be made to
local and remote Enterprise Certificate Services and remote
Stand-alone Certificate Services. The IIS Web Server Certificate
Wizard does not recognize a stand-alone installation of Certificate
Services on the same computer when requesting a certificate. To get
around this, use the offline certificate request to save the
request to a file and then process as an offline request (see the
Certificate Services documentation).</li><li>If you open your SGC certificate, you might receive a notice on
the <b>General</b> tab saying, "The certificate has failed to
verify for all of its intended purposes." This notice is issued
because of the way SGC certificates interact with Windows 2000
and does not necessarily indicate that the certificate does not
work properly.</li></ul><p> </p><a name="CAcerts"></a><h6>To obtain a server certificate from a certification
authority</h6><br><p>If you are replacing your current server certificate, IIS will
continue to use the old certificate until the new request has been
completed.</p><ol><li>Find a certification authority that provides services that meet
your business needs and then request a server certificate. 

<p>Consider the following issues when choosing a certification
authority:</p><ul><li>Will the certification authority be able to issue you a
certificate that is compatible with all browsers used to access
your server?</li><li>Is the certification authority a recognized and trusted
entity?</li><li>How will the certification authority provide verification of
your identity?</li><li>Does the authority have a system for receiving online
certificate requests, such as requests generated by the Web Server
Certificate Wizard?</li><li>How much will the certificate cost initially and for renewal or
other services?</li><li>Is the certification authority familiar with your organization
or company's business interests?</li></ul><p>For the latest list of certification authorities supporting
Internet Information Services, visit the <a href="http://microsoft.com/technet/security/partners/default.asp" target="_New"><b>Microsoft Security Services Partner Program</b></a> Web
site. In the <b>Search by Product &amp; Technology</b> list, select
<b>IIS</b> or <b>PKI and Certificates</b>.</p></li><li>Use the <a href="sec_auth_certtaskwiz.htm"><b>Using the New Security Task Wizards</b></a> to create a certificate request, which you
can send to the certification authority.</li><li>Send the request to the certification authority. They will
process the request and send you the certificate. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>Some certification authorities require you to prove
your identify before processing your request or issuing you your
certificate.</p>
</li><li>Use the <a href="sec_auth_certtaskwiz.htm"><b>Using the New Security Task Wizards</b></a> to install your certificate. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>When you send an online request for a server
certificate assigned to your server using the Certificate Wizard in
the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, a certificate
assigned to the certificate authority (CA) may be installed on your
server. The folder "Issued Certificates" shows a certificate issued
to your server, but the certificate is actually issued to the
CA.</p>
<p>To work around this problem, go off line while creating your
certificate request. In the Certificate Wizard, select "Prepare the
request now, but send it later." Do not select "Send the request
immediately to an online certification authority."</p></li></ol><h3><a name="savekeys">Creating a backup copy of your
server certificate and private key</a></h3><p>In the previous release of IIS, Key Manager was used to back up
server certificates. In this release of IIS, the Web Server
Certificate Wizard replaces Key Manager. Because IIS works closely
with Windows, you can use the Certificate Manager tool to export
and back up your server certificates.</p><h6>To back up your server certificate</h6><br><ol><li>Locate the correct certificate store. This is typically the
Local Computer store in Certificate Manager. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>If you do not have Certificate Manager installed in
the MMC, you will need to <a href="#installCertManager"><b>install
it</b></a>.</p>
</li><li>Select the certificate in the Personal store.</li><li>Open the <b>Action</b> menu, point to <b>All tasks</b>, and
click <b>Export</b>.</li><li>In the Certificate Manager Export Wizard, select <b>Yes, export
the private key</b>.</li><li>Follow the wizard default settings, and enter a password for
the certificate backup file when prompted. 

<p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>Do <i>not</i> select <b>Delete the private key
if export is successful</b>, because this will disable your current
server certificate.</p>
</li><li>Complete the wizard to export a backup copy of your server
certificate.</li></ol><h6><a name="installCertManager">To add
Certificate Manager to the MMC</a></h6><br><p>If you already have Certificate Manager installed in the MMC, it
will point to the correct Local Computer certificate store.</p><ol><li>Open an MMC console and select <b>Add/Remove Snap-in</b> from
the File menu.</li><li>Click <b>Add</b>.</li><li>Select <b>Certificates</b>.</li><li>Click <b>Add</b>.</li><li>Select the <b>Computer Account</b> option.</li><li>Select the <b>Local Computer</b> option.</li><li>Click <b>Finish</b>.</li></ol><h3>Server Certificates and Upgrades</h3><p>Due to changes in the way that IIS uses server certificates, you
may experience difficulty removing and reassigning your server
certificate after an upgrade to Microsoft Windows. To fix this
problem, use the Visual Basic script below to change metabase
settings and to remove the certificate. You can then use the Web
Site Certificate Wizard in IIS to reassign the certificate.</p><code>Set Machinename to the name of the machine or localhost<br>
Set PathObj = GetObject("IIS://" &amp; MachineName &amp;
"/w3svc")<br>
PathObj.PutEx 1, "SSLCertHash", ""<br>
PathObj.PutEx 1, "SSLStoreName", ""<br>
PathObj.Setinfo</code><br><br><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
