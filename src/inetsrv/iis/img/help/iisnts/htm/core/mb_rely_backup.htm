<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Backing_Up_the_Metabase">
<meta name="description" content="Proceedure for backing up the metabase.">
<title>Backing Up the Metabase</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Backing Up the Metabase</h1><p>IIS provides three methods to back up the metabase. Using
Configuration Backup/Restore, you can create a secure backup or
insecure backup of your metabase. With the new functionality to
Configuration Backup/Restore in the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, Web site administrators can also restore copies of the
metabase to other computers. These back up methods provide a way to
restore only your metabase settings, not your content files. As
with previous versions of IIS, you can programmatically create a
legacy backup of the metabase; however, you can not restore legacy
backups of the metabase to other computers.</p><p><b>Secure Backup</b><br>
Using this method, the Web site administrator provides a password
that is then used to encrypt the metabase backup. Password
information is stored in the metabase backup header, which
indicates a password was used to create the backup. After the
password is encrypted and stored in the metabase backup, the
password cannot be changed. Only administrators who know the
password can restore the metabase backup. See the <b>To create a
secure backup (Password Required)</b> section below.</p><p><b>Insecure Backup</b><br>
Using this method, the Web site administrator chooses not to supply
a password. The metabase backup is encrypted with a blank password
and anyone can restore the metabase backup. See the <b>To create an
insecure backup (Password Not Required)</b> section below.</p><p><b>Legacy Backup</b><br>
Using this method, the Web site administrator can create metabase
backups programmatically. However, legacy back ups must be restored
either programmatically or by using Configuration Backup/Restore
from the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>The legacy back up method is not recommended
and therefore not described. When you create backups
programmatically, IIS implements the legacy method used in IIS 5.0.
Therefore, you can only restore legacy metabase backups to the
operating system on which the backup was created.</p>
<h3><a name="TocreateabackupwithaPassword">To create a secure backup
(Password Required)</a></h3><ol><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
<b>Computer</b> icon under <b>Internet Information
Services</b>.</li><li>Click <b>Action</b>, select <b>All Tasks</b>, and select <b>
Backup/Restore Configuration</b>.</li><li>Click <b>Create backup</b>.</li><li>Type a name in the <b>Configuration backup name</b> text
box.</li><li>Select the <b>Encrypt backup using password</b> check box, and
type a password into the <b>Password</b> text box.</li><li>Click <b>OK</b>, and click <b>Close</b>. By default, the backup
file is stored in the<br><code>\Winnt\System32\Inetsrv\MetaBack</code> directory.</li></ol><h3>To create an insecure backup (Password Not Required)</h3><ol><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
<b>Computer</b> icon under <b>Internet Information
Services</b>.</li><li>Click <b>Action</b>, select <b>All Tasks</b>, and select <b>
Backup/Restore Configuration</b>.</li><li>Click <b>Create backup</b>.</li><li>Type a name in the <b>Configuration backup name</b> text
box.</li><li>Click <b>OK</b>, and click <b>Close</b>.</li></ol><div><p><b>Related Topics</b></p><ul><li>For information about restoring the metabase, see <a href="mb_rely_reliability.htm"><b>Metabase Reliability</b></a>.</li></ul></div><div class="search-terms">phrase 1, phrase 2, phrase 3</div>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
