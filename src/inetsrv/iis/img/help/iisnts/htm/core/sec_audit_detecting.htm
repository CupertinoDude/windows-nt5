<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Detecting_Unauthorized_Access">
<meta name="description" content="Procedural and conceptual information on how to archive and review security logs to detect unauthorized access attempts.">
<title>Detecting Unauthorized Access</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Detecting Unauthorized Access</h1><p>You can review IIS logs and Windows security logs to monitor
security events over extended periods of time. You can then use the
Microsoft Management Console to view the Windows Security Log. The
IIS logs can be viewed by using any text editor or word processor.
For more information about viewing IIS logs, see <a href="log_logging.htm"><b>Logging Site Activity</b></a>.</p><p>In the Windows Security Log, you can detect unauthorized access
attempts, which can appear as warning or error log entries. You can
also archive these logs for later use. For more information about
auditing, consult the Windows documentation.</p><h6>To detect possible security problems by reviewing the Windows
Security Log</h6> <ol><li>Click <b>Start</b>, point to <b>Settings</b>, click <b>Control
Panel</b>, double-click <b>Administrative Tools</b>, then
double-click <b>Computer Management</b>.</li><li>Expand <b>System Tools</b>.</li><li>Expand <b>Event Viewer</b>.</li><li>Select <b>Security Log</b>. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>If you are not able to view the security log, then
the user account you are using does not have privileges to do so.
This happens because the domain-level security policies override
the local computer-level security policies, which means that you
can be logged on as the Administrator of your local computer, but
not have access to its security log. To get these permissions, see
your network administrator. For more information about security
policies, see the Windows documentation.</p>
</li><li>Inspect the logs for suspicious security events, including the
following: 

<ul><li>Invalid logon attempts.</li><li>Failed use of privileges.</li><li>Failed attempts to access and modify .bat or .cmd files.</li><li>Attempts to alter security privileges or the audit log.</li><li>Attempts to shut down the server.</li></ul></li></ol><h6>To archive a Windows Security Log</h6> <ol><li>Click <b>Start</b>, point to <b>Settings</b>, click <b>Control
Panel</b>, double-click <b>Administrative Tools</b>, then
double-click <b>Computer Management</b>.</li><li>Expand <b>System Tools</b>.</li><li>Expand <b>Event Viewer</b>.</li><li>Select <b>Security</b>.</li><li>On the <b>Action</b> menu, click <b>Save Log File As</b>.</li><li>In the <b>Save As</b> dialog box, select the directory you want
to save the file to, and type in a name for the file. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>The security log can be saved as an event (.evt)
file, a text (.txt) file, or a comma-delimited (.csv) file.</p>
</li></ol><h6>To open an archived Windows Security Log</h6> <ol><li>Click <b>Start</b>, point to <b>Settings</b>, click <b>Control
Panel</b>, double-click <b>Administrative Tools</b>, then
double-click <b>Computer Management</b>.</li><li>Expand <b>System Tools</b>.</li><li>Expand <b>Event Viewer</b>.</li><li>On the <b>Log</b> menu, select <b>Security</b>.</li><li>On the <b>Action</b> menu, point to <b>New</b> and click <b>Log
View</b>.</li><li>In the <b>Add Another Log View</b> dialog box, select <b>Saved
(opens a previously saved log)</b> and browse to the file.</li><li>In the <b>Log type</b> drop-down list, select <b>
Security</b>.</li><li>Click <b>OK</b> to open the file in the viewer.</li></ol><h6>To detect possible security problems by reviewing IIS log
files</h6> <ol><li>In a text editor, such as Notepad, open the log file. For more
information about log files, see <a href="log_logging.htm"><b>Logging Site Activity</b></a>.</li><li>Inspect the logs for suspicious security events, including the
following: 

<ul><li>Multiple failed commands attempting to run executable files or
scripts. (You should closely monitor the Scripts directory.)</li><li>Excessive failed logon attempts from a single IP address, with
the possible intention of increasing network traffic or denying
access to other users.</li><li>Failed attempts to access and modify .bat or .cmd files.</li><li>Unauthorized attempts to upload files to a directory containing
executable files.</li></ul></li></ol><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
