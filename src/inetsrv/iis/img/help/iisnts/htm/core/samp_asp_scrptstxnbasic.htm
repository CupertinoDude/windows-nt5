<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Basic_Transaction">
<meta name="description" content="Internet Information Services reference information">
<title>Basic Transaction</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Basic Transaction</h1><h3>Overview</h3><p>Using ASP, you can easily take advantage of the reliability
provided by Component Services. To do so you only need to include
the @TRANSACTION directive in your script. This directive tells
Component Services that any changes occurring in the page, such as
database manipulation or Message Queuing message transmission,
should be considered transactions. A change that is being managed
by transaction services can either be committed which would make
the change permanent, or aborted the latter would result in the
database or queue being rolled back to its previous state, before
the changes were made.</p><h3>Code Tour</h3><p>In this sample, the entire page has been declared a transaction,
by use of the @TRANSACTION directive. The sample provides some
scripting commands for two other procedures that are called to
perform additional completion or clean-up tasks. <b>
OnTransactionCommit</b> is called either when the script has
successfully completed, or the <b>ObjectContext.SetComplete</b>
method has been called. Likewise, <b>OnTransactionAbort</b> is
called either when the script encounters some kind of processing
error, or the <b>ObjectContext.SetAbort</b> method has been
called.</p><p>This sample commits by default, since it simply prints a small
message and then exits. Since the directive declared the script to
be a transaction, exiting successfully automatically commits
changes made in the script (although in this case there are none),
and triggers the <b>OnTransactionCommit</b> procedure, which prints
a message.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>The @TRANSACTION directive must be on
the first line of the .asp file, or an error will be
generated.</p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
