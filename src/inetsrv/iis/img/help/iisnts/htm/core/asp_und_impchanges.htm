<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Important_Changes_in_ASP">
<meta name="description" content="This topic describes important differences between the current and previous release of ASP, such as default settings changes and behavior changes.">
<title>Important Changes in ASP</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Important Changes in ASP</h1><p>ASP has undergone several important changes and enhancements. If
you are updating your application from a previous version of ASP,
you should be aware of these changes.</p><p><img src="note.gif" alt="note"><b>
      Note
      </b>To learn about new ASP features, see <a href="asp_und_whatsnew.htm"><b>What's New in ASP</b></a>.</p>
<ul><li><b>Buffering On by Default</b> In IIS 4.0, response
buffering was off by default. In IIS 5.1, unless a script
specifically turns off buffering, its output is always buffered.
This means that the final output is sent to the client at the
completion of processing or when the script calls the <b>
Response.Flush</b> method. When upgrading from IIS 4.0 to
IIS 5.1, the IIS 4.0 settings are maintained. Therefore,
response buffering remains off until it is turned on. For more
information, see the Buffering Content section in the <a href="asp_basp_sendcontent.htm#buffcnt"><b>Sending Content to the
Browser</b></a> topic.</li><li><b>Response.IsClientConnected</b> In IIS 4.0, <b>
Response.IsClientConnected</b> returned the correct information
only if an ASP file sent content to the browser. In IIS 5.1,
an ASP file can use the <b>IsClientConnected</b> property prior to
sending content to the browser. For more information, see <a href="ref_vbom_resopicc.htm"><b>IsClientConnected</b></a>.</li><li><b>Improved Include File Security</b> In IIS 4.0,
when an include file resided in a virtual root mapped to a physical
path, ASP did not use the security credentials of the physical path
to process the file. In IIS 5.1, ASP applies the credentials
of the physical path when processing include files. For more
information, see <a href="asp_basp_includingfiles.htm"><b>Including Files</b></a>.</li><li><b>Default Document Query String Behavior</b> In
IIS 5.1, if an .asp (or .cdx) file is configured as the
default document, it can now receive a query string from a URL that
does not specify the default document. For example, the URLs <code>
http://www.microsoft.com/default.asp?newuser=true</code> and <code>
http://www.microsoft.com/?newuser=true</code> will both send a
query string value to the default .asp file.</li><li><b>Transaction Flags</b> IIS 4.0 used the <b>
required</b>, <b>requires new</b>, and <b>not supported</b>
transaction flags to indicate that ASP was starting a new
transaction. In IIS 5.1, this behavior is unchanged. However,
if an .asp file executes a transacted .asp file using the new <b>
Server.Execute</b> or <b>Server.Transfer</b> methods, then the
transaction flag state is maintained for the second .asp file. If
the second .asp file's transaction flags indicate that transactions
are supported or required, then the existing transaction will be
used and a new transaction will not be started.</li><li><b>Behavior of Both-Modeled Objects</b> A Both-Modeled COM
object which does not support the Free-Threaded Marshaller will
fail if it is stored in Application state. Both-Modeled components
must aggregate the Free-Threaded Marshaller to be stored in
Application state.</li><li><b>Configurable Entries Moved to the Metabase</b> The
following IIS 4.0 registry entries are now in the metabase: 

<ul><li>ProcessorThreadMax</li><li>ErrorsToNTLog</li><li><p>For IIS 5.1, all configurable parameters for ASP can be
modified from the metabase.</p></li></ul></li><li><b>Security for Local Server COM Objects</b> IIS uses a
new Windows COM feature called <i>cloaking</i> to enable local
server applications instantiated from an .asp file to have the
security context of the originating client. In previous versions,
the identity assigned to the local server COM object depended on
the identity of the user who created the object instance.</li><li><b>Objects Released Earlier</b> In IIS 4.0, COM
objects were only released when ASP finished processing a page. In
IIS 5.1, if a COM object does not use the <b>OnEndPage</b>
method and the reference count for the object is zero, then the
object is released prior to the completion of processing.</li><li><b>Improved UTF-8 and Multi-byte Character Support</b> In
IIS 5.1 and IIS 6.0, UTF-8 and multi-byte characters are supported
in all of the ASP built-in objects. This includes form data
returned in the Response.QueryString and Response.Form
collections.</li></ul><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
