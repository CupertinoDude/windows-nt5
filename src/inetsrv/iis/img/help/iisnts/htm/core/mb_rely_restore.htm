<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Restoring_the_Metabase">
<meta name="description" content="Describes restoring the Metabase">
<title>Restoring the Metabase</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Restoring the Metabase</h1><p>IIS provides new functionality to Configuration Backup/Restore
located from the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>. Web
site administrators can restore copies of a secure or insecure
backup of the metabase to other computers. You can also restore the
metabase using the legacy method.</p><h3>Issues restoring the metabase backup</h3><p><b>Restoring a secure backup</b>    The password
is stored within the metabase backup and used to encrypt the
session key. This password cannot be changed, and if forgotten,
renders that metabase backup un-usable.</p><p><b>Restoring an insecure backup</b>    Metabase
backups are not password protected. Anyone can restore an insecure
backup to any computer.</p><p><b>Restoring a legacy backup</b>    The legacy
methodology uses the machine key (unique to a particular
installation of the OS) and the system key (generated by IIS) to
encrypt the backup. Therefore, legacy metabase backups can only be
restored to the same installation of the operating system (OS) that
they are created from.</p><p><b>Content Files</b>    Configuration
Backup/Restore does not save your content files. When restoring the
metabase backup to a different server, you must copy your content
files as well. Also, the content files must exist on the same drive
letter that was used by the original server.</p><p><b>SSL Certificates</b>    If you use an SSL
(secure socket layer) Certificate on your Web server and restore
the metabase backup to a different installation of the OS, an error
occurs if the certificate is not available or installed. If a
site's SSL Certificate is missing, connections are dropped, and IIS
displays a "page unavailable" error. The server logs the following
warning in the event log: The solution is to reinstall the
certificate into the same certificate store and restart IIS.
Failure to restart IIS after reinstalling the certificate results
in continued error logs and dropped connections. For more
information about installing SSL Certificates, see <a href="sec_auth_certsetssl.htm"><b>Setting Up SSL on Your Server</b></a>.</p><h3>To restore the metabase backup</h3><ol><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
<b>Computer</b> icon under <b>Internet Information
Services</b>.</li><li>Click the <b>Action</b> button, and select <b>Backup/Restore
Configuration</b>.</li><li>Under <b>Previous backups</b>, select the file name from the
list, and click <b>Restore</b>. If prompted for a password, enter
the password chosen to secure the backup.</li></ol><div><p><b>Related Topics</b></p><ul><li>For information about backing up the metabase, see <a href="mb_rely_backup.htm"><b>Backing Up the Metabase</b></a>.</li><li>For information about metabase key names and paths, property
inheritance, security and reliability, see <a href="mb_structure.htm"><b>Metabase Structure</b></a>.</li><li>For more information about installing SSL Certificates, see <a href="sec_auth_certsetssl.htm"><b>Setting Up SSL on Your Server</b></a>.</li><li>For information about restarting IIS, see <a href="wsa_restartingiis.htm"><b>Restarting IIS</b></a>.</li></ul></div><div class="search-terms">phrase 1, phrase 2, phrase 3</div>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
