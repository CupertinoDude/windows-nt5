<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Granting_and_Denying_Access_to_Computers">
<meta name="description" content="Procedural information on configuring your Web server to grant or deny specific computers, groups of computers, or Internet domains access to your server's Web sites, directories, or files.">
<title>Granting and Denying Access to Computers</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Granting and Denying Access to Computers</h1><p>You can configure your Web server to grant or deny specific
computers, groups of computers, or domains access to Web sites,
directories, or files. For example, if your intranet server is
connected to the Internet, you can prevent Internet users from
accessing your Web server by granting access only to members of
your intranet, and explicitly denying access to outside users.</p><ul><li>When you set security properties for a specific Web site, you
automatically set the same security properties for directories and
files belonging to that site, unless the security properties of the
individual directories and files have been previously set.</li><li>Your Web server will prompt you for permission to reset the
properties of individual directories and files when you attempt to
set security properties for your Web site. If you choose to reset
these properties, your previous security settings will be replaced
by the new settings. The same condition applies when you set
security properties for a directory containing subdirectories or
files with previously set security properties. For more information
about setting properties, see the Properties and Inheritance of
Properties on Sites section in <a href="wsa_webftp_aboutwebftp.htm"><b>About Web and FTP Sites</b></a>.</li></ul><h3>To grant access to computers, groups of computers, or
domains</h3><ol><li>In the IIS snap-in, select a Web site, directory, or file, and
open its property sheets.</li><li>Select the appropriate <b>Directory Security</b> or <b>File
Security</b> property sheet. Under <b>IP Address and Domain Name
Restrictions</b>, click <b>Edit</b>.</li><li>In the <b>IP Address and Domain Name Restrictions</b> dialog
box, select the <b>Denied Access</b> option. When you select this
option, you deny access to all computers and domains, except those
that you specifically grant access to.</li><li>Click <b>Add</b>.</li><li>In the <b>Grant Access On</b> dialog box, select <b>Single
Computer</b>, <b>Group of Computers</b>, or <b>Domain Name</b>
options. For more information about these options, click <b>
Help</b>.</li><li>Click the <b>DNS Lookup</b> button to search for computers or
domains by name, rather than by IP address. Type in a name, then
click <b>OK</b> to close both dialog boxes.</li></ol><h3>To deny access to computers, groups of computers, or
domains</h3><ol><li>In the IIS snap-in, select a Web site, directory, or file, and
open its property sheets.</li><li>Select the appropriate <b>Directory Security</b> or <b>File
Security</b> property sheet. Under <b>IP Address and Domain Name
Restrictions</b>, click <b>Edit</b>.</li><li>In the <b>IP Address and Domain Name Restrictions</b> dialog
box, select the <b>Granted Access</b> option. When you select this
option, you grant access to all computers and domains, except those
that you specifically deny access to.</li><li>Click <b>Add</b>.</li><li>In the <b>Deny Access On</b> dialog box, select <b>Single
Computer</b>, <b>Group of Computers</b>, or <b>Domain Name</b>
options. For more information about these options, click the <b>
Help</b> button.</li><li>Click the <b>DNS Lookup</b> button to search for computers or
domains by name, rather than by IP address. IIS will search on the
current domain for the computer, and if found, will enter its IP
address in the <b>IP address</b> text box. Click <b>OK</b> to close
both dialog boxes.</li></ol><p><img src="note.gif" alt="note"><b>
      Note
      </b>The following information is important to
remember when using this feature.</p><ul><li>Using DNS look-up will cause a performance decrease on your
server while it is looking up DNS addresses.</li><li>A user accessing your Web server through a proxy server will
appear to have the IP address of the proxy server.</li><li>Some user server access problems can be corrected by entering
the "*.domainname.com" syntax rather than the "domainname.com"
syntax as the domain name in the <b>Grant Access On</b> dialog
box.</li></ul><h3>Using the Network ID and Subnet Mask</h3><p>A group of computers can be either denied or granted access
based upon their network ID and a subnet mask. The network ID is
the IP address of a host computer, usually a router for the <i>
subnet</i>, or subnetwork. The subnet mask determines which part of
the IP address is a subnet ID, and which part is a host ID. All
computers in a subnet have the same subnet ID but their own host
ID. By specifying a network ID and a subnet mask, you can select a
group of computers.</p><p>For example, if the host computer has an IP address of
172.16.16.1 and a subnet mask of 255.255.0.0, all of the computers
in that subnet would have IP addresses that began with 172.16. To
select all of the computers in the subnet, enter 172.16.16.1 in the
<b>Network ID</b> text box and 255.255.0.0 in the <b>Subnet
Mask</b> text box. For more information, see the Windows 2000
Server Resource Kit or a reference on TCP/IP protocols.</p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
