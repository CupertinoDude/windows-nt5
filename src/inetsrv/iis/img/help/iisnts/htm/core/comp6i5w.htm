<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Logging_Utility_Component">
<meta name="description" content="Internet Information Services reference information">
<title>Logging Utility Component</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Logging Utility Component</h1><p>The IIS Log component is used to create an <b>IISLog</b> object,
which enables your applications to read from the IIS log. This
component allows you to quickly create, for example, ASP scripts or
VB components that programmatically walk through daily log files so
that certain types of information can be extracted.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>The user accessing the ASP script that
instantiates the <b>IISLog</b> component must be authenticated as
an Administrator or Operator on the server on which IIS is running.
If the user is only Anonymous, the IIS Log component will not
function properly.</p>
<h6>File Names</h6><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1">Logscrpt.dll</td><td width="" height="" colspan="1" rowspan="1">The Logging Utility component</td></tr></table><br><h6>Syntax</h6><p><b>Set</b><i>oIISLog</i><b>= Server.CreateObject( MSWC.IISLog
)</b></p><p><b> </b></p><h6>Parameters</h6><dl><dt><i>oIISLog</i></dt><dd>Specifies the name that can be used as a reference to the <b>
IISLog</b> component.</dd></dl><h6>Methods</h6><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_atend.htm"><b>AtEndOflog</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates whether all records have been read from the log
file.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_closelog.htm"><b>CloseLogFiles</b></a></td><td width="" height="" colspan="1" rowspan="1">Closes all open log files.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_openlog.htm"><b>OpenLogFile</b></a></td><td width="" height="" colspan="1" rowspan="1">Opens a log file for reading or writing.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_readfilt.htm"><b>ReadFilter</b></a></td><td width="" height="" colspan="1" rowspan="1">Filters records from the log file by date and time.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_readlog.htm"><b>ReadLogRecord</b></a></td><td width="" height="" colspan="1" rowspan="1">Reads the next available log record from the current log
file.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_writelog.htm"><b>WriteLogRecord</b></a></td><td width="" height="" colspan="1" rowspan="1">Writes a log record to the current log file.</td></tr></table><br><h6>Properties</h6><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_bytesre.htm"><b>BytesReceived</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the bytes received.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_bytesse.htm"><b>BytesSent</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the bytes sent.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_clientp.htm"><b>ClientIP</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the client's host name.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_cookie.htm"><b>Cookie</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the client's cookie.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_custf.htm"><b>CustomFields</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates an array of custom headers</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_datetime.htm"><b>DateTime</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the date and time in GMT.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_method.htm"><b>Method</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the operation type.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_protsta.htm"><b>ProtocolStatus</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the protocol status.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_protver.htm"><b>ProtocolVersion</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the version string.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_referer.htm"><b>Referer</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the referrer page.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_serverip.htm"><b>ServerIP</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the server's IP address.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_servername.htm"><b>ServerName</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the server name.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_serverport.htm"><b>ServerPort</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the port number.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_servicename.htm"><b>ServiceName</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the service name.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_timetaken.htm"><b>TimeTaken</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the total processing time.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_uriquery.htm"><b>URIQuery</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates any parameters passed with the request.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_uristem.htm"><b>URIStem</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the target URL.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_useragent.htm"><b>UserAgent</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the user agent string.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_uername.htm"><b>UserName</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the user's name.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_luc_win32sta.htm"><b>Win32Status</b></a></td><td width="" height="" colspan="1" rowspan="1">Indicates the Win32 status code.</td></tr></table><p><img src="note.gif" alt="note"><b>
      Note
      </b>The following steps are necessary to use the IIS
Log component effectively:</p>
<ul><li>Use the OpenLogFile method to specify from which log file or
files the IISLog component should read.</li><li>Use the ReadLogRecord to read the appropriate log records.</li><li>Use the IIS Log component properties to retrieve specific
information from the log records.</li></ul><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>Only log files created by logging modules that
support log file reading will be accessible through this component.
The four built-in logging modules that come with IIS support
log-file reading, but if you are using a custom or third-party
logging module, you will need to enhance the logging module.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
