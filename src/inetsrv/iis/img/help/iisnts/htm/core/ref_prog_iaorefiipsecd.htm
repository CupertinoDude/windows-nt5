<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="IPDeny">
<meta name="description" content="Internet Information Services reference information">
<title>IPDeny</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>IPDeny</h3><p>You can use the <b>IPDeny</b> property of the <a href="ref_prog_iaorefiipsec.htm"><b>IIsIPSecurity</b></a> object to
edit lists of IP addresses, held in an array, that are not allowed
access to the server.</p><h6>Syntax</h6><p><i>SecObj</i>.<b>IPDeny</b> = <i>"IPAddress,SubnetMask"</i></p><p><i>varIPDeny = SecObj</i>.<b>IPDeny</b></p><h6>Parameters</h6><dl><dt><i>SecObj</i></dt><dd>An IIS Admin Object of type <b>IIsIPSecurity</b>.<br></dd><dt><i>IPAddress</i></dt><dd>This is a specific IP address you want to deny access to the
server.</dd></dl><p><i>SubnetMask</i></p><p>This is the subnet mask for the specified IP address.</p><h6>Code Example</h6><p><code>&lt;%</code></p><p><code>  ' Remember to enable Integrated Windows
Authentication and</code></p><p><code>  ' disable Anonymous Access or you will get and
Server 500 error.</code></p><p><code>  Dim SecObj</code></p><p><code>  Dim MyIPSec</code></p><p><code>  Dim IPList</code></p><p><code>  </code></p><p><code>  ' Get the IIS object that holds the info for
the default site. </code></p><p><code>  ' This could be any site root/vdir, or
IIS://LocalHost/W3SVC for global </code></p><p><code>  ' properties.</code></p><p><code>  Set SecObj =
GetObject("IIS://LocalHost/W3SVC/1/Root")</code></p><p><code>  </code></p><p><code>  ' Get the IIsIPSecurity object</code></p><p><code>  Set MyIPSec = SecObj.IPSecurity</code></p><p><code>  ' Make sure GrantByDefault=TRUE or your
changes will not count </code></p><p><code>  If (FALSE = MyIPSec.GrantByDefault)
Then</code></p><p><code>Response.Write</code></p><p><code>  "&lt;BR&gt;GrantByDefault was not TRUE. 
Setting to TRUE.&lt;BR&gt;"</code></p><p><code>MyIPSec.GrantByDefault = TRUE</code></p><p><code>  End If</code></p><p><code>  ' Get the Deny list, as an array, and add your
new restricted IP</code></p><p><code>  IPList = MyIPSec.IPDeny</code></p><p><code>  Redim IPList (Ubound(IPList)+1)</code></p><p><code>  IPList (Ubound(IPList)) =
"123.0.0.1,255.255.255.0"</code></p><p><code>   </code></p><p><code>  ' Set the new lists back in the metabase in
two stages, and then set  </code></p><p><code>  ' the metabase</code></p><p><code>  MyIPSec.IPDeny = IPList</code></p><p><code>  SecObj.IPSecurity = MyIPSec</code></p><p><code>  SecObj.Setinfo</code></p><p><code>  Response.Write "The IPRestriction has been
set&lt;BR&gt;"</code></p><p><code>%&gt;</code></p><h6>See Also</h6><p><a href="ref_prog_iaorefiipsecg.htm"><b>IPGrant</b></a>, <a href="ref_prog_iaorefiipsecdd.htm"><b>DomainDeny</b></a>, <a href="ref_prog_iaorefiipsecdg.htm"><b>DomainGrant</b></a>, <a href="ref_prog_iaorefiipsecgbd.htm"><b>GrantByDefault</b></a>, <a href="ref_prog_iaorefiipsec.htm"><b>IIsIPSecurity</b></a></p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
