<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Using_the_New_Security_Task_Wizards">
<meta name="description" content="Conceptual and procedural information on the new security task wizards. Includes information on the Web Server Certificate Wizard, the CTL Wizard, and the Permissions Wizard.">
<title>Using the New Security Task Wizards</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Using the New Security Task Wizards</h1><a name="managingkeypairs"></a><p>Internet Information Services now comes with three new security
task wizards that simplify most of the security tasks necessary to
maintain a secure Web site. You can use the Web Server Certificate
Wizard to manage Secure Sockets Layer (SSL) features in IIS and
server certificates. Certificates are used in negotiating a secure
link between your server and a user's browser. You can use the CTL
Wizard to manage certificate trust lists (CTLs). Certificate trust
lists are lists of trusted certification authorities for each Web
site or virtual directory. You can use the Permissions Wizard to
assign Web and NTFS access permissions to Web sites, virtual
directories, and files on your server.</p><ul><li><a href="#aboutwizard"><b>About the Wizards</b></a></li><li><a href="#accesswizard"><b>Accessing the Wizards</b></a></li></ul><a name="aboutwizard"></a><h2><a name="H2_448403304"></a>About the
Wizards</h2><p>The Certificate, CTL, and Permissions wizards perform many of
the tasks formerly done in the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>. With the exception of the Permissions Wizard, these
functionalities are no longer accessible in the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>.</p><a name="TheWebServerCertificateWizard"></a><h3>The Web Server Certificate Wizard</h3><p>Obtaining, configuring, and renewing server certificates can now
all be done through one interface in the Web Server Certificate
Wizard. The wizard can detect whether a server certificate has
already been installed and if it is about to expire. You can use
the wizard to create a certificate request, replace the server
certificate with another one from a certification authority (CA),
from an online CA, such as Microsoft Certificate Services, or from
a file previously obtained in Key Manager. You can also reassign a
certificate from one Web site to another Web site. You can also use
the wizard to view certificates.</p><p>When creating a new certificate, the Web Server Certificate
Wizard allows you to choose the strength of encryption, the type of
certificate, and a cryptographic service provider for your
certificate.</p><p><img src="note.gif" alt="note"><b>
      Note
      </b>Online requests for server certificates can only be
made to local and remote Enterprise Certificate Services and remote
Stand-alone Certificate Services. The IIS Web Server Certificate
Wizard does not recognize a stand-alone installation of Certificate
Services on the same computer when requesting a certificate. To get
around this, use the offline certificate request to save the
request to a file and then process as an offline request (see the
Certificate Services documentation).</p>
<p><img src="note.gif" alt="note"><b>
      Note
      </b>If you are not using an online certification
authority, you will need to save the request file generated by the
Web Server Certificate Wizard to disk and send it to the CA. When
the response is received, you can start the wizard and it will
begin where it left off before. If you are replacing a certificate,
IIS will continue to use the old certificate until the new request
is completed. For a list of certification authorities supporting
Internet Information Services, see <a href="sec_auth_certobtainsrv.htm"><b>Obtaining a Server Certificate</b></a>.</p>
<h3>The CTL Wizard</h3><p>You can use the CTL Wizard to create and configure certificate
trust lists (CTLs). A CTL is a list of trusted certification
authorities (CA) for a particular Web site. By configuring your
CTL, you can allow certificates issued by one CA to be used but not
from another CA. CTLs are especially useful for Internet Service
Providers (ISPs) who have several Web sites on their server and who
need to have a different list of approved certification authorities
for each site. CTLs are available only at the Web site level and
are not available for FTP sites.</p><h3>The Permissions Wizard</h3><p>The Permissions wizard takes a scenario-driven approach in
setting up Web and FTP permissions, NTFS access permissions, and
authentication schemes. Rather than setting each area with a
separate user interface, you select the scenario that most closely
resembles your site's needs and the wizard sets all of the access
permissions and authentication schemes for you. One of the great
advantages of this is that the wizard will ensure that Web (or FTP)
and NTFS permissions are properly coordinated and that the correct
authentication scheme is used. All of the settings can still be
changed in the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>. The
scenarios are:</p><ol><li><b>Public Web Site</b>. This is the most common configuration,
in which the information on the site is intended for public
consumption over the Internet. It uses anonymous authentication and
allows users to view all files and access Active Server Pages
applications on your Web server. It also gives administrators
complete control over the site.</li><li><b>Secure Web Site</b>. This configuration is used for
corporate extranets, which are intranets accessed over the
Internet. Information on the site is intended for restricted
consumption. It uses Basic, Digest, or integrated Windows
authentication. It allows only authorized users to view all files
and access Active Server Pages applications on your Web server. It
also gives administrators complete control over the site.</li></ol><p><img src="note.gif" alt="note"><b>
      Note
      </b>If you choose to inherit all security settings when
running the Permissions Wizard, customers might be denied access to
the Web site. To correct this, open the <b>Home Directory</b>
property sheet for the Web site and select <b>Read</b> and <b>
Scripts only</b> permissions. When prompted, have all virtual
directories and files inherit these settings.</p><a name="accesswizard"></a><h2><a name="H2_448406908"></a>Accessing the
Wizards</h2><p>To access the Web Server Certificate Wizard and the CTL Wizard
from the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>:</p><ol><li>Select a site, directory, or file, and open its property
sheets.</li><li>On the <b>Directory Security</b> property sheet, under <b>
Secure Communications</b> click <b>Server Certificate</b> to access
the Web Server Certificate Wizard and change settings regarding
your certificates.</li><li>On the <b>Directory Security</b> or <b>File Security</b>
property sheet, under <b>Secure Communications</b> click <b>
Edit</b>. Under <b>Enable certificate trust list</b> click either
<b>New</b> or <b>Edit</b> to access the CTL Wizard and change
settings regarding your certificate trust lists.</li></ol><p><b>Note</b></p><ul><li>You must have a server certificate installed to access the CTL
Wizard.</li><li>You must enable certificate trust lists to use the <b>New</b>
and <b>Edit</b> buttons.</li></ul><p><b>To access the Permissions Wizard from the Internet <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>:</b></p><ol><li>Choose the Web or FTP site and click the <b>Action</b>
menu.</li><li>From the list, point to <b>All Tasks</b> and then click <b>
Permission Wizard</b>.</li></ol><p><img src="note.gif" alt="note"><b>
      Note
      </b>Use the following guidelines when assigning IP
addresses, Web sites, and SSL ports to your server
certificates:</p>
<ul><li>You <i>cannot</i> assign multiple server certificates per Web
site.</li><li>You <i>can</i> assign a certificate to multiple Web sites.</li><li>You <i>can</i> assign multiple IP addresses per Web site.</li><li>You <i>can</i> assign multiple SSL ports per Web site.</li></ul><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
