<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Ad_Rotator">
<meta name="description" content="Internet Information Services reference information">
<title>Ad Rotator</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h2>Ad Rotator</h2><h6>Overview</h6><p>The Ad Rotator component creates an <b>AdRotator</b> object,
which automates the rotation of advertisement images on a Web page.
The component is designed to display a new advertisement each time
a client browser opens or reloads a Web page.</p><h6>Code Tour</h6><p>This sample demonstrates how to use the Ad Rotator component.
The script itself is simple, creating an instance of the <b>
AdRotator</b> object and calling the <b>GetAdvertisement</b> method
each time the page is loaded. <b>GetAdvertisement</b> returns a
single ad entry from the Ad Rotator schedule file, adrot.txt in
this example, and the special script delimiter &lt;% = ... %&gt;
displays the results to the client browser.</p><p>The schedule file for this sample, adrot.txt, is relatively
straightforward. The four lines above the asterisk (*) are global
file settings that affect all schedule entries in the file. The
most interesting and useful global setting is the redirection
specification. In this sample, if a user clicks on the
advertisement, no matter which particular entry is currently
displayed, the user will be transported to the .asp file indicated.
These scripts, or DLLs, usually count how many hits a given ad has
received, collect user information, and then extract the URL from
the request and redirect the client browser once again to the URL
that was originally requested.</p><p>Each of the entries that occurs below the asterisk consist of
four lines, denoting the image to be displayed, hyperlink,
alternate text, and the relative probability that that particular
entry will be displayed on any given visit to that Web page. Thus,
the Microsoft<sup>®</sup> Internet Information Services image
has an 80 percent chance of being displayed with each hit on that
page, while the Microsoft Internet Explorer image will be displayed
for only 20 percent of the hits.</p><p><img src="note.gif" alt="note"><b>
      Note
      </b>If an advertisement entry in the schedule file does
not have a corresponding URL, the hyperlink line of the entry must
contain a hyphen (-) or the Ad Rotator component will return an
error.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
