<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="About_Windows_Events">
<meta name="description" content="Conceptual information about logging Windows Events. Briefly describes the options available for event logging for IIS.">
<title>About Windows Events</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>About Windows Events</h1><p>Logging begins automatically whenever Windows is started. There
are three types of logs: System, Security, and Application. For
each type of log, you can filter the events to be viewed, designate
the number of entries to view, decide how long to save entries, and
decide whether to automatically overwrite existing events when the
log becomes full.</p><p>There are several ways to open the Event Viewer:</p><ul><li>Click <b>Start</b>, select <b>Run</b>, and type <b>eventvwr</b>
in the <b>Open</b> text box.  Press ENTER.</li><li>Type <b>start eventvwr</b> in a command window, and press
ENTER.</li><li>Click <b>Start</b>, select <b>Programs</b>, select <b>
Administrative Tools</b>, and select <b>Event Viewer</b>.</li><li>Click <b>Start</b>, select <b>Programs</b>, select <b>
Administrative Tools</b>, and select <b>Computer Management</b>.
<b>Event Viewer</b> is listed under the <b>System Tools</b> node.
The benefit of this display is that the IIS snap-in is in the same
window under the <b>Services and Applications</b> node.</li></ul><h2><a name="aspevents">ASP Errors and the Windows
Event Log</a></h2><p>In the Event Viewer, you can open the property pages for each
type of log and configure the filter options that generally apply
to all events.</p><p>IIS increases the degree of control by providing two metabase
keys that allow you to specify what is sent to the Windows Event
log when ASP errors occur. </p><ul><li><a href="ref_mb_asplogerrorrequests.htm"><b>AspLogErrorRequests</b></a>: If this key is set to TRUE, IIS allows ASP
errors to be sent to the Application event log. If the key is set
to FALSE, no ASP errors are sent. This key can be set in the IIS
snap-in or set programmatically. In the IIS snap-in, display the
properties of a virtual directory, set the <b>Application
Protection</b> to <b>High (Isolated)</b>, and click <b>
Configuration</b>. Click the <b>Process Options</b> tab, and select
the <b>Write unsuccessful client requests to event log</b>
checkbox. When checked, this metabase key is set to TRUE.</li><li><a href="ref_mb_asperrorstontlog.htm"><b>AspErrorsToNTLog</b></a>: If
this key is set to TRUE, all possible ASP errors are sent to the
Application event log. If this key is set to FALSE, only a subset
of all ASP errors is sent. The subset includes the error numbers
100, 101, 102, 103, 104, 105, 106, 107, 115, 190, 191, 192, 193,
194, 240, 241, 242. This key cannot be set in the IIS snap-in, and
must be set programmatically.</li></ul><p>For descriptions of ASP Event errors, see <a href="ref_we_aspevents.htm"><b>Active Server Pages Events</b></a>.</p><p>For more information on the metabase and programmatic
administration of IIS, see <a href="prog_prog.htm"><b>Programmatic Administration</b></a>. A quick way to set these keys is to use the
adsutil.vbs script sample in X:\inetpub\adminscripts, where X: is
the drive on which you installed IIS. For example, to send the
subset of ASP Event errors to the Windows Event log, type the
following lines in a command window:</p><pre><code>   /cscript adsutil.vbs SET
w3svc/1/root/&lt;vdir_name&gt;/AspLogErrorRequests
TRUE/</code></pre><pre><code>   /cscript adsutil.vbs SET
w3svc/1/root/&lt;vdir_name&gt;/AspErrorsToNTLog FALSE/</code></pre><p><img src="note.gif" alt="note"><b>
      Note
      </b>ASP errors can also be logged to the IIS log files.
This is configured in the IIS snap-in. If logging an ASP error to
the IIS log file fails, the error will be sent to the Windows Event
Log.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
