<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Installing_ISAPI_Filters">
<meta name="description" content="Procedural information on how to install an ISAPI filter on a Web site.">
<title>Installing ISAPI Filters</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Installing ISAPI Filters</h1><p>Like ISAPI extensions, ISAPI filters are programs that respond
when the Web server receives an HTTP request. However, unlike ISAPI
extensions, ISAPI filters are always run in the server
process.ISAPI filters are different from applications because they
are driven by Web server events rather than by a client request.
You can associate an ISAPI filter with a particular Web server
event; the filter is then notified every time its associated event
occurs. For example, a filter could be notified when a Read or
Write event occurs and then encrypt the raw data to be returned to
the client.</p><p>You can install filters for all sites on a server (global
filters), and you can install filters for individual Web sites. If
you install both global filters and site filters, the two filter
lists are merged for the site.</p><p>When several filters have registered for the same event, they
are called sequentially. Filters with a higher priority are run
before filters with a lower priority. If several filters have the
same priority, global filters set in the master properties are run
before filters set at the site level. Filters with the same
priority at the same inheritance level are run according to the
order in which they were loaded. You can change the filter load
order on the property sheets for the Web server or Web site.</p><h6>To add a filter to a Web server or Web site</h6><ol><li>In the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>, select the
Web server or Web site, and open its property sheets.</li><li>Click the <b>ISAPI Filters</b> tab. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>If you are adding filters to a Web site, you will
not see any global filters inherited from the Web server's master
properties. You will see only the filters installed for the Web
site, even though both sets of filters are run.</p>
</li><li>Click the <b>Add</b> button.</li><li>Type the name of the filter in the <b>Filter Name</b> box and
either type or browse for the DLL file in the <b>Executable</b>
box.</li><li>Click <b>OK</b>.</li><li>To change the load order of a filter, use the arrows. 

<p><img src="note.gif" alt="note"><b>
      Note
      </b>You can only change the load order of filters with
the same priority.</p>
</li><li>If you have added or changed a global filter, you must stop and
restart the Web server to load the new filters into memory. A
filter added at the Web site level is automatically loaded when you
add it.</li></ol><p><img src="note.gif" alt="note"><b>
      Note
      </b>If an HTTP request triggers an event for which the
filter is registered, the filter will receive the data contained in
the request regardless of whether the request is for a file, a CGI
application, or an ISAPI extension.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
