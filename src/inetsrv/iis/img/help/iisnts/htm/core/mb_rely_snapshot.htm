<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Metabase_Snapshot_Writer">
<meta name="description" content="Describes how metabase snapshot writer interacts with NTbackup.">
<title>Metabase Snapshot Writer</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Metabase Snapshot Writer</h1><p>Metabase Snapshot Writer (MSW) uses COM interfaces to ensure
NTbackup creates a stable and reliable backup of the metabase. MSW
is automatically activated when NTbackup is used to back up the
metabase. MSW determines if one of the drive volumes NTbackup is
assigned to back up contains the metabase files. If so, MSW flushes
the data from the In-Memory metabase to the MetaBase.xml and
MBSchema.xml files. If not, MSW waits for the next call for
NTbackup. Next, MSW prevents new information from being added to
the In-Memory metabase for a maximum of two minutes, while NT
Backup backs up the metabase. When NT Backup finishes, MSW releases
the write lock on the In-memory metabase. The following graphic
illustrates the MSW activation and functionality.</p><img src="iisnapshot.gif" alt="A graphic about how MSW works."><p><img src="note.gif" alt="note"><b>
      Note
      </b>Metabase Snapshot Writer supports NTbackup, it is
not a part of the Configuration Backup/Restore application that
runs from the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>.</p>
<p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>NTbackup does not invoke Metabase Snapshot
Writer when restoring the Metabase.xml and MBSchema.xml files.
Before restoring the metabase with NTbackup, stop the IIS Admin
service to prevent IIS from writing to the metabase files.</p>
<div><p><b>Related Topics</b></p><ul><li>For more information about NT backup, search for the keyword
"ntbackup" in the online Windows help.</li><li>For more information about stopping and restarting the IIS
Admin service, see <a href="wsa_restartingiis.htm"><b>Restarting IIS</b></a>.</li><li>For more information about the metabase, see <a href="mb_metabase.htm"><b>Metabase</b></a>.</li><li>For information about backing up and restoring the metabase,
see <a href="mb_rely_reliability.htm"><b>Metabase Reliability</b></a>.</li></ul></div><div class="search-terms">phrase 1, phrase 2, phrase 3</div>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
