<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Counters_Component">
<meta name="description" content="Internet Information Services reference information">
<title>Counters Component</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Counters Component</h1><p>The Counter component creates a <b>Counters</b> object that can
create, store, increment, and retrieve any number of individual
counters.</p><p>A counter is a persistent value that contains an integer. You
can manipulate a counter with the <b>Get</b>, <b>Increment</b>, <b>
Set</b>, and <b>Remove</b> methods of the <b>Counters</b> object.
Once you create the counter, it persists until you remove it.</p><p>Counters do not automatically increment on an event like a page
hit. You must manually set or increment counters using the <a href="ica_cnt_set.htm"><b>Set</b></a> and <a href="ica_cnt_increment.htm"><b>Increment</b></a> methods.</p><p>Counters are not limited in scope. Once you create a counter,
any page on your site can retrieve or manipulate its value. For
example, if you increment and display a counter named <i>hits</i>
in a page called Page1.asp, and you increment <i>hits</i> in
another page called Page2.asp, both pages will increment the same
counter. If you hit Page1.asp, and increment <i>hits</i> to 34,
hitting Page2.asp will increment <i>hits</i> to 35. The next time
you hit Page1.asp, <i>hits</i> will increment to 36.</p><p>All counters are stored in a single text file, Counters.txt,
which is located in the same directory as the counters<i>.</i>dll
file.</p><p>After you update, create or delete a counter, the IIS Services
may need to be restarted before you see the change in the
Counters.txt file.</p><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>File Name</b></td><td width="" height="" colspan="1" rowspan="1"><b>Description</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">Counters.dll</td><td width="" height="" colspan="1" rowspan="1">The Counters component.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Counters.txt</td><td width="" height="" colspan="1" rowspan="1">The file that stores all individual counters on a site.
Counters.txt is a UTF8-encoded file. You can have any Unicode
characters in a counter name.</td></tr></table><br><h6>Syntax</h6><p>Create the <b>Counters</b> object one time on your server by
adding the following to the Global.asa file:</p><pre><code><b>&lt;OBJECT 
RUNAT=Server 
SCOPE=Application 
ID=</b><i>Counter</i><b>PROG&gt;</b><b>&lt;/OBJECT&gt;</b></code></pre><p><img src="note.gif" alt="note"><b>
      Note
      </b>Only create one Counters object in your site. This
single Counters object can create any number of individual
counters.</p>
<p>For Internet Information Services on
Windows<sup>®</sup> 95 or later, a Counters component has
already been specified in the Global.asa file in the default
virtual directory. You can work with the <b>Counters</b> object the
component creates as if it were a built-in object by calling <b>
Counters.Get</b>, <b>Counters.Increment</b>, <b>
Counters.Remove</b>, and <b>Counters.Set</b>. You should not create
another instance of the <b>Counters</b> object.</p><h6>Methods</h6><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_cnt_get.htm"><b>Get</b></a></td><td width="" height="" colspan="1" rowspan="1">Returns the value of the counter.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_cnt_increment.htm"><b>Increment</b></a></td><td width="" height="" colspan="1" rowspan="1">Increases the counter by 1.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_cnt_remove.htm"><b>Remove</b></a></td><td width="" height="" colspan="1" rowspan="1">Removes the counter from the Counters.txt file.</td></tr><tr><td width="" height="" colspan="1" rowspan="1"><a href="ica_cnt_set.htm"><b>Set</b></a></td><td width="" height="" colspan="1" rowspan="1">Sets the value of the counter to a specific integer.</td></tr></table><br><h6>Example</h6><p>Create an instance of the <b>Counters</b> object in the
Global.asa file with the ID attribute set to <code>
Counter</code>:</p><p>--- Global.asa ---</p><pre><code>&lt;OBJECT 
RUNAT=Server 
SCOPE=Application 
ID=Counters 
PROG&gt; 
&lt;/OBJECT&gt;
</code></pre><p>You can then use that <b>Counters</b> object on one page to
create all the counters you need:</p><pre><code>Setting the Site Counter to &lt;%= Counters.Set("SiteCounter", 1).
</code></pre><p>Then on another page you can increment the counter in the
following manner:</p><pre><code>You are visitor number&lt;%= Counters.Increment("SiteCounter ") %&gt; to this page.
</code></pre><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
