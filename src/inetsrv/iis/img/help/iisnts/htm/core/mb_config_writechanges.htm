<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Writing_Changes_to_MetaBase.XML">
<meta name="description" content="Describes writting changes to the metabase configuration.">
<title>Writing Changes to MetaBase.XML</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Writing Changes to MetaBase.XML</h1><p>Editing the MetaBase.xml file directly, using common plain text
tools such as Notepad, is an efficient way for administrators a way
to make changes to the metabase configuration over low bandwidth
connections. Editing MetaBase.xml with Notepad is more efficient
because using the IIS snap-in is relatively slow over small
bandwidth lines such as a 56k modem. Additionally, editing the
metabase file directly is faster than using User Interface (UI)
interfaces such as the IIS snap-in when hundreds or thousands of
sites are running on the same computer. Editing MetaBase.xml
directly  is particularly helpful to administrators that that
don't use programmatic methods to administer IIS, but want an
alternative to the UI methods.</p><p>Changes can be made to the MetaBase.xml file while IIS is
running only if <a href="mb_ewr_ewr.htm" target="_New"><b>Edit while
running</b></a> has been enabled. Otherwise changes made to
MetaBase.xml can only be made when IIS is not running. Because
MetaBase.xml is human editable, catastrophic format errors and
recoverable metabase schema errors can be introduced by
administrators. Catastrophic format errors occur when text editing
yields non-well-formed XML such as missing XML tags. IIS will fail
to start with Catastrophic format errors. Recoverable metabase
schema errors occur when text editing yields well-formed XML but
one or more properties is invalid according the metabase
schema. </p><p>The metabase is Unicode. To support international and non-ASCII
characters, the MetaBase.xml file supports UTF-8 encoding.</p><h2>General Notes</h2><p>Properties with the secure attribute set will be stored as
encrypted.<br>
MetaBase.xml is case sensitive.<br>
The KeyType property found at a node will be used to determine the
element or node type applied to the metabase path.<br>
Nodes that do not contain a KeyType property will be stored as the
generic object IISWebConfig, which can contain any property, and
any node can be contained within any other node.<br>
Customer properties will be allowed for any node type.<br>
The IISGlobal node should not be edited.<br>
Properties which appear in schema that violate the schema (e.g.
misspelled property name) will be logged and the property will be
ignored<br>
Custom properties require a metabase ID attribute.<br>
The Multi-SZ attribute is replaced with the multi-string value.
Flags contain bitmask identifiers.<br></p><h2>Writing changes in or out of schema</h2><p>Reasons for using custom properties:<br>
To use properties that are not defined in schema<br>
To use properties with different attribute values than were defined
in schema</p><p>When writing a property using different attribute values than
what is defined in schema must be written as custom property. Only
the attributes that are different from schema must be defined in
MetaBase.xml.<br>
Example:</p><p><b>In schema property</b></p><pre><code>AccessFlags = AccessWrite
</code></pre><p><b>Custom Property</b></p><pre><code>&lt;Custom&gt;<br>
    Name="AccessFlags"<br><br>
    Value=AccessRead"<br>
 &lt;/Custom&gt;
</code></pre><div class="search-terms">phrase 1, phrase 2, phrase 3</div>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
