<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Metabase_Backup_Utility">
<meta name="description" content="Internet Information Services reference information">
<title>Metabase Backup Utility</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Metabase Backup Utility</h1><h6>Overview</h6><p>The IIS metabase is a large and complicated structure, and has
much vital information about your Internet sites. So that you can
easily protect that important data, backing up the metabase has
been made into a relatively easy task. This tool demonstrates how
you can create a tool that makes backing up the metabase even
easier.</p><h6>Code Tour</h6><p>All metabase backup functionality is provided at the
IIS://LocalHost level, so this string is passed to <b>GetObject</b>
to get a reference to the local machine object. The <b>Backup</b>
method is then invoked with several parameters, including a number
of flags, a location, and a version number.</p><p>The location parameter refers to a name that you give to your
set of backup versions. Backup implementation will probably change
in future releases, but at the time of this writing, all backups
are stored in the same directory. Therefore, it might be helpful to
think of location as the name of a series of backup snapshots.</p><p>The backup version parameter can be explicit, or you can use one
of several special values, the most important being &amp;HFFFFFFFF.
This value, which equals -1 in VBScript, indicates that the <b>
Backup</b> method should assign a version number to this backup
that is one higher than the highest version number found for that
location.</p><h6>Location</h6><p>This script is available in the Internet services directory, at
...\iissamples\sdk\admin\metaback.vbs.</p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
