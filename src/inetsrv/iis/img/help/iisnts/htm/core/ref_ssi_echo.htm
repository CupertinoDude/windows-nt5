<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="#echo">
<meta name="description" content="Internet Information Services reference information. The #echo directive instructs the Web server to insert the value of an environment variable into an HTML page.">
<title>#echo</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h2>#echo</h2><a name="_k2_echo"></a><p>The <b>#echo</b> directive instructs the Web server to display
the value of a server variable. You must surround a directive with
HTML comment delimiters.</p><p>By default, this directive can be used only in STM pages; it
cannot be used in ASP pages. For ASP pages, you can access the
server variables by using the <a href="ref_vbom_reqocsv.htm"><b>ServerVariables</b></a> collection.</p><h6>Syntax</h6><p><b>&lt;!-- #echo var =</b><i>VariableName</i><b>--&gt;</b></p><h6>Parameters</h6><p><i>VariableName</i></p><p>Specifies the name of the variable whose value
you want to insert. The variable can be one of the following:</p><table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>Variable</b></td><td width="" height="" colspan="1" rowspan="1"><b>Meaning</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">ALL_HTTP</td><td width="" height="" colspan="1" rowspan="1">All HTTP headers that were not already parsed into one of the
other variables described in this table. These variables are of the
form HTTP_<i>header field name</i>. The headers consist of a
null-terminated string with the individual headers separated by
carriage return line feeds.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">AUTH_TYPE</td><td width="" height="" colspan="1" rowspan="1">This contains the type of authentication used. For example, the
string will be "Basic" if Basic authentication is used, and it will
be "integrated Windows authentication" for integrated
authentication. Other authentication schemes will have other
strings. Because new authentication types can be added to the Web
server, it is not possible to list all the string possibilities. If
the string is empty, then no authentication is used.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">AUTH_PASSWORD</td><td width="" height="" colspan="1" rowspan="1">The value entered in the client's authentication dialog box.
This variable is available only if Basic authentication is
used.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">AUTH_USER</td><td width="" height="" colspan="1" rowspan="1">The value entered in the client's authentication dialog
box.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">CONTENT_LENGTH</td><td width="" height="" colspan="1" rowspan="1">The number of bytes that the script can expect to receive from
the client.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">CONTENT_TYPE</td><td width="" height="" colspan="1" rowspan="1">The content type of the information supplied in the body of a
POST request.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">DOCUMENT_NAME</td><td width="" height="" colspan="1" rowspan="1">The current file name.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">DOCUMENT_URI</td><td width="" height="" colspan="1" rowspan="1">The virtual path to the current document.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">DATE_GMT</td><td width="" height="" colspan="1" rowspan="1">The current date in Greenwich Mean Time (GMT).</td></tr><tr><td width="" height="" colspan="1" rowspan="1">DATE_LOCAL</td><td width="" height="" colspan="1" rowspan="1">The current date in the local time zone.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">GATEWAY_INTERFACE</td><td width="" height="" colspan="1" rowspan="1">The revision of the CGI specification used by the Web server.
The revision is returned in the format CGI/<i>revision</i>.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">HTTP_ACCEPT</td><td width="" height="" colspan="1" rowspan="1">Special-case HTTP header. Values of the accept fields are
concatenated, and separated by a comma (,). For example, if the
following lines are part of the HTTP header: 

<p><code>   accept: */*; q=0.1<br>  accept: text/html<br>  accept: image/jpeg</code></p><p>the HTTP_ACCEPT variable will have a value of:</p><p><code>   */*; q=0.1, text/html,
image/jpeg</code></p></td></tr><tr><td width="" height="" colspan="1" rowspan="1">LAST_MODIFIED</td><td width="" height="" colspan="1" rowspan="1">The date that the current document was last modified.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">PATH_INFO</td><td width="" height="" colspan="1" rowspan="1">Additional path information, as given by the client. This
consists of the trailing part of the URL after the script name, but
before the query string, if any.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">PATH_TRANSLATED</td><td width="" height="" colspan="1" rowspan="1">This is the value of PATH_INFO, but with any virtual path
expanded into a directory specification.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">QUERY_STRING</td><td width="" height="" colspan="1" rowspan="1">The information that follows the question mark (?) in the URL
that referenced this script.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">QUERY_STRING_UNESCAPED</td><td width="" height="" colspan="1" rowspan="1">Unescaped version of the query string; that is, a version that
is not URL encoded.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">REMOTE_ADDR</td><td width="" height="" colspan="1" rowspan="1">The IP address of the client or agent of the client (for
example, gateway or firewall) that sent the request.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">REMOTE_HOST</td><td width="" height="" colspan="1" rowspan="1">The host name of the client or agent of the client (for
example, gateway or firewall) that sent the request. IIS 2.0
and 3.0 returned an IP address for this parameter.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">REMOTE_USER</td><td width="" height="" colspan="1" rowspan="1">This contains the user name of the client if the client went
through authentication by the server. This comes back as an empty
string if Anonymous Access is enabled on the application.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">REQUEST_METHOD</td><td width="" height="" colspan="1" rowspan="1">The HTTP request method.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">SCRIPT_NAME</td><td width="" height="" colspan="1" rowspan="1">The name of the script program being executed.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">SERVER_NAME</td><td width="" height="" colspan="1" rowspan="1">The server's host name, or IP address, as it should appear in
self-referencing URLs.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">SERVER_PORT</td><td width="" height="" colspan="1" rowspan="1">The TCP/IP port on which the request was received.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">SERVER_PORT_SECURE</td><td width="" height="" colspan="1" rowspan="1">A string of either 0 or 1. If the request is being handled on
the secure port, this will be 1. Otherwise, it will be 0.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">SERVER_PROTOCOL</td><td width="" height="" colspan="1" rowspan="1">The name and version of the information retrieval protocol
relating to this request. This is usually HTTP/1.0. The protocol is
returned in the format name/version.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">SERVER_SOFTWARE</td><td width="" height="" colspan="1" rowspan="1">The name and version of the Web server answering the request.
The server information is returned in the format name/version.</td></tr><tr><td width="" height="" colspan="1" rowspan="1">URL</td><td width="" height="" colspan="1" rowspan="1">Gives the base portion of the URL. Parameter values will not be
included. The value is determined when the Web server parses the
URL from the header.</td></tr></table><h6><b>Remarks</b></h6><p>The file containing this directive must use a file name
extension that is mapped to the SSI interpreter; otherwise, the Web
server will not process the directive. By default, the file name
extensions .stm, .shtm, and .shtml are mapped to the SSI
interpreter (ssinc.dll).</p><p>An STM page using the #echo directive must be run by itself, or
by calling it from an ASP page with Response.Redirect. Calling an
STM page from an ASP page with Server.Transfer, Server.Execute, or
#include will not work because that would force the STM page to go
through asp.dll instead of through ssinc.dll.</p><p>If you have the <a href="gs_iissnapin.htm"><b>IIS snap-in</b></a>
installed, you can modify default extension mappings and add new
mappings; see <a href="ca_settappmappings.htm"><b>Setting Application Mappings</b></a>. Since you cannot map a file extension to more than
one executable, you cannot use this directive in ASP files. ASP
files are already mapped to the asp.dll and must stay that way.</p><h6><b>Example</b></h6><p>This example uses the #echo directive to insert a URL into the
ACTION value of a FORM statement.</p><p>--- Echo.asp ---</p><pre>
&lt;FORM NAME="RunEcho" METHOD="POST" ACTION="Echo.asp"&gt;
&lt;INPUT TYPE="SUBMIT" VALUE="Run the #echo Directive" NAME="RunEcho"&gt;
&lt;/FORM&gt;
&lt;%
If Len(Request.Form("RunEcho")) Then
  Response.Redirect("Echo.stm?Echo.asp")
End If
%&gt;
</pre><p>--- Echo.stm ---</p><pre>
&lt;H3&gt;Inside Echo.stm&lt;/H3&gt;
AUTH_TYPE is &lt;!-- #echo var="AUTH_TYPE"--&gt;&lt;BR&gt;
&lt;FORM NAME="Return" METHOD="POST" ACTION="&lt;!-- #echo var="QUERY_STRING"--&gt;"&gt;
&lt;INPUT TYPE="SUBMIT" VALUE="Return to Previous Page" NAME="Return"&gt;
&lt;/FORM&gt;
</pre><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
