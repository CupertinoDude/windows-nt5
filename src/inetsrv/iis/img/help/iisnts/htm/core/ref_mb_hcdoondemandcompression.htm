<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="HcDoOnDemandCompression">
<meta name="description" content="This metabase property specifies whether static files, such as .htm and .txt files, will be compressed if no compressed version of the file exists in the directory specified by HcCompressionDirectory.">
<title>HcDoOnDemandCompression</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>HcDoOnDemandCompression</h3><div><p>This metabase property specifies whether static files, such as
.htm and .txt files, will be compressed if no compressed version of
the file exists in the directory specified by <a href="ref_mb_HcCompressionDirectory.htm"><b>HcCompressionDirectory</b></a>.</p><p>At a global level, if this property is set to TRUE, and IIS
receives a request for static content, IIS will check the
compression directory. If no corresponding compressed version of
the requested file is found, IIS will send an <i>uncompressed</i>
version of the requested file to the client browser while a
background thread compresses the file. The newly compressed file
will then be stored in the compression directory, and subsequent
responses to requests for that file will be serviced directly from
the directory.</p><p>If <b>HcDoOnDemandCompression</b> is set to FALSE at a global
level, however, IIS will not compress static content files for
which it finds no corresponding compressed version in the
compression directory. In other words, an uncompressed version of
the file will be returned for every request, unless a compressed
version of the file already exists in the compression
directory.</p><p>At an individual compression scheme level, <b>
HcDoOnDemandCompression</b> indicates whether that particular
compression scheme supports on-demand compression.</p><p>Because <b>HcDoOnDemandCompression</b> is not inheritable, in
order for static on-demand compression to actually be enabled for a
server, <b>HcDoOnDemandCompression</b> must be set to TRUE at both
the global and individual scheme level.</p><p>If you change the value of this property at the individual
compression scheme level, the Web service will need to be restarted
for the change to take effect.</p></div><table width="100%" height=""><tr><td width="166" height="" colspan="1" rowspan="1"></td><td width="" height="" colspan="1" rowspan="1"></td></tr><tr><td width="166" height="" colspan="1" rowspan="1"><b>Attribute Name</b></td><td width="" height="" colspan="1" rowspan="1"><b>Attribute Value</b></td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Data Type</td><td width="" height="" colspan="1" rowspan="1">BOOL</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Attributes</td><td width="" height="" colspan="1" rowspan="1">NO_ATTRIBUTES</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">Default Value</td><td width="" height="" colspan="1" rowspan="1">TRUE</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">MetaFlagsEx</td><td width="" height="" colspan="1" rowspan="1">CACHE_PROPERTY_MODIFIED</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">User Type</td><td width="" height="" colspan="1" rowspan="1">IIS_MD_UT_SERVER</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">StartingNumber</td><td width="" height="" colspan="1" rowspan="1"></td></tr><tr><td width="166" height="" colspan="1" rowspan="1">EndingNumber</td><td width="" height="" colspan="1" rowspan="1">0</td></tr><tr><td width="166" height="" colspan="1" rowspan="1">ID</td><td width="" height="" colspan="1" rowspan="1">2215</td></tr></table><div><h3>Access Locations</h3><p>This property is accessible at the following locations:</p><table width="566" height=""><tr><td width="536" height="" colspan="2" rowspan="1"><div></div></td></tr><tr><td width="220" height="" colspan="1" rowspan="1"><b>Metabase Path</b></td><td width="316" height="" colspan="1" rowspan="1"><b>IIS Admin Object Type</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/Filters/Compression/gzip</td><td width="" height="" colspan="1" rowspan="1">IIsCompressionScheme</td></tr><tr><td width="" height="" colspan="1" rowspan="1">/LM/W3SVC/Filters/Compression/Parameters</td><td width="" height="" colspan="1" rowspan="1">IIsCompressionSchemes</td></tr></table></div><h3>IIS Admin Base Object Information</h3><p>The following table lists additional information required only
for code that uses the IIS Admin Base Object.</p><table width="567" height=""><tr><td width="536" height="" colspan="2" rowspan="1"><div></div></td></tr><tr><td width="221" height="" colspan="1" rowspan="1">Metabase identifier</td><td width="316" height="" colspan="1" rowspan="1"><div>MD_HC_DO_ON_DEMAND_COMPRESSION</div></td></tr><tr><td width="221" height="" colspan="1" rowspan="1">Data type</td><td width="316" height="" colspan="1" rowspan="1">BOOL</td></tr><tr><td width="221" height="" colspan="1" rowspan="1">User type</td><td width="316" height="" colspan="1" rowspan="1">IIS_MD_UT_SERVER</td></tr></table><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
