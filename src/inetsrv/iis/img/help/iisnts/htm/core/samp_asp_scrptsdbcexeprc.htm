<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Executing_Stored_Procedures">
<meta name="description" content="Internet Information Services reference information">
<title>Executing Stored Procedures</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h2>Executing Stored Procedures</h2><h6>Overview</h6><p>Stored procedures, such as those provided by
Microsoft<sup>®</sup> SQL Server, are the keys to making large,
mission-critical database applications function smoothly and
efficiently. This example demonstrates how you can access this
functionality by using ADO from within an ASP script.</p><h6>Code Tour</h6><p>This script first creates an instance of the <b>Connection</b>
object and uses it to open an OLE DB connection with the sample
database, <i>pubs</i>. A special object, called a <b>Command</b>
object, is created next. The <b>Command</b> object's <b>
CommandText</b> property is set to the string of the command you
want to issue, which for this sample is the name of a stored
procedure, ByRoyalty. The <b>Command</b> object <b>Parameters</b>
property provides a collection of <b>Parameter</b> objects, and
this script uses the <b>Append</b> method to add a new parameter to
the collection.</p><p>Once <b>CreateParameter</b> has been used to name and configure
the parameter instance, the parameter name assigned can be used to
access the value of that parameter directly, as if the <b>
Command</b> object itself were a collection. Thus</p><pre><code>oCmd("@Percentage") = 75</code></pre><p>assigns the value <code>75</code> to the parameter that the
script has labeled as <code>@Percentage</code>. The <b>Command</b>
object's <b>Execute</b> method is invoked, and the resulting
recordset is assigned to the object variable <i>oRs</i> defined
earlier in the script. The first record of the resultant recordset
is displayed.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>SQL Server must be installed, and configured
properly, on the same machine on which IIS is running in order for
this sample to work correctly.</p>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
