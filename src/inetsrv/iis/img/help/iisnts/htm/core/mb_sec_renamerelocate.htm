<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Changing_the_Location_and/or_Name_of_MetaBase.xml">
<meta name="description" content="Procedure for changing the location and/or name of the MetaBase.xml file.">
<title>Changing the Location and/or Name of MetaBase.xml</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h1>Changing the Location and/or Name of MetaBase.xml</h1><p>This procedure illustrates how to change the default location of
the MetaBase.XML file and/or change the name of the file that IIS
looks for instead of the MetaBase.XML file when IIS starts.</p><ol><li>Stop the IISAdmin service. 

<p>From a command prompt window type the following command to stop
the IISAdmin service:</p><p><code>    net stop iisadmin /y</code></p><p>If you are creating a new location for the MetaBase.XML file
then go to step 2. Otherwise go to step 3.</p></li><li>If the folder that you want to store the metabse files in does
not already exist then create the folder. For security reasons it
is best to keep the folder used to store your metabase files
separate from your content files. 

<p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>It is recommended that you copy the
MetaBase.XML and MBSchema.XML files as well as the history folder
(found in <code>%windir%\system32\inetsrv\by default), as well as
the files within the history folder,</code> to the new folder.
Otherwise a default MetaBase.XML and blank MBSchema.XML file will
be created when IIS is restarted, and the history files will not be
available for edit while running.</p><p>If you are not renaming the MetaBase.XML file then go to step
4.</p></li><li>If you intend to rename the MetaBase.XML file, then you should
create a copy of the existing MetaBase.XML file and rename the copy
to the new name. If you do not create a file with the name that you
use in step 9 below, then a default metabase file will be created
when IIS is restarted.</li><li>Select <b>Run</b> from the <b>Start</b> Menu.</li><li>In the <b>Open</b> text box type <b>Regedit</b> and click <b>
OK.</b></li><li>Navigate to the
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetMGR\Parameters node.</li><li>Select the <b>Parameters</b> node, and select <b>New</b> and
then <b>String Value</b> from the <b>Edit</b> menu.</li><li>Type in <b>MetadataFile</b> for the Name and press <b>
Enter</b>. 

<p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>The name <b>MetadataFile</b> is case
sensitive.</p></li><li>Double click on the registry key name that you just created
(<b>MetadataFile</b>) and enter the location folder that wish to
store the metabase files in as well as the name of the file. <p>Example 1: If you want to store the metabase file in a folder
called metadata on drive d, you would type the following: <code>
d:\MetaData\MetaBase.XML</code><br>
 Example 2: You want to store the metabase file in a folder called
metadata on drive d and you have renamed the MetaBase.XML file to
MySecretFile.XML in step 3, you would type the following: <code>
d:\MetaData\MySecretFile.XML</code></p></li><li>Restart IIS.</li></ol><p><img src="note.gif" alt="note"><b>
      Note
      </b>Changes to the registry are not detected by
IIS until IIS is restarted.</p><p>From a command prompt window type the following command to
restart the IISAdmin service:</p><p><code>     net start iisadmin /y</code></p><p>From a command prompt window type the following command to
restart the World Wide Web Publishing service:</p><p><code>net start w3svc</code></p><p>Additionally, if have previously installed additional services
related to IIS such as the FTP Publishing service, Network News
Transport Protocol service, or the Simple Mail Transport Protocol
service, then these services must also be restarted. These services
can be restarted using the Windows Computer Management console or
from the command line. For information about starting services
using Computer Management console, search for "using services" in
the Windows XP online help.</p><p>From a command prompt window type the following command to
restart the FTP Publishing service:</p><p>net start msftpsvc</p><p>From a command prompt window type the following command to
restart the Simple Mail Transport Protocol service:</p><p>net start smptsvc</p><p>From a command prompt window type the following command to
restart the Network News Transport Protocol service:</p><p>net start nntpsvc</p><div><p><b>Related Topics</b></p><ul><li>it, search for the keyword <code>
"Regedit"</code> in the Windows online help.</li><li>For information about starting services using Computer
Management console, search for <code>"using services"</code> in the
Windows online help.</li></ul></div><div class="search-terms">phrase 1, phrase 2, phrase 3</div>
<hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
