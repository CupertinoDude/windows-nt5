<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="@TRANSACTION">
<meta name="description" content="@TRANSACTION Directive">
<title>@TRANSACTION</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h2>@TRANSACTION</h2><p>You can use the @TRANSACTION directive to indicate that the
script should be treated as a transaction. If a script is treated
as a transaction, Component Services will create a transaction to
coordinate the updating of resources.</p><h6>Syntax</h6><p>&lt;%@ TRANSACTION = <i>value</i> %&gt;</p><p> </p><h6>Parameters</h6><dl><dt><i>Value</i></dt><dd>A string that indicates the type of transaction support.
Possible values are: 

<table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>Value</b></td><td width="" height="" colspan="1" rowspan="1"><b>Meaning</b></td></tr><tr><td width="" height="" colspan="1" rowspan="1">Required</td><td width="" height="" colspan="1" rowspan="1">The script will initiate a transaction</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Requires_New</td><td width="" height="" colspan="1" rowspan="1">The script will initiate a transaction</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Supported</td><td width="" height="" colspan="1" rowspan="1">The script will not initiate a transaction</td></tr><tr><td width="" height="" colspan="1" rowspan="1">Not_Supported</td><td width="" height="" colspan="1" rowspan="1">The script will not initiate a transaction</td></tr></table><br></dd></dl><h6>Remarks</h6><p>If a script contains the @TRANSACTION directive, it must be the
very first line in the .asp file, otherwise an error is generated.
You must add the directive to each page that should be run under a
transaction. The current transaction ends when the script finishes
processing.</p><p>If the script containing the @TRANSACTION directive has been
called by either the <b>Server.Transfer</b> or <b>
Server.Execute</b> method, and the value is specified as Required
the script will continue the transaction of the calling asp if the
calling asp was transacted. If the calling asp was not transacted,
the called asp will create a new transaction.</p><p>For example, the following two scripts would be considered one
transaction.</p><p>ASP</p><pre><code>&lt;%@ TRANSACTION=Required %&gt;
&lt;%
  Server.Transfer("/asp/asp2.asp")
%&gt;
ASP2
&lt;%@ TRANSACTION=Required%&gt;
&lt;%
  Server.CreateObject("Mytransactedcomponent.Closeout")
%&gt;
</code></pre><h6>See Also</h6><p><a href="ref_vbom_obco.htm"><b>ObjectContext Object</b></a></p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
