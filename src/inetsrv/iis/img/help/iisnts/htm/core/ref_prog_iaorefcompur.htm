<html xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:myScript="http://iisue">
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-16">
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;<http://www.rsac.org/ratingsv01.html>&quot; l comment &quot;RSACi North America Server&quot; by &quot;inet@microsoft.com <mailto:inet@microsoft.com>&quot; r (n 0 s 0 v 0 l 0))">
<meta name="MS.LOCALE" content="EN-US">
<meta name="MS-IT-LOC" content="Internet Information Services">
<meta name="MS-HAID" content="Restore">
<meta name="description" content="Internet Information Services reference information">
<title>Restore</title><SCRIPT LANGUAGE="JScript" SRC="iishelp.js"></SCRIPT></head>
<body>
<p style="color:red">[This is preliminary documentation and subject to change]</p>
<h3>Restore</h3><p>You can use the <b>Restore</b> method of the <a href="ref_prog_iaorefcompu.htm"><b>IIsComputer</b></a> object to
restore the metabase from a backup. The restore operation stops all
services dependent on IISADMIN, including all servers, until the
restore has completed, then restarts all services. Because of this,
if you are restoring the metabase by using a script in an ASP page,
you must specify a machine name other than the one on which your
script is executing. You cannot use LocalHost as the machine name.
You should be careful to plan for this service interruption when
restoring the metabase from a backup.</p><h6>Syntax</h6><p><b>IIsComputer</b>.<b>Restore</b><i>BackupLocation</i>, <i>
BackupVersion</i>, <i>BackupFlags</i></p><p> </p><h6>Parameters</h6><dl><dt><i>BackupLocation</i></dt><dd>A string of up to 100 characters that specifies the backup
location. If an empty string is specified, the backup will be
retrieved from the default location.<br></dd><dt><i>BackupVersion</i></dt><dd>Specifies the version number of the backup to be restored from
the backup location, or can be the following constant. 

<table width="" height=""><tr><td width="" height="" colspan="1" rowspan="1"><b>MD_BACKUP_HIGHEST_VERSION</b></td><td width="" height="" colspan="1" rowspan="1">Restore from the highest existing backup version in the
specified backup location.</td></tr></table></dd><dt><i>BackupFlags</i></dt><dd>Reserved. Must be zero.</dd></dl><h6>Code Example</h6><pre><code>&lt;% 
  Dim ComputerObj, ComputerName 
  'Restore metabase on a different computer. 
  ComputerName = "MyOtherComputer"
  'You can use LocalHost if running under Windows Script Host. 
  Set ComputerObj = GetObject("IIS://" &amp; ComputerName) 
  'Restore the highest number version in MyBackups. 
  ComputerObj.Restore "MyBackups", MD_BACKUP_HIGHEST_VERSION, 0 
%&gt; 
</code></pre><h6>Remarks</h6><p>You can use the <b>Restore</b> method with LocalHost in scripts
running in a command window by using Cscript.exe. For more
information, see the Windows Script Host material in the Windows
documentation.</p><p><img src="important.gif" alt="important"><span style="color:blue;"><b>
     Important
      </b></span>The metabase backup and restore functionality
exists for versioning purposes, not for cross-machine replication.
However, you are not necessarily restricted to restoring the
computer from which you initiate the process. For more information
about restoring from a back up, see "Restoring the Metabase" in the
IIS product documentation.</p>
<h6>See Also</h6><p><a href="ref_prog_iaorefcompub.htm"><b>Backup</b></a>, <a href="ref_prog_iaorefcompue.htm"><b>EnumBackups</b></a>, <a href="ref_prog_iaorefcompud.htm"><b>DeleteBackup</b></a></p><hr class="iis" size="1">
<p align="center"><i><a href="/iishelp/common/colegal.htm">© 1997-2001 Microsoft Corporation. All rights reserved.</a></i></p>
</body>
</html>
