<html dir=ltr><head><title>IIS Administration Script Utility (adsutil)</title>

<SCRIPT LANGUAGE="JavaScript">
<!--
	TempString = navigator.appVersion
	if (navigator.appName == "Microsoft Internet Explorer"){	
// Check to see if browser is Microsoft
		if (TempString.indexOf ("4.") >= 0){
// Check to see if it is IE 4
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
		}
		else {
			document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
		}
	}
	else if (navigator.appName == "Netscape") {						
// Check to see if browser is Netscape
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/coua.css">');
	}
	else
		document.writeln('<link rel="stylesheet" type="text/css" href="/iishelp/common/cocss.css">');
//-->
</script> 

<SCRIPT LANGUAGE="VBScript">
<!--
Sub Window_OnLoad()
   Dim frmContents
   On Error Resume Next
   If Not Parent Is Nothing Then
      Set frmContents = Parent.Contents
      If Not frmContents Is Nothing Then
            frmContents.Window.TOCSynch_Click
      End If
   End If
End Sub
//--></SCRIPT>

<meta name="description" content="This topic contains conceptual and procedural information about the IIS Administration Script Utility (adsutil).">

<META HTTP-EQUIV="Content-Type" content="text/html; charset=Windows-1252">

<META HTTP-EQUIV="PICS-Label" CONTENT='(PICS-1.1 "<http://www.rsac.org/ratingsv01.html>" l comment "RSACi North America Server" by "inet@microsoft.com <mailto:inet@microsoft.com>" r (n 0 s 0 v 0 l 0))'>
<META NAME="MS.LOCALE" CONTENT="EN-US">
<META NAME="MS-IT-LOC" Content="Internet Information Services">

</head>

<body bgcolor="#FFFFFF" text="#000000">
<font face="Verdana,Arial,Helvetica">

<h1 align="left">IIS Administration Script Utility (adsutil)</h1>

<p><STRONG>Summary:</STRONG></p>

<p>This is an IIS administration utility that uses VBScript with Active Directory Service Interfaces (ADSI) to manipulate the IIS configuration. This script should be run using CScript, which is installed with Windows Script Host.</p>

<p><STRONG>Usage:</STRONG></p>
 
<p>Cscript.exe adsutil.vbs COMMAND &lt;path&gt; [&lt;param&gt;...]</p>
<p>Cscript.exe adsutil.vbs COMMAND [&lt;path&gt; [&lt;parameters&gt;...]]</p>
<p><strong>Commands:</strong></p>

<table cellspacing="2" cellpadding="5">

<tr>
	<td>GET <em> Path</em></td>
	<td>Display chosen parameter.</td>
</tr>

<tr>
    <td>SET <em>Path Value</em></td>
    <td>Assign a new value.</td>
</tr>

<tr>
	<td valign="TOP">ENUM <em>path &quot;/P&quot; </em></td>
	<td>Enumerate all parameters for the path.<br>
		/P - Enumerate the paths only (no data).</td>
</tr>

<tr>
	<td valign="TOP">ENUM_ALL <em>&quot;/P&quot; </em></td>
	<td>Enumerate all parameters.<br>
		/P - Enumerate the paths only (no data).</td>
</tr>

<tr>
    <td>DELETE <em>path</em></td>
    <td>Delete the path or parameter.</td>
</tr>

<tr>
    <td valign="TOP">CREATE <em>path [KeyType]</em></td>
    <td>Create the path and assign it the KeyType.</td>
</tr>

<tr>
    <td>APPCREATEINPROC <em>Path</em></td>
    <td>Create an in-process application.</td>
</tr>

<tr>
    <td valign="TOP">APPCREATEOUTPROC <em>Path</em></td>
    <td>Create an out-of-process application.</td>
</tr>

<tr>
    <td>APPDELETE <em>Path</em></td>
    <td>Delete the application (if present).</td>
</tr>

<tr>
    <td>APPUNLOAD <em>Path</em></td>
    <td>Unload an out-of-process application.</td>
</tr>

<tr>
    <td>APPGETSTATUS <em>Path</em></td>
    <td>Get status of the application.</td>
</tr>

<tr>
    <td valign="TOP">FIND <em>Path</em></td>
    <td>Find the paths where a parameter is set.</td>
</tr>

<tr>
    <td valign="TOP">START_SERVER <em>Path</em></td>
    <td>Starts the server.</td>
</tr>

<tr>
    <td>STOP_SERVER <em>Path</em></td>
    <td>Stop the Web site.</td>
</tr>

<tr>
    <td>PAUSE_SERVER <em>Path</em></td>
    <td>Pause the Web site.</td>
</tr>

<tr>
    <td>CONTINUE_SERVER <em>Path</em></td>
    <td>Unpauses the Web site.</td>
</tr>

<tr>
    <td>HELP</td>
    <td>Prints all available commands.</td>
</tr>

</table>

<p><strong>Notes</strong></p>

<ul>
<li><EM>&lt;Path&gt;</EM> is the path of the node at which you are setting the property combined with the name of the property you are setting. For example, if you want to set the ServerComment for Web server number 1, the command would be as follows:</li>

<p><em><strong>adsutil SET w3svc/1/ServerComment &quot;Web Server Number 1&quot;</strong></em></p>

<p>The next time the IIS snap-in is opened, it will reflect the name of the Web server as &quot;Web Server Number 1&quot;</p>

<li>The switch "-s:<em>server name</em>" can be used after any command to execute the command on a remote computer. (See first example below.)</li>
</ul>

<p><strong>Examples:</strong></p>

<p>Cscript.exe adsutil.vbs GET W3SVC/1/ServerBindings -s:remotecomputer1</p>

<p>Cscript.exe adsutil.vbs SET W3SVC/1/ServerBindings &quot;:81:&quot;</p>

<p>Cscript.exe adsutil.vbs CREATE W3SVC/1/Root/MyVdir &quot;IIsWebVirtualDir&quot;</p>

<p>Cscript.exe adsutil.vbs START_SERVER W3SVC/1&nbsp;</p>

<p>Cscript.exe adsutil.vbs ENUM /P W3SVC</p>

<hr class="iis" size="1">
<p align="center"><em><a href="/iishelp/common/colegal.htm">&copy; 1997-2001 Microsoft Corporation. All rights reserved.</a></em></p>

</font>
</body>
</html>
