<HTML>
<HEAD>
<style>
<!--  body       { font-family: Verdana, Arial; font-size: 75%; }
      p.cluster  { margin-top: 1em; margin-bottom: 0em; margin-left: 0em; }
      p.resource { margin-top: 1em; margin-bottom: 0em; margin-left: 5em; }
      p.property { margin-top: 0em; margin-bottom: 0em; margin-left: 10em; }
      p.info     { margin-top: 0em; margin-bottom: 0em; margin-left: 15em; } -->
</style>

<TITLE> Cluster Physical Disk Resource Properties</TITLE>

	<SCRIPT LANGUAGE="VBSCRIPT">
	<!--

		Option Explicit
		'On Error Resume Next

		Dim oCluster
		Dim sCluster
		Dim oPhysDisk
		Dim oPartition
		Dim oDisk
		Dim sDisk
		Dim oScsi
		Dim oResType
		Dim oKey

		Set oCluster = CreateObject("MSCluster.Cluster")
		sCluster = InputBox( "Cluster to open?" )
		oCluster.Open( sCluster )

		Document.Write "<B><p class=cluster>Cluster name is " & oCluster.Name & "</B><BR>"

		sDisk = InputBox( "Physical disk resource name?" )
		set oPhysDisk = oCluster.Resources( sDisk )
		Document.Write "<B><p class=resource>Disk name is " & oPhysDisk.Name & "</B><BR>"

		set oDisk = oPhysDisk.Disk
		set oScsi = oDisk.ScsiAddress
		Document.Write "<B><p class=property>SCSI port number is " & oScsi.PortNumber & "</B><BR>"
		Document.Write "<B><p class=property>SCSI path id is " & oScsi.PathId & "</B><BR>"
		Document.Write "<B><p class=property>SCSI target id is " & oScsi.Targetid & "</B><BR>"
		Document.Write "<B><p class=property>SCSI Lun is " & oScsi.Lun & "</B><BR>"

		for each oPartition in oDisk.Partitions
			Document.Write "<B><p class=property>Disk " & oPartition.DeviceName & " is " & oPartition.FileSystem & "</B><BR>"
		next

		set oResType = oCluster.ResourceTypes.Item("Physical Disk")
		Document.Write "<B><p class=resource>resource type is " & oResType.Name & "</B><BR>"

		for each oDisk in oResType.AvailableDisks
			for each oPartition in oDisk.Partitions
				Document.Write "<B><p class=property>Disk " & oPartition.DeviceName & " is " & oPartition.FileSystem & "</B><BR>"
			next

			for each oKey in oResType.RegistryKeys
				Document.Write "<p class=property>Registry key is " & oKey & "<BR>"
			next

			for each oKey in oResType.CryptoKeys
				Document.Write "<p class=property>Crypto key is " & oKey & "<BR>"
			next
		next

	-->
	</SCRIPT>
</HEAD>

<BODY>

</BODY>

</HTML>

