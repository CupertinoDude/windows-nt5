//////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2000 Microsoft Corporation
//
//  Module Name:
//      CTaskUpgradeWhistler.h
//
//  Description:
//      This file contains the declaration of the class CTaskUpgradeWhistler.
//      This class represents the task of upgrading the cluster service on
//      a node that had Windows 2000 installed on it.
//
//  Implementation Files:
//      CTaskUpgradeWhistler.cpp
//
//  Maintained By:
//      Vij Vasu (Vvasu) 26-JUL-2000
//
//////////////////////////////////////////////////////////////////////////////

#pragma once

//////////////////////////////////////////////////////////////////////////////
// Include Files
//////////////////////////////////////////////////////////////////////////////

// For the base class
#include "CTaskUpgrade.h"


//////////////////////////////////////////////////////////////////////////////
// Forward Declarations
//////////////////////////////////////////////////////////////////////////////
class CClusOCMApp;


//////////////////////////////////////////////////////////////////////////////
//++
//
//  class CTaskUpgradeWhistler
//
//  Description:
//      This class represents the task of upgrading the cluster service on
//      a node that had Windows 2000 installed on it.
//
//--
//////////////////////////////////////////////////////////////////////////////
class CTaskUpgradeWhistler : public CTaskUpgrade
{
public:
    //////////////////////////////////////////////////////////////////////////
    // Public constructors and destructors
    //////////////////////////////////////////////////////////////////////////

    // Constructor.
    CTaskUpgradeWhistler( const CClusOCMApp & rAppIn );

    // Destructor
    virtual ~CTaskUpgradeWhistler( void );


    //////////////////////////////////////////////////////////////////////////
    // Message handlers
    //////////////////////////////////////////////////////////////////////////

    // Handler for the OC_QUEUE_FILE_OPS message.
    virtual DWORD
        DwOcQueueFileOps( HSPFILEQ hSetupFileQueueIn );

    // Handler for the OC_COMPLETE_INSTALLATION message.
    virtual DWORD
        DwOcCompleteInstallation( void );

    // Handler for the OC_CLEANUP message.
    virtual DWORD
        DwOcCleanup( void );


protected:
    //////////////////////////////////////////////////////////////////////////
    // Protected methods
    //////////////////////////////////////////////////////////////////////////

    // Map ids specified in the INF file to actual directories.
    DWORD DwSetDirectoryIds( void );


private:
    //////////////////////////////////////////////////////////////////////////
    // Private types
    //////////////////////////////////////////////////////////////////////////
    typedef CTaskUpgrade BaseClass;

}; //*** class CTaskUpgradeWhistler
