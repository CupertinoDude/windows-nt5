/*++

Copyright (C) Microsoft Corporation, 2001

Module Name:

    data.c

Abstract:

    data of allowed commands

Environment:

    kernel mode only

Notes:

Revision History:

--*/
#include "filter.h"

#ifdef ALLOC_DATA_PRAGMA
#pragma data_seg("PAGE")
#endif

/*
--------------------------------------------------------------------------------
Windows 2000 CLASSPNP.SYS (common)
================================================================================

SCSIOP_TEST_UNIT_READY          0x00
SCSIOP_RESERVE_UNIT             0x16
SCSIOP_RELEASE_UNIT             0x17
SCSIOP_MODE_SENSE               0x1A
SCSIOP_START_STOP_UNIT          0x1B
SCSIOP_MEDIUM_REMOVAL           0x1E
SCSIOP_READ_CAPACITY            0x25
SCSIOP_READ                     0x28
SCSIOP_WRITE                    0x2A
--------------------------------------------------------------------------------
*/
BOOLEAN const AllowedCommandsW2kClasspnp[0x100] = {
    1,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,0,0, 0,0,1,1, 0,0,1,1, 0,0,1,0,   // 0x10 - 0x1f
    0,0,0,0, 0,1,0,0, 1,0,1,0, 0,0,0,0,   // 0x20 - 0x2f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x40 - 0x4f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};

/*
--------------------------------------------------------------------------------
Windows 2000 CDROM.SYS (Device Type 5)
================================================================================

SCSIOP_TEST_UNIT_READY          0x00
SCSIOP_MODE_SELECT              0x15
SCSIOP_RESERVE_UNIT             0x16
SCSIOP_RELEASE_UNIT             0x17
SCSIOP_MODE_SENSE               0x1A
SCSIOP_START_STOP_UNIT          0x1B
SCSIOP_MEDIUM_REMOVAL           0x1E
SCSIOP_READ_CAPACITY            0x25
SCSIOP_READ                     0x28
SCSIOP_SEEK                     0x2B
SCSIOP_READ_SUB_CHANNEL         0x42
SCSIOP_READ_TOC                 0x43
SCSIOP_PLAY_AUDIO_MSF           0x47
SCSIOP_PAUSE_RESUME             0x4B
SCSIOP_MODE_SELECT10            0x55
SCSIOP_MODE_SENSE10             0x5A
SCSIOP_SEND_KEY                 0xA3
SCSIOP_REPORT_KEY               0xA4
SCSIOP_SET_READ_AHEAD           0xA7
SCSIOP_READ_DVD_STRUCTURE       0xAD
SCSIOP_READ_CD                  0xBE
--------------------------------------------------------------------------------
*/

BOOLEAN const AllowedCommandsW2kCdrom[0x100] = {
    1,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,0,0, 0,1,1,1, 0,0,1,1, 0,0,1,0,   // 0x10 - 0x1f
    0,0,0,0, 0,1,0,0, 1,0,0,1, 0,0,0,0,   // 0x20 - 0x2f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,1,1, 0,0,0,1, 0,0,0,1, 0,0,0,0,   // 0x40 - 0x4f
    0,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,0,0,1, 1,0,0,1, 0,0,0,0, 0,1,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,1,0,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};

/*
--------------------------------------------------------------------------------
Windows 2000 DISK.SYS (Device Type 0)
================================================================================

SCSIOP_TEST_UNIT_READY          0x00
SCSIOP_REASSIGN_BLOCKS          0x07
SCSIOP_MODE_SELECT              0x15
SCSIOP_RESERVE_UNIT             0x16
SCSIOP_RELEASE_UNIT             0x17
SCSIOP_MODE_SENSE               0x1A
SCSIOP_START_STOP_UNIT          0x1B
SCSIOP_MEDIUM_REMOVAL           0x1E
SCSIOP_READ_CAPACITY            0x25
SCSIOP_READ                     0x28
SCSIOP_WRITE                    0x2A
SCSIOP_VERIFY                   0x2F
SCSIOP_SYNCHRONIZE_CACHE        0x35
--------------------------------------------------------------------------------
*/

BOOLEAN const AllowedCommandsW2kDisk[0x100] = {
    1,0,0,0, 0,0,0,1, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,0,0, 0,1,1,1, 0,0,1,1, 0,0,1,0,   // 0x10 - 0x1f
    0,0,0,0, 0,1,0,0, 1,0,1,0, 0,0,0,1,   // 0x20 - 0x2f
    0,0,0,0, 0,1,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x40 - 0x4f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};

/*
--------------------------------------------------------------------------------
Windows 2000 SFLOPPY.SYS (SCSI Floppy)
================================================================================

SCSIOP_TEST_UNIT_READY          0x00
SCSIOP_FORMAT_UNIT              0x04
SCSIOP_MODE_SELECT              0x15
SCSIOP_RESERVE_UNIT             0x16
SCSIOP_RELEASE_UNIT             0x17
SCSIOP_MODE_SENSE               0x1A
SCSIOP_START_STOP_UNIT          0x1B
SCSIOP_MEDIUM_REMOVAL           0x1E
SCSIOP_READ_FORMATTED_CAPACITY  0x23
SCSIOP_READ_CAPACITY            0x25
SCSIOP_READ                     0x28
SCSIOP_WRITE                    0x2A
SCSIOP_VERIFY                   0x2F
--------------------------------------------------------------------------------
*/

BOOLEAN const AllowedCommandsW2kSfloppy[0x100] = {
    1,0,0,0, 1,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,0,0, 0,1,1,1, 0,0,1,1, 0,0,1,0,   // 0x10 - 0x1f
    0,0,0,1, 0,1,0,0, 1,0,1,0, 0,0,0,1,   // 0x20 - 0x2f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x40 - 0x4f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};

/*
--------------------------------------------------------------------------------
My current list of allowed commands:
================================================================================

SCSIOP_TEST_UNIT_READY          0x00
SCSIOP_REQUEST_SENSE            0x03
SCSIOP_FORMAT_UNIT              0x04
SCSIOP_INQUIRY                  0x12
SCSIOP_MODE_SELECT              0x15
SCSIOP_MODE_SENSE               0x1A
SCSIOP_START_STOP_UNIT          0x1B
SCSIOP_MEDIUM_REMOVAL           0x1E
SCSIOP_READ_CAPACITY            0x25
SCSIOP_READ                     0x28
SCSIOP_WRITE                    0x2A
SCSIOP_VERIFY                   0x2F
SCSIOP_SYNCHRONIZE_CACHE        0x35
SCSIOP_READ_TOC                 0x43
SCSIOP_MODE_SELECT10            0x55
SCSIOP_MODE_SENSE10             0x5A
SCSIOP_READ_CD                  0xBE
--------------------------------------------------------------------------------
*/
BOOLEAN const AllowedCommands51Cdrom[0x100] = {
    1,0,0,1, 1,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,1,0, 0,1,0,0, 0,0,1,1, 0,0,1,0,   // 0x10 - 0x1f
    0,0,0,0, 0,1,0,0, 1,0,1,0, 0,0,0,1,   // 0x20 - 0x2f
    0,0,0,0, 0,1,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,0,1, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x40 - 0x4f
    0,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,1,0,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};

/*
--------------------------------------------------------------------------------
Burning commands:
================================================================================
SCSIOP_READ_DISK_INFORMATION    0x51
SCSIOP_READ_TRACK_INFORMATION   0x52
SCSIOP_RESERVE_TRACK_RZONE      0x53
SCSIOP_SEND_OPC_INFORMATION     0x54  // optimum power calibration
SCSIOP_CLOSE_TRACK_SESSION      0x5B
SCSIOP_READ_BUFFER_CAPACITY     0x5C
SCSIOP_SEND_CUE_SHEET           0x5D
SCSIOP_BLANK                    0xA1
SCSIOP_SET_CD_SPEED             0xBB
--------------------------------------------------------------------------------
*/
BOOLEAN const AllowedCommandsAddBurning[0x100] = {
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x10 - 0x1f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x20 - 0x2f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x40 - 0x4f
    0,1,1,1, 1,0,0,0, 0,0,0,1, 1,1,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,1,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,1, 0,0,0,0,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};


/*
--------------------------------------------------------------------------------
Extended CD Support:
================================================================================
SCSIOP_GET_CONFIGURATION        0x46
SCSIOP_GET_EVENT_STATUS         0x4A
--------------------------------------------------------------------------------
*/
BOOLEAN const AllowedCommandsAddExtendedCdrom[0x100] = {
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x10 - 0x1f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x20 - 0x2f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,0,0, 0,0,1,0, 0,0,1,0, 0,0,0,0,   // 0x40 - 0x4f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};

/*
--------------------------------------------------------------------------------
DVD Support:
================================================================================
SCSIOP_SEND_KEY                 0xA3
SCSIOP_REPORT_KEY               0xA4
SCSIOP_SET_READ_AHEAD           0xA7
SCSIOP_READ_DVD_STRUCTURE       0xAD
SCSIOP_SEND_DVD_STRUCTURE       0xBF
--------------------------------------------------------------------------------
*/
BOOLEAN const AllowedCommandsAddDVDSupport[0x100] = {
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x00 - 0x0f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x10 - 0x1f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x20 - 0x2f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x30 - 0x3f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x40 - 0x4f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x50 - 0x5f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x60 - 0x6f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x70 - 0x7f
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x80 - 0x8f
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0x90 - 0x9f
    0,0,0,1, 1,0,0,1, 0,0,0,0, 0,1,0,0,   // 0xa0 - 0xaf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,1,   // 0xb0 - 0xbf
    
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xc0 - 0xcf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xd0 - 0xdf
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0,   // 0xe0 - 0xef
    0,0,0,0, 0,0,0,0, 0,0,0,0, 0,0,0,0    // 0xf0 - 0xff
};



#ifdef ALLOC_DATA_PRAGMA
#pragma data_seg()
#endif

