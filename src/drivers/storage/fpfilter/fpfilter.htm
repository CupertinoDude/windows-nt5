

<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-
1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>FPFilter
</TITLE>
</HEAD>
<BODY LINK="#0000ff">

<FONT FACE="Verdana" SIZE=5><H2>FPFilter
</H2>
</FONT><FONT FACE="Verdana" SIZE=2>
<P><span style="color:#FF0000;font-size:10pt;font-family:Arial">[This is preliminary 
documentation and subject to change.]</span></P>

<H3>SUMMARY</H3></FONT><FONT FACE="Verdana" SIZE=2><P>
FPFilter is a sample disk filter driver that demonstrates how a disk
failure prediction filter driver could be implemented. A failure prediction
filter driver can predict when a disk may fail and notify the disk driver stack
of this condition. The disk driver stack will then alert the operating system to the
condition. A failure prediction filter driver can use proprietary hardware requests
and/or software algorithms to predict disk failure.<p>
<H3>BUILDING THE SAMPLE</H3></FONT><FONT FACE="Verdana" 
SIZE=2><P>


Follow these steps to WMI-enable a driver with the sample code:<p>
1.
Determine the algorithm to use to predict disk failure.
Add code for this in the <b>FpFilterDeviceControl</b> routine where it handles the
IOCTL_STORAGE_FAILURE_PREDICTION I/O control (IOCTL). <o:p></o:p></span></p>
2.

Disk drives that are implemented to the ATAPI SMART specification or the
SCSI Informational Exceptions specification already have failure prediction support
built into the disk driver stack. The filter driver can forward the IOCTL to
the next device on its stack and examine the returned information to determine
if the disk driver stack is reporting failure.<o:p></o:p></span></p>
3.

Enter
the checked or free build environment. Then, while in the Fpfilter sample
directory, type <b>build</b>. A successful build produces the binary Fpfilter.sys.<o:p></o:p></span></p>
4.

To install the failure
prediction filter driver for a specific disk, first install the filter driver using the Add Hardware Wizard.  This will install Fpfilter.inf.
Then use the AddFilter tool to include the failure prediction filter driver as an
upper filter on a specific physical disk.

<H3>RESOURCES</H3></FONT><FONT FACE="Verdana" SIZE=2><P>
Please see the <i>Kernel-Mode Drivers</i> section of Microsoft&reg;&nbsp;Windows&reg;&nbsp;
2000 DDK documentation for more information.
<H3>CODE TOUR</H3>
<H4>File Manifest</H4>
</FONT><U><PRE>File&#9;&#9;Description
</U>
Fpfilter.c&#9;Failure prediction filter driver code.
Fpfilter.rc&#9;Resource file containing version information.
Fpfilter.inf&#9;INF file used to install the filter driver service.
Makefile&#9;Standard Microsoft&reg; Windows NT&reg;/Windows&reg;&nbsp;2000 makefile.
Sources&#9;	Sources for build.




</FONT><P ALIGN="CENTER"><A HREF="#top"><FONT FACE="Verdana" SIZE=2>Top of 
page</FONT></A><FONT FACE="Verdana" SIZE=2> </P></FONT>
<TABLE CELLSPACING=0 BORDER=0 WIDTH=624>
<TR><TD VALIGN="MIDDLE" BGCOLOR="#00ffff" HEIGHT=2>
<P></TD>
</TR>
</TABLE>

<FONT FACE="MS Sans Serif" SIZE=1><P>&copy; Microsoft Corporation 1999</FONT><FONT 
FACE="Verdana" SIZE=2> </P></FONT></BODY>


