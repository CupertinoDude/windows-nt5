; Copyright (c) 1998 - 1999 Microsoft Corporation

#if defined(_PER_SKU_)
#define GotSkuDef
; this is PER
#endif

#if defined(_PRO_SKU_)
    #if defined(GotSkuDef)
    #error "multiple sku's defined"
    #endif
; this is PRO
#define GotSkuDef
#endif

#if defined(_SRV_SKU_)
    #if defined(GotSkuDef)
    #error "multiple sku's defined"
    #endif
; this is SRV
#define GotSkuDef
#endif

#if defined(_ADS_SKU_)
    #if defined(GotSkuDef)
    #error "multiple sku's defined"
    #endif
; this is ADS
#define GotSkuDef
#endif

#if defined(_DTC_SKU_)
    #if defined(GotSkuDef)
    #error "multiple sku's defined"
    #endif
; this is DTC
#define GotSkuDef
#endif

#ifndef  GotSkuDef
    #error "no skus defined"
#endif



;-------------------------------------------------------------------------------
; Terminal Services Setup File
;
;-------------------------------------------------------------------------------

[Version]
Signature= "$Windows NT$"
LayoutFile=layout.inf


;-------------------------------------------------------------------------------
; Terminal Services Optional Subcomponents
;
;-------------------------------------------------------------------------------

[Optional Components]
TerminalServer
#ifndef _PER_SKU_
TSWebClient
#endif

[TSWebClient]
Parent = IIS_WWW_Parent
Needs = IIS_WWW
;Modes = 0,1,3
IconIndex = *
OptionDesc = %TS_WEBCLIENT_DESC%
Tip = %TS_WEBCLIENT_TIP%



;-------------------------------------------------------------------------------
; TerminalServices Core Component
;
;-------------------------------------------------------------------------------

[TerminalServices]

UpgradeFrom40Section.server.x86 = TerminalServices.UpgradeFrom40.server.x86
UpgradeFrom50Section.server.x86 = TerminalServices.UpgradeFrom50.server.x86
UpgradeFrom51Section.server.x86 = TerminalServices.UpgradeFrom51.server.x86
FreshInstallSection.server.x86  = TerminalServices.FreshInstall.server.x86

UpgradeFrom40Section.server.ia64 = TerminalServices.DoNothing
UpgradeFrom50Section.server.ia64 = TerminalServices.UpgradeFrom50.server.ia64
UpgradeFrom51Section.server.ia64 = TerminalServices.UpgradeFrom51.server.ia64
FreshInstallSection.server.ia64  = TerminalServices.FreshInstall.server.ia64

UpgradeFrom40Section.pro.x86    = TerminalServices.DoNothing
UpgradeFrom50Section.pro.x86    = TerminalServices.DoNothing
UpgradeFrom51Section.pro.x86    = TerminalServices.UpgradeFrom51.pro
FreshInstallSection.pro.x86     = TerminalServices.FreshInstall.pro

UpgradeFrom40Section.pro.ia64   = TerminalServices.DoNothing
UpgradeFrom50Section.pro.ia64    = TerminalServices.DoNothing
UpgradeFrom51Section.pro.ia64    = TerminalServices.UpgradeFrom51.pro
FreshInstallSection.pro.ia64     = TerminalServices.FreshInstall.pro

[TerminalServer]
Needs = WBEM
OptionDesc  = %APPSRV_DESC%
Tip         = %APPSRV_TIP%
IconIndex   = 10

RemoteAdmin.srv.x86                 = TerminalServices.RemoteAdmin
AppServer.srv.x86                   = TerminalServices.AppServer.x86
PersonalTS.srv.x86                  = TerminalServices.DoNothing
DisabledTS.srv.x86                  = TerminalServices.DoNothing

RemoteAdmin.srv.ia64                = TerminalServices.RemoteAdmin
AppServer.srv.ia64                  = TerminalServices.AppServer.ia64
PersonalTS.srv.ia64                 = TerminalServices.DoNothing
DisabledTS.srv.ia64                 = TerminalServices.DoNothing

RemoteAdmin.pro.x86                 = TerminalServices.DoNothing
AppServer.pro.x86                   = TerminalServices.DoNothing
PersonalTS.pro.x86                  = TerminalServices.PersonalTS
DisabledTS.pro.x86                  = TerminalServices.DoNothing

RemoteAdmin.pro.ia64                = TerminalServices.DoNothing
AppServer.pro.ia64                  = TerminalServices.DoNothing
PersonalTS.pro.ia64                 = TerminalServices.PersonalTS
DisabledTS.pro.ia64                 = TerminalServices.DoNothing

;-------------------------------------------------------------------------------
; Terminal Services Install/Upgrade Sections. [TerminalServices]
;
;-------------------------------------------------------------------------------

[TerminalServices.FreshInstall.server.x86]
CopyFiles    = TSsystemfiles, TSsystemfiles.srv, TSdrivers, TSdrivers.x86srv, tswmifiles
CopyFiles    = AppCompt, AppComptInstall.x86, AppComptLogon.x86, AppComptUninstall.x86, AppComptInstallTemplate.x86, AppComptLogonTemplate.x86, SecTemplates
AddReg       = Reg.common, Reg.srv, Reg.Winstations, Reg.Winstations.srv, Reg.common.RunX.Secured
AddReg       = Reg.x86srv
RegisterDlls = CommonDlls, Dlls.srv
ProfileItems = TSClient.InstallLink, TSMMC.InstallLink
CopyFiles    = tsc351, tscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
CopyFiles    = tsc16
#endif
ProfileItems = TSAdmin.InstallLink, TSCC.InstallLink


[TerminalServices.UpgradeFrom50.server.x86]
DelFiles     = DelDrivers
DelFiles     = DelTSSysFiles, AppComptInstall.Remove.x86, AppComptLogon.Remove.x86, AppComptUninstall.Remove.x86, AppComptInstallTemplate.Remove.x86, AppComptLogonTemplate.Remove.x86, clcreateold, oldtscw1601old, oldtscw1603old, oldtscw3201old, tscw32a01old, tscw32a01, tscw32a02, oldtscnw32a, EncFiles
CopyFiles    = TSsystemfiles, TSsystemfiles.srv, TSdrivers, TSdrivers.x86srv, tswmifiles
CopyFiles    = AppCompt, AppComptInstall.x86, AppComptLogon.x86, AppComptUninstall.x86, AppComptInstallTemplate.x86, AppComptLogonTemplate.x86, SecTemplates
DelFiles     = clcreate, oldtscmain, oldtscw3201, oldtscw3202, oldtscnw32
#ifndef DONT_NEED_WIN16_TSCLIENT
DelFiles     = oldtscw1601, oldtscw1602, oldtscw1603, oldtscw1604, oldtscnw16
#endif
DelReg       = Reg.delete
AddReg       = Reg.UpgradedFrom50
AddReg       = Reg.common, Reg.srv, Reg.common.RunX.Secured
AddReg       = Reg.x86srv
ProfileItems = TSClientCreator.RemoveRc1Link
ProfileItems = TSClient.InstallLink, TSMMC.InstallLink
RegisterDlls = CommonDlls, Dlls.srv
CopyFiles    = tsc351, tscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
CopyFiles    = tsc16
#endif
ProfileItems = TSAdmin.InstallLink, TSCC.InstallLink
DelDirs=DelOldTscDirs

[TerminalServices.UpgradeFrom51.server.x86]
DelFiles     = DelDrivers
DelFiles     = DelTSSysFiles, AppComptInstall.Remove.x86, AppComptLogon.Remove.x86, AppComptUninstall.Remove.x86, AppComptInstallTemplate.Remove.x86, AppComptLogonTemplate.Remove.x86, clcreateold, oldtscw1601old, oldtscw1603old, oldtscw3201old, tscw32a01old, tscw32a01, tscw32a02, oldtscnw32a, EncFiles
DelFiles     = clcreate, oldtscmain, oldtscw3201, oldtscw3202, oldtscnw32, oldtscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
DelFiles     = oldtscw1601, oldtscw1602, oldtscw1603, oldtscw1604, oldtscnw16
#endif
CopyFiles    = TSsystemfiles, TSsystemfiles.srv, TSdrivers, TSdrivers.x86srv, tswmifiles
CopyFiles    = AppCompt, AppComptInstall.x86, AppComptLogon.x86, AppComptUninstall.x86, AppComptInstallTemplate.x86, AppComptLogonTemplate.x86, SecTemplates
DelReg       = Reg.delete
AddReg       = Reg.UpgradedFrom51
AddReg       = Reg.common, Reg.srv, Reg.common.RunX.Secured
AddReg       = Reg.x86srv
ProfileItems = TSClientCreator.RemoveRc1Link
ProfileItems = TSClient.InstallLink, TSMMC.InstallLink
RegisterDlls = CommonDlls, Dlls.srv
CopyFiles    = tsc351, tscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
CopyFiles    = tsc16
#endif
ProfileItems = TSAdmin.InstallLink, TSCC.InstallLink
DelDirs=DelOldTscDirs

[TerminalServices.UpgradeFrom40.server.x86]
DelFiles     = DelDrivers
DelFiles     = DelTSSysFiles, AppComptInstall.Remove.x86, AppComptLogon.Remove.x86, AppComptUninstall.Remove.x86, AppComptInstallTemplate.Remove.x86, AppComptLogonTemplate.Remove.x86, oldtscw1601old, oldtscw1603old, oldtscw3201old, tscw32a01old, tscw32a01, tscw32a02, oldtscnw32a, EncFiles
CopyFiles    = TSsystemfiles, TSsystemfiles.srv, TSdrivers, TSdrivers.x86srv, tswmifiles
CopyFiles    = AppCompt, AppComptInstall.x86, AppComptLogon.x86, AppComptUninstall.x86, AppComptInstallTemplate.x86, AppComptLogonTemplate.x86, SecTemplates
DelFiles     = clcreate, oldtscmain, oldtscw3201, oldtscw3202, oldtscnw32
#ifndef DONT_NEED_WIN16_TSCLIENT
DelFiles     = oldtscw1601, oldtscw1602, oldtscw1603, oldtscw1604, oldtscnw16
#endif
DelReg       = Reg.delete
AddReg       = Reg.UpgradedFrom40
AddReg       = Reg.common, Reg.srv, Reg.common.RunX.Secured
AddReg       = Reg.x86srv
ProfileItems = TSCFG.RemoveLink, TSAdmin.RemoveOldLink, TSClientCreator.RemoveOldLink, AppSec.Remove40Link, IE4Inst.Remove40Link, Nw4Nt.Remove40Link
RegisterDlls = CommonDlls, Dlls.srv
ProfileItems = TSClient.InstallLink, TSMMC.InstallLink
CopyFiles    = tsc351, tscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
CopyFiles    = tsc16
#endif
ProfileItems = TSAdmin.InstallLink, TSCC.InstallLink
DelDirs=DelOldTscDirs


[TerminalServices.FreshInstall.server.ia64]
CopyFiles    = TSsystemfiles, TSsystemfiles.srv, TSdrivers, tswmifiles
CopyFiles    = AppCompt, AppComptInstall.ia64, AppComptLogon.ia64, AppComptUninstall.ia64, AppComptInstallTemplate.ia64, AppComptLogonTemplate.ia64, SecTemplates
AddReg       = Reg.common, Reg.common.ia64, Reg.srv, Reg.Winstations, Reg.Winstations.srv, Reg.common.RunX.Secured, Reg.common.RunX.Secured.ia64
RegisterDlls = CommonDlls, Dlls.srv
ProfileItems = TSClient.InstallLink, TSMMC.InstallLink
CopyFiles    = tsc351, tscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
CopyFiles    = tsc16
#endif
ProfileItems = TSAdmin.InstallLink, TSCC.InstallLink


[TerminalServices.UpgradeFrom50.server.ia64]
DelFiles     = DelDrivers, DelDrivers.ia64
DelFiles     = DelTSSysFiles, AppComptInstall.Remove.ia64, AppComptLogon.Remove.ia64, AppComptUninstall.Remove.ia64, AppComptInstallTemplate.Remove.ia64, AppComptLogonTemplate.Remove.ia64, clcreateold, oldtscw1601old, oldtscw1603old, oldtscw3201old, tscw32a01old, tscw32a01, tscw32a02, oldtscnw32a, EncFiles
CopyFiles    = TSsystemfiles, TSsystemfiles.srv, TSdrivers, tswmifiles
CopyFiles    = AppCompt, AppComptInstall.ia64, AppComptLogon.ia64, AppComptUninstall.ia64, AppComptInstallTemplate.ia64, AppComptLogonTemplate.ia64, SecTemplates
DelFiles     = clcreate, oldtscmain, oldtscw3201, oldtscw3202, oldtscnw32
#ifndef DONT_NEED_WIN16_TSCLIENT
DelFiles     = oldtscw1601, oldtscw1602, oldtscw1603, oldtscw1604, oldtscnw16
#endif
DelReg       = Reg.delete
AddReg       = Reg.UpgradedFrom50
AddReg       = Reg.common, Reg.common.ia64, Reg.srv, Reg.common.RunX.Secured, Reg.common.RunX.Secured.ia64
ProfileItems = TSClientCreator.RemoveRc1Link
ProfileItems = TSClient.InstallLink, TSMMC.InstallLink
RegisterDlls = CommonDlls, Dlls.srv
CopyFiles    = tsc351, tscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
CopyFiles    = tsc16
#endif
ProfileItems = TSAdmin.InstallLink, TSCC.InstallLink
DelDirs=DelOldTscDirs

[TerminalServices.UpgradeFrom51.server.ia64]
DelFiles     = DelDrivers, DelDrivers.ia64
DelFiles     = DelTSSysFiles, AppComptInstall.Remove.ia64, AppComptLogon.Remove.ia64, AppComptUninstall.Remove.ia64, AppComptInstallTemplate.Remove.ia64, AppComptLogonTemplate.Remove.ia64, clcreateold, oldtscw1601old, oldtscw1603old, oldtscw3201old, tscw32a01old, tscw32a01, tscw32a02, oldtscnw32a, EncFiles
DelFiles     = clcreate, oldtscmain, oldtscw3201, oldtscw3202, oldtscnw32,
#ifndef DONT_NEED_WIN16_TSCLIENT
DelFiles     = oldtscw1601, oldtscw1602, oldtscw1603, oldtscw1604, oldtscnw16, oldtscmsi
#endif
CopyFiles    = TSsystemfiles, TSsystemfiles.srv, TSdrivers, tswmifiles
CopyFiles    = AppCompt, AppComptInstall.ia64, AppComptLogon.ia64, AppComptUninstall.ia64, AppComptInstallTemplate.ia64, AppComptLogonTemplate.ia64, SecTemplates
DelReg       = Reg.delete
AddReg           = Reg.UpgradedFrom51
AddReg       = Reg.common, Reg.common.ia64, Reg.srv, Reg.common.RunX.Secured, Reg.common.RunX.Secured.ia64
ProfileItems = TSClientCreator.RemoveRc1Link
ProfileItems = TSClient.InstallLink, TSMMC.InstallLink
RegisterDlls = CommonDlls, Dlls.srv
CopyFiles    = tsc351, tscmsi
#ifndef DONT_NEED_WIN16_TSCLIENT
CopyFiles    = tsc16
#endif
ProfileItems = TSAdmin.InstallLink, TSCC.InstallLink
DelDirs=DelOldTscDirs


[TerminalServices.FreshInstall.pro]
CopyFiles    = TSsystemfiles, TSsystemfiles.pro, TSdrivers, tswmifiles
AddReg       = Reg.common, Reg.pro, Reg.Winstations, Reg.Winstations.pro, Reg.common.RunX.Secured
RegisterDlls = CommonDlls
ProfileItems = TSClient.InstallLink


[TerminalServices.UpgradeFrom51.pro]
DelFiles     = DelDrivers, DelDrivers.ia64
DelFiles     = DelTSSysFiles, clcreateold, oldtscw1601old, oldtscw1603old, oldtscw3201old, tscw32a01old, tscw32a01, tscw32a02, oldtscnw32a, oldtscmsi
DelFiles     = DelTSSysFiles.Pro, DelOldHelp.Pro
CopyFiles    = TSsystemfiles, TSsystemfiles.pro, TSdrivers, tswmifiles
DelReg       = Reg.delete
AddReg           = Reg.UpgradedFrom51
AddReg       = Reg.common, Reg.pro, Reg.common.RunX.Secured
RegisterDlls = CommonDlls
ProfileItems = TSClient.InstallLink


[TerminalServices.DoNothing]





;-------------------------------------------------------------------------------
; Terminal Services Toggle Section.
;-------------------------------------------------------------------------------

[TerminalServices.RemoteAdmin]
AddReg       = Reg.RemoteAdmin
AddReg       = Reg.ToggleOn

[TerminalServices.AppServer.x86]
AddReg       = Reg.AppServer
AddReg       = Reg.ToggleOn

[TerminalServices.AppServer.ia64]
AddReg       = Reg.AppServer
AddReg       = Reg.ToggleOn

[TerminalServices.PersonalTS]
AddReg       = Reg.PersonalTS
AddReg           = Reg.ToggleOn


;-------------------------------------------------------------------------------
; DLL Registration.
;
;-------------------------------------------------------------------------------

[Dlls.srv]
11,,tssdjet.dll,1       ; Load balancing Jet interface
11,,tscc.dll,1
11,,mstsmmc.dll,1
11,,mstsmhst.dll,1

[CommonDlls]
11,,mstscax.dll,1
11,,rdchost.dll,1       ; Salem
11,,cfgbkend.dll,1
11,,remotepg.dll,1      ; Sergey's Remote Page.



;-------------------------------------------------------------------------------
; Destination Directories.
;
;-------------------------------------------------------------------------------

[DestinationDirs]
AppCompt                = 10,"Application Compatibility Scripts"

AppComptInstall.x86         = 10,"Application Compatibility Scripts"\Install
AppComptInstall.Remove.x86  = 10,"Application Compatibility Scripts"\Install

AppComptLogon.x86           = 10,"Application Compatibility Scripts"\Logon
AppComptLogon.Remove.x86    = 10,"Application Compatibility Scripts"\Logon

AppComptUninstall.x86       = 10,"Application Compatibility Scripts"\Uninstall
AppComptUninstall.Remove.x86 = 10,"Application Compatibility Scripts"\Uninstall

AppComptInstallTemplate.x86 = 10,"Application Compatibility Scripts"\Install\Template
AppComptInstallTemplate.Remove.x86 = 10,"Application Compatibility Scripts"\Install\Template

AppComptLogonTemplate.x86   = 10,"Application Compatibility Scripts"\Logon\Template
AppComptLogonTemplate.Remove.x86   = 10,"Application Compatibility Scripts"\Logon\Template

AppComptInstall.ia64         = 10,"Application Compatibility Scripts"\Install
AppComptInstall.Remove.ia64  = 10,"Application Compatibility Scripts"\Install

AppComptLogon.ia64           = 10,"Application Compatibility Scripts"\Logon
AppComptLogon.Remove.ia64    = 10,"Application Compatibility Scripts"\Logon

AppComptUninstall.ia64       = 10,"Application Compatibility Scripts"\Uninstall
AppComptUninstall.Remove.ia64 = 10,"Application Compatibility Scripts"\Uninstall

AppComptInstallTemplate.ia64 = 10,"Application Compatibility Scripts"\Install\Template
AppComptInstallTemplate.Remove.ia64 = 10,"Application Compatibility Scripts"\Install\Template

AppComptLogonTemplate.ia64   = 10,"Application Compatibility Scripts"\Logon\Template
AppComptLogonTemplate.Remove.ia64   = 10,"Application Compatibility Scripts"\Logon\Template

TSWebClientFiles        = 10,"Web\TSWeb"


TSsystemfiles     = 11
TSsystemfiles.srv = 11
TSsystemfiles.pro = 11
TSdrivers         = 12
TSdrivers.x86srv  = 12
DelDrivers        = 12
DelDrivers.ia64   = 12
tswmifiles        = 11, "wbem"
DelTSSysFiles     = 11
DelTSSysFiles.Pro = 11

EncFiles       = 11,export
SecTemplates   = 10,security\templates


clcreate     = 11,clients
clcreateold  = 11,clients\tsclient
oldtscmain      = 11,clients\tsclient
#ifndef DONT_NEED_WIN16_TSCLIENT
oldtscw1601     = 11,clients\tsclient\win16\disks\disk1
oldtscw1601old  = 11,clients\tsclient\win16\disks\disk1
oldtscw1602     = 11,clients\tsclient\win16\disks\disk2
oldtscw1603     = 11,clients\tsclient\win16\disks\disk3
oldtscw1603old  = 11,clients\tsclient\win16\disks\disk3
oldtscw1604     = 11,clients\tsclient\win16\disks\disk4
tsc16           = 11,clients\tsclient\win16
#endif
oldtscw3201     = 11,clients\tsclient\win32\disks\disk1
oldtscw3201old  = 11,clients\tsclient\win32\disks\disk1
oldtscw3202     = 11,clients\tsclient\win32\disks\disk2
tscw32a01    = 11,clients\tsclient\win32a\disks\disk1
tscw32a01old = 11,clients\tsclient\win32a\disks\disk1
tscw32a02    = 11,clients\tsclient\win32a\disks\disk2
#ifndef DONT_NEED_WIN16_TSCLIENT
oldtscnw16      = 11,clients\tsclient\net\win16
#endif
oldtscnw32      = 11,clients\tsclient\net\win32
oldtscnw32a     = 11,clients\tsclient\net\win32a
tsc351          = 11,clients\tsclient\win32\acme351
tscmsi          = 11,clients\tsclient\win32
oldtscmsi       = 11,clients\tsclient\win32
DelOldHelp.Pro  = 18


;-------------------------------------------------------------------------------
; Old client directories to delete
;-------------------------------------------------------------------------------
[DelOldTscDirs]
%11%/clients/tsclient/net/win32
%11%/clients/tsclient/net/win32a
%11%/clients/tsclient/net/win16
%11%/clients/tsclient/net
%11%/clients/tsclient/win32a/disks/disk1
%11%/clients/tsclient/win32a/disks/disk2
%11%/clients/tsclient/win32a/disks
%11%/clients/tsclient/win32a
%11%/clients/tsclient/win32/disks/disk1
%11%/clients/tsclient/win32/disks/disk2
%11%/clients/tsclient/win32/disks/disk1
%11%/clients/tsclient/win32/disks
%11%/clients/tsclient/win16/disks/disk1
%11%/clients/tsclient/win16/disks/disk2
%11%/clients/tsclient/win16/disks/disk3
%11%/clients/tsclient/win16/disks/disk4
%11%/clients/tsclient/win16/disks
%11%/clients/tsclient/win16


;-------------------------------------------------------------------------------
; Links (shortcuts) sections
;
;-------------------------------------------------------------------------------

[TSClient.InstallLink]
Name = %TS_CLIENT%
CmdLine = 11,,mstsc.exe
SubDir = %COMMUNICATIONS%
InfoTip = "@%11%\mstsc.exe,-4001"
DisplayResource="%11%\mstsc.exe",4000

[TSAdmin.InstallLink]
Name    = %TS_TSADMIN%
CmdLine = 11,,tsadmin.exe
SubDir  = %ADMINTOOLS%
InfoTip = "@%11%\tsadmin.exe,-10001"
DisplayResource="%11%\tsadmin.exe",10000

[TSAdmin.RemoveLink]
Name    = %TS_TSADMIN%, 0x2
CmdLine = 11,,tsadmin.exe
SubDir  = %ADMINTOOLS%

[TSAdmin.RemoveOldLink]
Name    = %TS_TSADMIN_OLD%, 0x2
CmdLine = 11,,tsadmin.exe
SubDir  = %ADMINTOOLS%

[TSCC.InstallLink]
Name    = %TS_CC%
CmdLine = 11,,tscc.msc /s
SubDir  = %ADMINTOOLS%
InfoTip = "@%11%\tscc.dll,-10001"
DisplayResource="%11%\tscc.dll",10000

[TSCC.RemoveLink]
Name    = %TS_CC%, 0x2
CmdLine = 11,,tscc.msc
SubDir  = %ADMINTOOLS%

[TSMMC.InstallLink]
Name    = %TS_MMC%
CmdLine = 11,,tsmmc.msc /s
SubDir  = %ADMINTOOLS%
InfoTip = "@%11%\mstsmmc.dll,-10001"
DisplayResource="%11%\mstsmmc.dll",10000


[TSMMC.RemoveLink]
Name    = %TS_MMC%, 0x2
CmdLine = 11,,tsmmc.msc
SubDir  = %ADMINTOOLS%

[TSCC.RemoveOldLink]
Name    = %TS_CC_OLD%, 0x2
CmdLine = 11,,tscc.msc /s
SubDir  = %ADMINTOOLS%

[TSClientCreator.InstallLink]
Name    = %TS_CLIENT_CREATE%
CmdLine = 11,clients,clcreate.exe /%SystemRoot%\system32\clients\TSClient
SubDir  = %ADMINTOOLS%
InfoTip = %TS_CLIENT_CREATE_TIP%

[TSClientCreator.RemoveLink]
Name    = %TS_CLIENT_CREATE%, 0x2
CmdLine = 11,clients,clcreate.exe
SubDir  = %ADMINTOOLS%

[TSClientCreator.RemoveRc1Link]
Name    = %TS_CLIENT_CREATE%, 0x2
CmdLine = 11,,ncadmin.exe
SubDir  = %ADMINTOOLS%

[TSClientCreator.RemoveOldLink]
Name    = %TS_CLIENT_CREATE_OLD%, 0x2
CmdLine = 11,,ncadmin.exe
SubDir  = %ADMINTOOLS%

[TSCFG.RemoveLink]
Name    = %TS_TSCFG%, 0x2
CmdLine = 11,,tscfg.exe
SubDir  = %ADMINTOOLS%

[AppSec.Remove40Link]
Name    = %TS_APPSEC%, 0x2
CmdLine = 11,,appsec.exe
SubDir  = %ADMINTOOLS%

[IE4Inst.Remove40Link]
Name    = %TS_IE4INST%, 0x2
CmdLine = 11,,ie4inst.exe
SubDir  = %ADMINTOOLS%

[Nw4Nt.Remove40Link]
Name    = %TS_NW4NT%, 0x2
CmdLine = 11,,nw4nt.exe
SubDir  = %ADMINTOOLS%


;-------------------------------------------------------------------------------
; File Sections
;
;-------------------------------------------------------------------------------

[TSWebClient.Install]
CopyFiles=TSWebClientFiles

[TSWebClient.UnInstall]
DelFiles=TSWebClientFiles


[DelDrivers.ia64]
tdasync.sys ; 32 bit server only
tdipx.sys  ; 32 bit only server
tdspx.sys  ; 32 bit only server

[DelDrivers]
tdnetb.sys ; remove completely

[DelOldHelp.Pro]
tsuserex.chm
tsuserex.hlp

[TSdrivers.x86srv]
tdasync.sys ; 32 bit server only
tdipx.sys  ; 32 bit only server
tdspx.sys  ; 32 bit only server



[TSdrivers]
rdpwd.sys
rdpdr.sys
tdpipe.sys
tdtcp.sys
termdd.sys


[TSsystemfiles.pro]

[TSsystemfiles.srv.Security]
"D:P(A;;GRGX;;;BU)(A;;GA;;;BA)(A;;GA;;;SY)(A;;GRGX;;;WD)"

[TSsystemfiles.srv]
tsadmin.exe
tscc.dll
tscc.msc
tssdjet.dll
tssdis.exe

change.exe
chglogon.exe
chgport.exe
chgusr.exe
cprofile.exe
flattemp.exe
query.exe
quser.exe
register.exe
tsprof.exe
mstsmmc.dll ; tsmmc snapin
mstsmhst.dll ; tsmmc snapin
tsmmc.msc ; tsmmc snapin


[TSWebClientFiles]
default.htm,    tsweb1.htm
msrdp.cab,      msrdp.cab
bluebarh.gif,   bluebarh.gif
bluebarv.gif,   bluebarv.gif
win2000l.gif,   win2000l.gif
win2000r.gif,   win2000r.gif



[TSsystemfiles.Security]
"D:P(A;;GRGX;;;BU)(A;;GA;;;BA)(A;;GA;;;SY)(A;;GRGX;;;WD)"

[TSsystemfiles]
cdmodem.dll
cfgbkend.dll
icaapi.dll
logoff.exe
msg.exe
qappsrv.exe
qprocess.exe
qwinsta.exe
rdpcfgex.dll
rdpclip.exe
rdpsnd.dll
;rdpdd.dll
rdpwsx.dll
regini.exe
rwinsta.exe
shadow.exe
#ifdef TERMSRV_PROC
termsrv.exe, termsrv.dll
#else
termsrv.dll
#endif

tscon.exe
tsdiscon.exe
tslabels.h
tslabels.ini
tsshutdn.exe
tskill.exe
usrlogon.cmd
tscupgrd.exe    ; TS client upgrade wrapper
rdchost.dll     ; Salem
sessmgr.exe     ; Salem
rdshost.exe     ; Salem
rdsaddin.exe    ; Salem
remotepg.dll    ; Sergey's Remote Page.
reset.exe

mstsc.exe   ; tsclient files
mstscax.dll ; tsclient files

tscfgwmi.dll    ; TS WMI Provider

[tswmifiles]
tscfgwmi.mof    ; TS WMI provider
tscfgwmi.mfl	; TS WMI provider

[DelTSSysFiles.Pro]
tsprof.exe
tsadmin.exe
mstsmmc.dll ; tsmmc snapin
mstsmhst.dll ; tsmmc snapin
tsmmc.msc ; tsmmc snapin
tsuserex.dll
tscc.dll



[DelTSSysFiles]
arevfix.com
appsec.cnt
appsec.exe
appsec.hlp
cnvrtuc.exe
connect.exe
c2cfg.exe
c2config.exe
ctxdel.exe
cxerror.dll
cxnetdde.exe
cxstatus.dll
disconn.exe
doskbd.exe
ie4del.exe
ie4inst.exe
installr.exe
kill.exe
migrate.exe
ncadmin.exe
ncadmin.hlp
ndspsvr.exe
nw2nt.cnt
nw2nt.exe
nw2nt.hlp
peruser.exe
qobject.exe
regfix.exe
termsrv.exe
tscfg.exe
tscfg.hlp
tsc2.exe
tsnotify.dll
tssdsql.dll
licmgr.hlp
licmgr.cnt
clcreate.hlp
clcreate.cnt
tsadmin.hlp
tsadmin.cnt
dbgtrace.exe

; intermittent salem files to be deleted.
rdqrymgr.dll
rdwmiqry.exe
swmi.dll
tsdiag.dll      ; ts trouble shooter.

[EncFiles]
instm165.dll
instm3x5.dll
instrdp5.dll
tsocenc.inf

[SecTemplates]
notssid.inf


[AppCompt]
aciniupd.exe
acregl.exe
acsr.exe
chkroot.cmd
end.cmd
rootdrv.cmd
setpaths.cmd


[AppComptInstall.x86]
#ifndef JAPAN
cofc8ins.cmd
#endif

#ifndef JAPAN
coffice8.cmd
#endif

eudora4.cmd
fpage98.cmd
msexcl97.cmd
msproj98.cmd
msvs6.cmd
msword97.cmd
netcom40.cmd
ofc43ins.cmd
office43.cmd
office43.key
office97.cmd
pwrbldr6.cmd
#ifndef JAPAN
ssuite9.cmd
#endif
visio5.cmd
outlk98.cmd
lnote4u.cmd
lnote4u.key
ssuite95.cmd





[AppComptInstall.Remove.x86]
coffice7.cmd
coffice7.key
diskpr20.cmd
drwatson.cmd
drwatson.key
msie30.cmd
msie40.cmd
msie30.key
msie40.key
msie40s.key
msproj95.cmd
mssna30.cmd
netnav30.cmd
odbc.cmd
office95.cmd
pchtree6.cmd
sna40cli.cmd
sna40srv.cmd
ssuite9.key
ssuite95.key
ssuite97.cmd
ssuite97.key
winmsg.cmd

[AppComptLogon.x86]
#ifndef JAPAN
ss9usr.cmd
#endif
tsmkudir.cmd
tsmkufil.cmd
eud4usr.cmd
ss95usr.cmd


[AppComptLogon.Remove.x86]
msie4usr.cmd
nav30usr.cmd
prj95usr.cmd
ptr6usr.cmd
ss97usr.cmd
wmsgusr.cmd


[AppComptUninstall.x86]
#ifndef JAPAN
ucoff8.cmd
#endif
ucom40.cmd
uexcl97.cmd
ufpg98.cmd
umsvs6.cmd
uoff43.cmd
uoff97.cmd
uoutlk98.cmd
uproj98.cmd
#ifndef JAPAN
uss9.cmd
#endif
uword97.cmd
uss95.cmd
upbld6.cmd



[AppComptUninstall.Remove.x86]
ucoff7.cmd
umsie40.cmd
unav30.cmd
uoff95.cmd
upchtre6.cmd
uproj95.cmd
uss97.cmd
uwinmsg.cmd

[AppComptInstallTemplate.x86]
#ifndef JAPAN
coffice8.key
#endif
eudora4.key
msexcl97.key
msproj98.key
msvs6.key
msword97.key
office97.key
outlk98.key
pwrbldr6.key


[AppComptInstallTemplate.Remove.x86]
coffice7.key
drwatson.key
msie30.key
msie40.key
msie40s.key
msproj95.key
netnav30.key
odbc.key
office95.key

[AppComptLogonTemplate.x86]
#ifndef JAPAN
cofc8usr.cmd
#endif
Com40usr.cmd
exl97usr.cmd
ofc43usr.cmd
ofc43usr.key
ofc97usr.cmd
prj98usr.cmd
wrd97usr.cmd
olk98usr.cmd
pbld6usr.cmd

[AppComptLogonTemplate.Remove.x86]
cofc7usr.cmd
ofc95usr.cmd
prj95usr.key
prj95usr.cmd

[AppComptInstall.ia64]
msvs6.cmd

[AppComptInstall.Remove.ia64]
coffice7.cmd
coffice7.key
diskpr20.cmd
drwatson.cmd
drwatson.key
msie30.cmd
msie40.cmd
msie30.key
msie40.key
msie40s.key
msproj95.cmd
mssna30.cmd
netnav30.cmd
odbc.cmd
office95.cmd
pchtree6.cmd
sna40cli.cmd
sna40srv.cmd
ssuite9.key
ssuite95.key
ssuite97.cmd
ssuite97.key
winmsg.cmd
cofc8ins.cmd
coffice8.cmd
eudora4.cmd
fpage98.cmd
msexcl97.cmd
msproj98.cmd
msword97.cmd
netcom40.cmd
ofc43ins.cmd
office43.cmd
office43.key
office97.cmd
pwrbldr6.cmd
ssuite9.cmd
visio5.cmd
outlk98.cmd
lnote4u.cmd
lnote4u.key
ssuite95.cmd

[AppComptLogon.ia64]
tsmkudir.cmd
tsmkufil.cmd

[AppComptLogon.Remove.ia64]
msie4usr.cmd
nav30usr.cmd
prj95usr.cmd
ptr6usr.cmd
ss97usr.cmd
wmsgusr.cmd
ss9usr.cmd
eud4usr.cmd
ss95usr.cmd

[AppComptUninstall.ia64]
umsvs6.cmd

[AppComptUninstall.Remove.ia64]
ucoff7.cmd
umsie40.cmd
unav30.cmd
uoff95.cmd
upchtre6.cmd
uproj95.cmd
uss97.cmd
uwinmsg.cmd
ucoff8.cmd
ucom40.cmd
uexcl97.cmd
ufpg98.cmd
uoff43.cmd
uoff97.cmd
uoutlk98.cmd
uproj98.cmd
uss9.cmd
uword97.cmd
uss95.cmd
upbld6.cmd

[AppComptInstallTemplate.ia64]
msvs6.key

[AppComptInstallTemplate.Remove.ia64]
coffice7.key
drwatson.key
msie30.key
msie40.key
msie40s.key
msproj95.key
netnav30.key
odbc.key
office95.key
coffice8.key
eudora4.key
msexcl97.key
msproj98.key
msword97.key
office97.key
outlk98.key
pwrbldr6.key

[AppComptLogonTemplate.ia64]

[AppComptLogonTemplate.Remove.ia64]
cofc7usr.cmd
ofc95usr.cmd
prj95usr.key
prj95usr.cmd
cofc8usr.cmd
Com40usr.cmd
exl97usr.cmd
ofc43usr.cmd
ofc43usr.key
ofc97usr.cmd
prj98usr.cmd
wrd97usr.cmd
olk98usr.cmd
pbld6usr.cmd

[clcreate]
clcreate.exe


[clcreateold]
clcreate.exe


[oldtscmain]
ncadmin.inf


#ifndef DONT_NEED_WIN16_TSCLIENT
[oldtscw1601]
acmsetup.exe
acmsetup.hlp
conman16.hlp
custom.dll
eula.txt
mscpydis.dll
mssetup.dll
mstsc.exe
mstsc.inf
mstsc.ini
mstsc16.hlp
setup.exe
setup.ini
acmboot.lst
setup.stf
setup.tdf
_mssetup.exe
mstsc1.id
acmboot.exe

[oldtscw1601old]
conman.exe


[oldtscw1602]
comctl16.dll
mstsc2.id

[oldtscw1603]
compobj.dll
ole2.dll
ole2disp.dll
tsctrc.dll
win16x.dll
mstsc3.id

[oldtscw1603old]
ole2nls.dll
storage.dll
rdpdr.dll


[oldtscw1604]
conman.exe
ole2nls.dll
storage.dll
rdpdr.dll
mstsc4.id

[tsc16]
acmboot.exe,    tscn1601.w16
acmboot.lst,    tscn1602.w16
acmsetup.exe,   tscn1603.w16
acmsetup.hlp,   tscn1604.w16
comctl16.dll,   tscn1605.w16
compobj.dll,    tscn1606.w16
conman.exe,     tscn1607.w16
conman.sym,     tscn1608.w16
conman16.hlp,   tscn1609.w16
custom.dll,     tscn1610.w16
eula.txt,       tscn1611.w16
mscpydis.dll,   tscn1612.w16
mssetup.dll,    tscn1613.w16
mstsc.exe,      tscn1614.w16
mstsc.inf,      tscn1615.w16
mstsc.ini,      tscn1616.w16
mstsc.sym,      tscn1617.w16
mstsc1.id,      tscn1618.w16
mstsc16.hlp,    tscn1619.w16
mstscf.inf,     tscn1620.w16
ole2.dll,       tscn1621.w16
ole2disp.dll,   tscn1622.w16
ole2nls.dll,    tscn1623.w16
rdpdr.dll,      tscn1624.w16
rdpdr.sym,      tscn1625.w16
setup.exe,      tscn1626.w16
setup.ini,      tscn1627.w16
setup.stf,      tscn1628.w16
setup.sym,      tscn1629.w16
setup.tdf,      tscn1630.w16
storage.dll,    tscn1631.w16
tsctrc.dll,     tscn1632.w16
tsctrc.sym,     tscn1633.w16
win16x.dll,     tscn1634.w16
_mssetup.exe,   tscn1635.w16
#endif


[oldtscw3201]
acmsetup.exe
acmsetup.hlp
conman.exe
common98.dll
eula.txt
mssetup.dll
mstsc.cnt
mstsc.inf
mstsc.stf
setup.exe
setup.ini
setup.lst
setup.tdf
mstsc1.id


[oldtscw3201old]
cconman.cnt
cconman.hlp
mstsc.exe
mstsc.hlp
rdpdr.dll
tsctrc.dll


[oldtscw3202]
cconman.cnt
cconman.hlp
mstsc.exe
mstsc.hlp
tsctrc.dll
rdpdr.dll
mstsc2.id


[tscw32a01]
acmsetup.exe
acmsetup.hlp
common98.dll
eula.txt
mssetup.dll
mstsc.inf
mstsc.stf
setup.exe
setup.ini
setup.lst
setup.tdf
mstsc1.id


[tscw32a01old]
conman.exe
mstsc.cnt


[tscw32a02]
conman.exe
mstsc.cnt
cconman.cnt
cconman.hlp
mstsc.exe
mstsc.hlp
tsctrc.dll
mstsc2.id
rdpdr.dll


#ifndef DONT_NEED_WIN16_TSCLIENT
[oldtscnw16]
acmsetup.exe
acmsetup.hlp
conman.exe
Custom.dll
eula.txt
mscpydis.dll
mssetup.dll
mstsc.exe
mstsc.inf
mstsc.ini
mstsc1.id
mstsc16.hlp
setup.exe
setup.ini
acmboot.lst
setup.stf
tsctrc.dll
_mssetup.exe
conman16.hlp
comctl16.dll
compobj.dll
ole2.dll
ole2disp.dll
ole2nls.dll
storage.dll
win16x.dll
acmboot.exe
rdpdr.dll
#endif


[oldtscnw32]
acmsetup.exe
acmsetup.hlp
cconman.cnt
cconman.hlp
conman.exe
common98.dll
eula.txt
mssetup.dll
mstsc.cnt
mstsc.exe
mstsc.hlp
mstsc.inf
mstsc.stf
mstsc1.id
setup.exe
setup.ini
setup.lst
tsctrc.dll
rdpdr.dll


[oldtscnw32a]
acmsetup.exe
acmsetup.hlp
cconman.cnt
cconman.hlp
conman.exe
Common98.dll
eula.txt
mssetup.dll
mstsc.cnt
mstsc.exe
mstsc.hlp
mstsc.inf
mstsc.stf
mstsc1.id
setup.exe
setup.ini
setup.lst
tsctrc.dll
rdpdr.dll

[oldtscmsi]
tsclient.msi
tscmsi02.cab

[tsc351]
acmsetup.exe,   tscn3201.351
acmsetup.hlp,   tscn3202.351
cconman.cnt,    tscn3203.351
cconman.hlp,    tscn3204.351
common98.dll,   tscn3205.351
conman.exe,     tscn3206.351
eula.txt,       tscn3207.351
mssetup.dll,    tscn3208.351
mstsc.cnt,      tscn3209.351
mstsc.exe,      tscn3210.351
mstsc.hlp,      tscn3211.351
mstsc.inf,      tscn3212.351
mstsc.stf,      tscn3213.351
mstsc1.id,      tscn3214.351
mstscf.inf,     tscn3215.351
rdpdr.dll,      tscn3232.351
setup.exe,      tscn3217.351
setup.ini,      tscn3218.351
setup.lst,      tscn3219.351
setup.tdf,      tscn3220.351
tsctrc.dll,     tscn3221.351

[tscmsi]
msrdpcli.msi,   tscmsi01.w32
setup.exe,      tscmsi02.w32
setup.ini,      tscmsi03.w32
instmsiw.exe,   instmsiw.exe
instmsia.exe,   instmsia.exe


; following are some more TS files but are installed by Txtmode setup

; tsuserex.dll
; mstlsapi.dll
; utildll.dll
; winsta.dll
; tsoc.inf
; tsoc.dll
; rdpcdd.sys
; rdpcdd.inf
; rdpcdd.dll
; tsappcmp.dll
; perfts.dll
; tsddd.dll
; drprov.dll


[RunOnce.Setup]
rdshost.exe -regserver
sessmgr.exe -service


; ------------------------------------------------------------
; TS Registry...
;
;
; we have following registry sections, use apropriate for your registry entry.
; for any registry you add,  you need to specify if the registry is to be retained on upgrades or not.

;[Reg.delete]           - Add any registry to be deleted here. This will be deleted on all upgrades.
;[Reg.common]           - Add any ts specific common registry here, this will be added on all upgrades / installs, no matter ts is on or off.

;[Reg.srv]                      - TS Registry specific to server product. This is applied on all server upgrades /installs no matter ts is on or off
;[Reg.pro]                      - TS Registry specific to pro product. This is applied on all pro upgrades / installs no matter ts is on or off

;[Reg.ToggleOn]         - Registry applied when TS is toggled on for both pro / srv
;[Reg.ToggleOff]        - Registry applied when TS is toogled off for both pro / srv

;[Reg.AppServer]        - Registry applied when TS is moved to AppServer Mode.
;[Reg.RemoteAdmin]      - Registry applied when TS is moved to Remote Admin Mode
;[Reg.PersonalTS]       - Registry applied when TS is moved to Personal TS mode.


; Friendly Reg types.
; OWRITE means add the value, overwriting current values if present.
; RETAIN means add the value, but only if it does not already exist.

#define DELETE_VALUE    0x00000004
#define DWORD_RETAIN    0x00010003
#define DWORD_OWRITE    0x00010001

#define STRIG_RETAIN    0x00000002
#define STRIG_OWRITE    0x00000000
#define STRIG_DELETE    0x00000004

#define EXPND_RETAIN    0x00020002
#define EXPND_OWRITE    0x00020000

#define BINRY_RETAIN    0x00000003
#define BINRY_OWRITE    0x00000001

#define MULSZ_RETAIN    0x00010002
#define MULSZ_OWRITE    0x00010000
#define MULSZ_APPEND    0x00010008



; you can use following section to quick test your registry changes.
; add any registry to test section, and see if it works by right click / Install on generated inf file.
[DefaultInstall]
AddReg = Reg.TestSection.Add
DelReg = Reg.TestSection.Del

[Reg.TestSection.Add]

[Reg.TestSection.Del]



; Add any registry to be deleted here. This will be deleted on all os upgrade cases
; this section is not run on Mode change
[Reg.delete]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility","InfFileOverrideMenuMove",0x00010000,"oemnxptc.inf"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Machine"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon","TextShell",0x00000000,"tprogman.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","ProductBuild",0x00000000,"419"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","ProductName",0x00000000,"Microsoft (R) Windows Terminal Server"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","ProductVersion",0x00000000,"4.0"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","ProductVersionNum",0x00010001,0x400
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000502",0x00000000,"f3ahvoas.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000D05",0x00000000,"kbdn106.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00001801",0x00000000,"kbdlk41a.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00001802",0x00000000,"kbdlk41j.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\query","object",0x00010000,"0","1","OBJECT","qobject.exe"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\cxerror","EventMessageFile",0x00020000,"%SystemRoot%\System32\cxerror.dll"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\cxerror","TypesSupported",0x00010001,0x7
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\cxstatus","EventMessageFile",0x00020000,"%SystemRoot%\System32\cxstatus.dll"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\cxstatus","TypesSupported",0x00010001,0x7
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\Session","EventMessageFile",0x00020000,"%SystemRoot%\System32\cxstatus.dll;%SystemRoot%\System32\cxerror.dll;%SystemRoot%\System32\ntdll.dll;%SystemRoot%\System32\kernel32.dll"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\Session","TypesSupported",0x00010001,0x7
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService\Parameters", "Certificate"
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService\Parameters", "DefaultLicenseServer"
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService\Parameters", "X509 Certificate", DELETE_VALUE
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService\Parameters", "X509 Certificate ID", DELETE_VALUE
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService\Parameters", "UseLicenseServer", DELETE_VALUE
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService\LsStore"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","AdvertiseOldAppServerBit",0x00010001,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon","DisableCtrlAltDel",0x00000000,"0"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\VIDEO"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations","Anonymous", DELETE_VALUE
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations","AppServer", DELETE_VALUE
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations","RemoteAdmin", DELETE_VALUE
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations","Professional", DELETE_VALUE
HKLM ,"SYSTEM\CurrentControlSet\Services\TDASYNC"
HKLM ,"SYSTEM\CurrentControlSet\Services\TDIPX"
HKLM ,"SYSTEM\CurrentControlSet\Services\TDSPX"
HKLM ,"SYSTEM\CurrentControlSet\Services\NETB"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Classes"


[Reg.UpgradedFrom40]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server","UpgradeFromTS4",0x00010001,0x1

[Reg.UpgradedFrom50]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server","UpgradeFromTS50",0x00010001,0x1

[Reg.UpgradedFrom51]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server","UpgradeFromTS51",0x00010001,0x1


; -------------------------------------------------------------
; Mode Specific Registry
;

[Reg.AppServer]
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server", "TSAdvertise", DWORD_OWRITE, 0x1
HKLM ,"SOFTWARE\Microsoft\Windows\CurrentVersion\netcache","Enabled", DWORD_OWRITE, 0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon","AppSetup", STRIG_OWRITE, "UsrLogon.Cmd"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{c6dc5466-785a-11d2-84d0-00c04fb169f7}","NoUserPolicy", DWORD_OWRITE, 0x00000001
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","IdleWinStationPoolCount", DWORD_OWRITE,0x2
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","TSAppCompat", DWORD_OWRITE,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","SessionDirectoryActive", DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","IAT", DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","fSingleSessionPerUser", DWORD_OWRITE,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","SessionDirectoryExposeServerIP", DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","SessionDirectoryCLSID", STRIG_RETAIN, "{005a9c68-e216-4b27-8f59-b336829b3868}"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","SessionDirectoryExCLSID", STRIG_RETAIN, "{ec98d957-48ad-436d-90be-bc291f42709c}"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\ClusterSettings","SessionDirectoryAdditionalParams", STRIG_RETAIN, ""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\ClusterSettings","SessionDirectoryClusterName", STRIG_RETAIN, ""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\ClusterSettings","SessionDirectoryLocation", STRIG_RETAIN, ""
HKU ,".Default\Control Panel\Desktop","CursorBlinkRate", STRIG_OWRITE, "1200"
HKU ,".Default\Control Panel\Desktop","DragFullWindows", STRIG_OWRITE, "0"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\UserOverride\Control Panel\Desktop","Wallpaper",STRIG_RETAIN,""

[Reg.RemoteAdmin]
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server", "TSAdvertise", DWORD_OWRITE, 0x0
HKLM ,"SOFTWARE\Microsoft\Windows\CurrentVersion\netcache","Enabled", DWORD_OWRITE, 0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon","AppSetup", STRIG_OWRITE,""
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{c6dc5466-785a-11d2-84d0-00c04fb169f7}","NoUserPolicy", DWORD_OWRITE, 0x00000000
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","IdleWinStationPoolCount", DWORD_OWRITE,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","TSAppCompat", DWORD_OWRITE,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","fSingleSessionPerUser", DWORD_OWRITE,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\UserOverride\Control Panel\Desktop","Wallpaper",DELETE_VALUE

[Reg.PersonalTS]
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server", "TSAdvertise", DWORD_RETAIN, 0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","IdleWinStationPoolCount", DWORD_OWRITE, 0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","TSAppCompat", DWORD_OWRITE, 0x0

;
; Mode Specific Registry
; -------------------------------------------------------------


; -------------------------------------------------------------
; Toggle On/Off Registry
;

[Reg.ToggleOn]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon","ShutdownWithoutLogon",0x00000000,"0"
HKLM ,"SOFTWARE\Policies\Microsoft\Windows\Installer","EnableAdminTSRemote", 0x00010001, 0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","TSEnabled",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TermDD","Start",0x00010001,0x1


[Reg.ToggleOff]
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","TSEnabled",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\TermDD","Start",0x00010001,0x4
; Chained Display Driver for Console Shadow
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPCDD","Start",0x00010001,0x4

;
; Toggle On/Off Registry
; -------------------------------------------------------------


; TS Registry specific to pro product. This is applied on all pro upgrades / installs no matter ts is on or off
[Reg.pro]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon","AllowMultipleTSSessions", DWORD_RETAIN, 0x0
HKLM ,"System\CurrentControlSet\Control\Terminal Server","fWritableTSCCPermTab", DWORD_OWRITE, 0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","DeleteTempDirsOnExit", DWORD_RETAIN, 0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","PerSessionTempDir", DWORD_RETAIN, 0x0

#ifndef TERMSRV_PROC
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "ImagePath", EXPND_OWRITE, "%SystemRoot%\System32\svchost.exe -k netsvcs"
#endif

[Reg.x86srv]
HKLM ,"SYSTEM\CurrentControlSet\Services\TDASYNC","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\TDASYNC","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\TDASYNC","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TDIPX","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\TDIPX","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\TDIPX","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TDSPX","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\TDSPX","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\TDSPX","Type",0x00010001,0x1



; TS Registry specific to server product. This is applied on all server upgrades / installs no matter ts is on or off
[Reg.srv]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon","AllowMultipleTSSessions", DWORD_RETAIN, 0x1
HKLM ,"System\CurrentControlSet\Control\Terminal Server","fWritableTSCCPermTab", DWORD_OWRITE, 0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","DeleteTempDirsOnExit", DWORD_RETAIN, 0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","PerSessionTempDir", DWORD_RETAIN, 0x1

#ifndef TERMSRV_PROC
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "ImagePath", EXPND_OWRITE, "%SystemRoot%\System32\svchost.exe -k termsvcs"
#endif

; tssdis
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "ErrorControl", DWORD_OWRITE, 0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "Type", DWORD_OWRITE, 0x10
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "ObjectName", STRIG_OWRITE, "LocalSystem"
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "Start", DWORD_RETAIN, 0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "Description", STRIG_OWRITE, "%TSSDIR_DESCRIPTION%"
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "DisplayName", STRIG_OWRITE, "%TSSDIR_DISPLAYNAME%"
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "ImagePath", EXPND_OWRITE, "%SystemRoot%\System32\tssdis.exe"
HKLM ,"SYSTEM\CurrentControlSet\Services\Tssdis", "DependOnService", MULSZ_OWRITE, "RPCSS"



[Reg.Winstations.pro]
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp", "ColorDepth", DWORD_RETAIN,0x3
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableCam",DWORD_OWRITE,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableCam",DWORD_OWRITE,0x0

[Reg.Winstations.srv]
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp", "ColorDepth", DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableCam",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableCam",DWORD_RETAIN,0x1

[Reg.Winstations]
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","CfgDll",STRIG_RETAIN,"RDPCFGEX.DLL"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fEnableWinStation",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","MaxInstanceCount",DWORD_RETAIN,0xffffffff
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","PdName",STRIG_RETAIN,"tcp"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","PdClass",DWORD_RETAIN,0x2
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","PdDLL",STRIG_RETAIN,"tdtcp"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","PdFlag",DWORD_RETAIN,0x4e
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","OutBufLength",DWORD_RETAIN,0x212
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","OutBufCount",DWORD_RETAIN,0x6
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","OutBufDelay",DWORD_RETAIN,0x64
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","InteractiveDelay",DWORD_RETAIN,0x32
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","PortNumber",DWORD_RETAIN,0xd3d
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","KeepAliveTimeout",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","LanAdapter",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","WdName",STRIG_RETAIN,"Microsoft RDP 5.1"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","WdDLL",STRIG_RETAIN,"rdpwd"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","WsxDLL",STRIG_RETAIN,"rdpwsx"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","WdFlag",DWORD_RETAIN,0x36
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","InputBufferLength",DWORD_RETAIN,0x800
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","CdClass",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","CdName",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","CdDLL",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","CdFlag",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","Comment",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritAutoLogon",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritResetBroken",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritReconnectSame",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritInitialProgram",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritCallback",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritCallbackNumber",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritShadow",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritMaxSessionTime",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritMaxDisconnectionTime",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritMaxIdleTime",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritAutoClient",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritSecurity",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fInheritColorDepth",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fPromptForPassword",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fResetBroken",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fReconnectSame",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fLogonDisabled",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fAutoClientDrives",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fAutoClientLpts",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fForceClientLptDef",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableEncryption",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fHomeDirectoryMapRoot",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fUseDefaultGina",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableCpm",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableCdm",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableCcm",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableLPT",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableClip",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableExe",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","fDisableCam",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","Username",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","Domain",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","Password",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","WorkDirectory",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","InitialProgram",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","CallbackNumber",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","Callback",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","Shadow",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","MaxConnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","MaxDisconnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","MaxIdleTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","KeyboardLayout",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","MinEncryptionLevel",DWORD_RETAIN,0x2
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","NWLogonServer",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","WFProfilePath",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","WdPrefix",STRIG_RETAIN,"RDP"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","TraceEnable",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","TraceDebugger",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","TraceClass",DWORD_RETAIN,0x0
#ifdef _INTERNAL_COMMENT_
; Use following values for Debug Build.
;HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","TraceEnable",DWORD_RETAIN,0x88
;HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","TraceDebugger",DWORD_RETAIN,0x1
;HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","TraceClass",DWORD_RETAIN,0x10000028
;HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp","TraceOption",STRIG_RETAIN,""
#endif

; Security Descriptor for the RunOnce key such that only Admins and system can write to it.
[Reg.common.RunX.Secured.Security]
"D:P(A;CI;GR;;;BU)(A;CI;GR;;;PU)(A;CI;GA;;;BA)(A;CI;GA;;;SY)"

[Reg.common.RunX.Secured]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Runonce"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run"

; Security Descriptor for the RunOnce key such that only Admins and system can write to it.
[Reg.common.RunX.Secured.ia64.Security]
"D:P(A;CI;GR;;;BU)(A;CI;GR;;;PU)(A;CI;GA;;;BA)(A;CI;GA;;;SY)"

; This is for 32 bit Apps running on IA64
[Reg.common.RunX.Secured.ia64]
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Runonce"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run"

; Add any ts specific common registry here, this will be added on all upgrades / installs, no matter ts is on or off.
[Reg.common]
; these are all the values that are common to 40 and 50.
; they are applied only for 50 fresh installs.
; [Reg.AddToFreshInstall]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server","AllowRemoteSound",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility","SysDir",STRIG_RETAIN,""
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\ACMSETUP","Flags",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CINMANIA","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","ClipboardFlags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","OpenClipboardDelayInMilliSecs",DWORD_RETAIN,0x50
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","OpenClipboardRetries",DWORD_RETAIN,0x20
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCHNG32","Flags",DWORD_RETAIN,0x008
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\FIXACLS","Flags",DWORD_RETAIN,0x408
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\HOTFIX","Flags",DWORD_RETAIN,0x28
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MARS32","Flags",DWORD_RETAIN,0x80c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MPRADMIN","Flags",DWORD_RETAIN,0x408
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xff
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","Flags",DWORD_RETAIN,0x80c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x1
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\OUTLOOK","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\PLT","Flags",DWORD_RETAIN,0x11
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\POWERPNT","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\REG2INI","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\REGEDIT","Flags",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\REGEDT32","Flags",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\RUNDLL32","Flags",DWORD_RETAIN,"0x408"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SCHDPL32","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SNASRV","Flags",DWORD_RETAIN,0x200
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SYSDIFF","Flags",DWORD_RETAIN,0x408
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WINWORD","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WS32","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WS32CLN","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WS32REG","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WSVERIFY","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\IniFiles","SYSTEM",DWORD_RETAIN,0x44
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\IniFiles","WIN",DWORD_RETAIN,0x44
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Registry Entries","Classes",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Registry Entries","Microsoft\Windows NT",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Change User Option"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Security","SecurityLevel",STRIG_RETAIN,"Default"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","Modems With Bad DSR",MULSZ_RETAIN,"MultiTech MultiModem MT2834","MultiTech MultiModem MT2834ZDX","MultiTech MT2834","MultiTech MT2834ZDX","MultiTech 2834","MultiTech 2834ZDX"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\AuthorizedApplications"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","Callback",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","CallbackNumber",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","Domain",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","InitialProgram",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","KeyboardLayout",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","MaxConnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","MaxDisconnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","MaxIdleTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","NWLogonServer",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","Password",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","Shadow",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","UserName",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","WorkDirectory",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritAutoLogon",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritCallback",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritCallbackNumber",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritInitialProgram",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritMaxDisconnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritMaxIdleTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritMaxSessionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritReconnectSame",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritResetBroken",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fInheritShadow",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fLogonDisabled",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fPromptForPassword",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fReconnectSame",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration","fResetBroken",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdleBusymsAllowed",DWORD_RETAIN,0x3c
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdleDetectAbsolute",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdleDetectProbationCount",DWORD_RETAIN,0x50
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdleInProbationCount",DWORD_RETAIN,0x23
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdlemsAllowed",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdlemsGoodProbationEnd",DWORD_RETAIN,0x9c4
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdlemsProbationTrial",DWORD_RETAIN,0x9c4
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Dos","KbdIdlemsSleep",DWORD_RETAIN,0x64
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000000",STRIG_RETAIN,"kbd101.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000001",STRIG_RETAIN,"kbdax2.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000002",STRIG_RETAIN,"kbd106.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000003",STRIG_RETAIN,"kbdibm02.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00010D01",STRIG_RETAIN,"kbdnec95.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\KOR","00000003",STRIG_RETAIN,"kbd101a.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\KOR","00000004",STRIG_RETAIN,"kbd101b.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\KOR","00000005",STRIG_RETAIN,"kbd101c.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\KOR","00000006",STRIG_RETAIN,"kbd103.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\change","logon",MULSZ_RETAIN,"0","1","LOGON","chglogon.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\change","port",MULSZ_RETAIN,"0","1","PORT","chgport.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\change","user",MULSZ_RETAIN,"0","1","USER","chgusr.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\change","winsta",MULSZ_RETAIN,"1","1","WINSTA","chglogon.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\query","appserver",MULSZ_RETAIN,"0","2","TERMSERVER","qappsrv.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\query","process",MULSZ_RETAIN,"0","1","PROCESS","qprocess.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\query","session",MULSZ_RETAIN,"0","1","SESSION","qwinsta.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\query","user",MULSZ_RETAIN,"0","1","USER","quser.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\query","winsta",MULSZ_RETAIN,"1","1","WINSTA","qwinsta.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\reset","session",MULSZ_RETAIN,"0","1","SESSION","rwinsta.exe"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Utilities\reset","winsta",MULSZ_RETAIN,"1","1","WINSTA","rwinsta.exe"

HKLM ,"SYSTEM\CurrentControlSet\Services\RDPDD\Device0","InstalledDisplayDrivers",MULSZ_RETAIN,"RDPDD"
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPDD\Device0","VgaCompatible",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\TermDD","ErrorControl",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TermDD","ImagePath",EXPND_RETAIN,"\SystemRoot\System32\drivers\termdd.sys"
HKLM ,"SYSTEM\CurrentControlSet\Services\TermDD","Start",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TermDD","Type",DWORD_RETAIN,0x1
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server","UpgradeFromTS4",DWORD_RETAIN,0x0


; Registry Entries that are new to 50 or values changed from 40 to 50 goes here
; The values that we need to retain from 40 to 50 should not go here
; [Reg.AddTo40]
; new entry
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\MCI32\Terminal Server","MCICDA.DLL",0x00000000,""
; old entry
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSOFFICE","Flags",0x00010001,0x408
; new
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","Asynchronous",0x00010001,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","DllName",0x00020000,"wlnotify.dll"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","Impersonate",0x00010001,0x0
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","Logoff",0x00000000,"TSEventLogoff"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","Logon",0x00000000,"TSEventLogon"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","PostShell",0x00000000,"TSEventPostShell"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","Shutdown",0x00000000,"TSEventShutdown"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","StartShell",0x00000000,"TSEventStartShell"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","Startup",0x00000000,"TSEventStartup"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv","MaxWait",DWORD_OWRITE,0x258
; append
HKLM ,"SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowedPaths","Machine",0x00010008,"System\CurrentControlSet\Control\Terminal Server"
HKLM ,"SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowedPaths","Machine",0x00010008,"System\CurrentControlSet\Control\Terminal Server\UserConfig"
HKLM ,"SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowedPaths","Machine",0x00010008,"System\CurrentControlSet\Control\Terminal Server\DefaultUserConfiguration"
; new
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\AddIns\Clip Redirector","Name", 0x00000000,"RDPClip"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\AddIns\Clip Redirector","Type", 0x00010001, 0x3
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\AddIns\Terminal Server Redirector","Name", 0x00000000,"\Device\RdpDr"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\AddIns\Terminal Server Redirector","Type", 0x00010001, 0x0

; overwrite
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","000000000017",0x00000000,"kbdlk41a.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","000000020015",0x00000000,"kbdnecAT.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","000000020017",0x00000000,"kbdlk41j.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000D01",0x00000000,"kbdnecNT.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00000D04",0x00000000,"kbdnecNT.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00010002",0x00000000,"kbd106n.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00010D04",0x00000000,"kbdnec95.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00020002",0x00000000,"f3ahvoas.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00020D01",0x00000000,"kbdnecAT.dll"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\KeyboardType Mapping\JPN","00020D04",0x00000000,"kbdnecAT.dll"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\Cdm"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermDD","EventMessageFile",0x00020000,"%SystemRoot%\System32\ntdll.dll"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermDD","TypesSupported",0x00010001,0x7
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermServDevices","EventMessageFile",0x00020000,"%SystemRoot%\System32\wlnotify.dll"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermServDevices","TypesSupported",0x00010001,0x7
HKLM ,"SYSTEM\CurrentControlSet\Services\PDCOMP","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\PDCOMP","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\PDCOMP","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\PDFRAME","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\PDFRAME","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\PDFRAME","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\PDRELI","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\PDRELI","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\PDRELI","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\PDRFRAME","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\PDRFRAME","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\PDRFRAME","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPDD\Device0","Attach.RelativeX",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPDD\Device0","Attach.RelativeY",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPDD\Device0","Attach.ToDesktop",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPWD","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPWD","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPWD","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TDPIPE","ErrorControl", 0x00010001, 0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\TDPIPE","Start", 0x00010001, 0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\TDPIPE","Type", 0x00010001, 0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TDTCP","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\TDTCP","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\TDTCP","Type",0x00010001,0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TermDD","DisplayName",0x00000000,"%TERMDD_DISPLAY_NAME%"
HKLM ,"SYSTEM\CurrentControlSet\Services\WDICA","ErrorControl",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Services\WDICA","Start",0x00010001,0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\WDICA","Type",0x00010001,0x1


; Registry entries that are added/changed between builds need to go here
; the entries here should only be temporary and remain only for few builds.
; these values need be moved to Reg.AddTo40 after a few builds.
;
; [Reg.AddTo50]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\vs60wiz","Flags",0x00010001,0x00008000
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Registry Entries","Microsoft\Windows\CurrentVersion\Explorer\Shell Folders",0x00010001,0x108
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\VIDEO\rdpdd","VgaCompatible",0x00000000,"\Device\Video0"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\VIDEO\rdpdd","\Device\Video0",0x00000000,"\REGISTRY\Machine\System\CurrentControlSet\Services\RDPDD\Device0"
HKLM ,"SYSTEM\CurrentControlSet\Services\LicenseService\FilePrint\TermService"
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPDD\Device0","DefaultSettings.XResolution",0x00010001,0x320
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPDD\Device0","DefaultSettings.YResolution",0x00010001,0x258

; [Reg.AddTo51]
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server", "RegistryExtensionFlags", 0x00010001, 0x3
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv", "Reconnect", 0x00000000,"TSEventReconnect"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv", "Disconnect", 0x00000000,"TSEventDisconnect"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","MinEncryptionLevel",0x00010001,0x0

HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32\Terminal Server\RDP","wave", STRIG_OWRITE,"rdpsnd.dll"
HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32\Terminal Server\RDP","MaxBandwidth", DWORD_RETAIN,0x56B9
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\AddIns\Sound Redirector","Name", STRIG_OWRITE,"RDPSound"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\AddIns\Sound Redirector","Type", DWORD_OWRITE, 0x3

HKLM ,"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\visio32","Flags",DWORD_OWRITE,0x00010000

; Registry for RDPNP as a new network provider
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPNP\NetworkProvider", "DeviceName", 0x00000000, "\Device\RdpDr"
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPNP\NetworkProvider", "Name", 0x00000000, %TS_Provider%
HKLM ,"SYSTEM\CurrentControlSet\Services\RDPNP\NetworkProvider", "ProviderPath", 0x00020000, "%SystemRoot%\System32\drprov.dll"

#ifdef TSOC_CONSOLE_SHADOWING
; Console shadow is new feature for 51
; [Reg.ConsoleShadow]
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "CdClass", DWORD_OWRITE, 0x0
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "CdDLL", STRIG_OWRITE, ""
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "CdFlag", DWORD_OWRITE, 0x0
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "CdName", STRIG_OWRITE, ""
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "CfgDll", STRIG_OWRITE, "RDPCFGEX.DLL"
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "InteractiveDelay", DWORD_OWRITE, 0x32
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "OutBufDelay", DWORD_OWRITE, 0x64
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "PdClass", DWORD_OWRITE, 0x2
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "PdDLL", STRIG_OWRITE, "tdtcp"
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "PdFlag", DWORD_OWRITE, 0x4e
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "PdName", STRIG_OWRITE, "tcp"
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "WdDLL", STRIG_OWRITE, "rdpwd"
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "WdFlag", DWORD_OWRITE, 0x34
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "WdName", STRIG_OWRITE, "Microsoft RDP 5.1"
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "WdPrefix", STRIG_OWRITE, "RDP"
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console\RDP", "WsxDLL", STRIG_OWRITE, "rdpwsx"

;
; Install the chained display driver
;
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD","ErrorControl",DWORD_RETAIN,0
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD","Group",STRIG_OWRITE,"Video Save"
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD","ImagePath",STRIG_OWRITE,"System32\DRIVERS\RDPCDD.sys"
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD","Start",DWORD_OWRITE,1
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD","Type",DWORD_OWRITE,1
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD\Video","VideoID",STRIG_OWRITE,"{DEB039CC-B704-4F53-B43E-9DD4432FA2E9}"
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD\Video","Service",STRIG_OWRITE,"RDPCDD"
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD\Device0","Device Description",STRIG_OWRITE,"RDPDD Chained DD"
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD\Device0","InstalledDisplayDrivers",MULSZ_OWRITE,"RDPDD"
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD\Device0","MirrorDriver",DWORD_OWRITE,1
HKLM,"SYSTEM\CurrentControlSet\Services\RDPCDD\Device0","VgaCompatible",DWORD_OWRITE,0
HKLM,"SYSTEM\CurrentControlSet\Control\Video\{DEB039CC-B704-4F53-B43E-9DD4432FA2E9}\Video","Service",STRIG_OWRITE,"RDPCDD"
HKLM,"SYSTEM\CurrentControlSet\Control\Video\{DEB039CC-B704-4F53-B43E-9DD4432FA2E9}\0000","Device Description",STRIG_OWRITE,"RDPDD Chained DD"
HKLM,"SYSTEM\CurrentControlSet\Control\Video\{DEB039CC-B704-4F53-B43E-9DD4432FA2E9}\0000","InstalledDisplayDrivers",MULSZ_OWRITE,"RDPDD"
HKLM,"SYSTEM\CurrentControlSet\Control\Video\{DEB039CC-B704-4F53-B43E-9DD4432FA2E9}\0000","MirrorDriver",DWORD_OWRITE,1
HKLM,"SYSTEM\CurrentControlSet\Control\Video\{DEB039CC-B704-4F53-B43E-9DD4432FA2E9}\0000","VgaCompatible",DWORD_OWRITE,0

#endif // TSOC_CONSOLE_SHADOWING

; to register Salem/WMI Compoenents
HKLM,"Software\Microsoft\Windows\CurrentVersion\RunOnce", "TS WMI tscfgwmi", STRIG_OWRITE, "regsvr32.exe /s tscfgwmi.dll"


; termsrv service related entries.
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "ErrorControl", DWORD_OWRITE, 0x1
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "ObjectName", STRIG_OWRITE, "LocalSystem"
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "Start", DWORD_OWRITE, 0x3
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "Description", STRIG_OWRITE, "%TS_SERVICE_DESC%"
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "DisplayName", STRIG_OWRITE, "%TS_DISPLAY_NAME%"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermService", "TypesSupported", DWORD_OWRITE, 0x7
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "DependOnService", MULSZ_OWRITE, "RPCSS"

#ifndef TERMSRV_PROC

HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "Type", DWORD_OWRITE, 0x20
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService\Parameters", "ServiceDll", EXPND_OWRITE, "%SystemRoot%\System32\termsrv.dll"
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermService", "EventMessageFile", EXPND_OWRITE, "%SystemRoot%\System32\termsrv.dll;%SystemRoot%\System32\ntdll.dll"

#else

HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "ImagePath", EXPND_OWRITE, "%SystemRoot%\System32\termsrv.exe"
HKLM ,"SYSTEM\CurrentControlSet\Services\TermService", "Type",DWORD_OWRITE, 0x10
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermService", "EventMessageFile", EXPND_OWRITE, "%SystemRoot%\System32\termsrv.exe;%SystemRoot%\System32\ntdll.dll"

#endif

; Session Directory Event Logging Entries
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermServSessDir", "TypesSupported", DWORD_OWRITE, 0x7
HKLM ,"SYSTEM\CurrentControlSet\Services\EventLog\System\TermServSessDir", "EventMessageFile", EXPND_OWRITE, "%SystemRoot%\System32\tssdis.exe"

; Registers .RDP file extension to mstsc
HKCR,".RDP",,,"RDP.File"
HKCR,"RDP.File",,,"%RDPFILETYPE%"
HKCR,"RDP.File","FriendlyTypeName",,"@%11%\mstsc.exe,-4004"
HKCR,"RDP.File\DefaultIcon",,,"%11%\mstsc.exe"
HKCR,"RDP.File\shell\Connect\command",,,"mstsc.exe ""%%l"""
HKCR,"RDP.File\shell\Connect",,,"%RDPCONNECTVERB%"
HKCR,"RDP.File\shell\Connect","MUIVerb",,"@%11%\mstsc.exe,-4002"
HKCR,"RDP.File\shell\Edit\command",,,"mstsc.exe -edit ""%%l"""
HKCR,"RDP.File\shell\Edit",,,"%RDPEDITVERB%"
HKCR,"RDP.File\shell\Edit","MUIVerb",,"@%11%\mstsc.exe,-4003"
HKCR,"RDP.File\shell",,,Connect

; IME table for ts client
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\JPN","msime95.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\JPN","msime97.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\JPN","imejp98.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\JPN","imejp.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\JPN","imjp8.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\JPN","imjp81.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\KOR","msime95.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\KOR","msime95k.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\KOR","msuni95k.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\KOR","imekr.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\KOR","imekr98u.ime",,"null"
HKLM,"SOFTWARE\Microsoft\Terminal Server Client\IME Mapping Table\KOR","imekr61.ime",,"null"

; Disk cleanup handlers for TS client bitmap cache files
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files",,,"{C0E13E61-0CC6-11d1-BBB6-0060978B2AE6}"
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files","FileList",,"*.BMC"
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files","Flags",DWORD_OWRITE,0x120
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files","Description",,%BMC_CLEANUP_DESC%
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files","Display",,%BMC_CLEANUP_DISPLAY%
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files","CSIDL",DWORD_OWRITE,0x1C
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files","Folder",,"Microsoft\Terminal Server Client\Cache"
HKLM,"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VolumeCaches\Remote Desktop Cache Files","LastAccess",DWORD_OWRITE,0x7

; sys procs to wait on moved to registry
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "csrss.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "smss.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "screg.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "lsass.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "spoolss.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "EventLog.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "netdde.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "clipsrv.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "lmsvcs.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "MsgSvc.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "winlogon.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "NETSTRS.EXE", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "nddeagnt.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "os2srv.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "wfshell.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "win.com", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "rdpclip.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "conime.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "proquota.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "imepadsv.exe", DWORD_OWRITE
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\SysProcs", "ctfmon.exe", DWORD_OWRITE


HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","BaudRate",DWORD_RETAIN,0xe100
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","ByteSize",DWORD_RETAIN,0x8
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","CfgDll",STRIG_RETAIN,"RDPCFGEX.DLL"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","ConnectType",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","ColorDepth",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","DeviceName",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","FlowHardwareRx",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","FlowHardwareTx",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","FlowType",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","InputBufferLength",DWORD_RETAIN,0x800
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","MinEncryptionLevel",DWORD_RETAIN,0x2
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","Parity",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","StartupPrograms",0x00000000,"rdpclip"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","StopBits",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","WdDLL",STRIG_RETAIN,"rdpwd"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","WdFlag",0x00010001,0x36
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","WdName",0x00000000,"Microsoft RDP 5.1"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","WdPrefix",STRIG_RETAIN,"RDP"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","WsxDLL",STRIG_RETAIN,"rdpwsx"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","XoffChar",DWORD_RETAIN,0x13
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","XonChar",DWORD_RETAIN,0x11
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fAutoClientDrives",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fAutoClientLpts",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableCcm",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableCdm",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableClip",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableCpm",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableEncryption",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fDisableLPT",0x00010001,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fEnableBreakDisconnect",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fEnableDTR",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fEnableDsrSensitivity",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fEnableRTS",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fFlowSoftwareRx",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fFlowSoftwareTx",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fForceClientLptDef",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd","fInheritAutoClient",0x00010001,0x1

HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","InteractiveDelay",0x00010001,0xa
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","OutBufCount",DWORD_RETAIN,0x6
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","OutBufDelay",DWORD_RETAIN,0x64
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","OutBufLength",DWORD_RETAIN,0x212
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","PdClass",DWORD_RETAIN,0x2
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","PdDLL",STRIG_RETAIN,"tdtcp"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","PdFlag",DWORD_RETAIN,0x4e
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","PdName",STRIG_RETAIN,"tcp"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","PortNumber",DWORD_RETAIN,0xd3d
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp","ServiceName",STRIG_RETAIN,"tcpip"

; console winstation.
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","Callback",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","CallbackNumber",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","Comment",STRIG_RETAIN,"System Console"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","Domain",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","InitialProgram",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","InputBufferLength",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","KeyboardLayout",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","KeyboardName",STRIG_RETAIN,"\REGISTRY\Machine\System\CurrentControlSet\Services\Kbdclass"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","MaxConnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","MaxDisconnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","MaxIdleTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","MouseName",STRIG_RETAIN,"\REGISTRY\Machine\System\CurrentControlSet\Services\Mouclass"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","OutBufCount",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","OutBufDelay",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","OutBufLength",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","Password",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","PdClass",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","PdDll",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","PdFlag",DWORD_RETAIN,0x1e
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","PdName",STRIG_RETAIN,"console"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","UserName",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","WdDll",STRIG_RETAIN,"wdcon"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","WdFlag",DWORD_OWRITE,0x24
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","WdName",STRIG_RETAIN,"Console"
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","WorkDirectory",STRIG_RETAIN,""
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritAutoLogon",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritCallback",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritCallbackNumber",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritInitialProgram",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritMaxDisconnectionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritMaxIdleTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritMaxSessionTime",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritReconnectSame",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritResetBroken",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fInheritShadow",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fLogonDisabled",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fPromptForPassword",DWORD_RETAIN,0x1
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fReconnectSame",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fResetBroken",DWORD_RETAIN,0x0
HKLM ,"SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console","fUseDefaultGina",DWORD_RETAIN,0x0
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console", "Shadow", DWORD_OWRITE, 0x1
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console", "TraceClass", DWORD_OWRITE, 0x10000009
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console", "TraceDebugger", DWORD_OWRITE, 0x1
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console", "TraceEnable", DWORD_OWRITE, 0xc
HKLM, "SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\Console", "fEnableWinStation", DWORD_OWRITE, 0x1

;
; enabling terminal services to the safeboot mode. Terminal services is enabled in the safeboot but used only for the Remote Control purposes.
; Regular clients connecting to the machine running in the safeboot mode will get disconnect immediately.
;
HKLM,"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\termservice","",STRIG_OWRITE,"Service"
HKLM,"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdsessmgr","",STRIG_OWRITE,"Service"
HKLM,"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\tdtcp.sys","",STRIG_OWRITE,"Driver"
HKLM,"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdpwd.sys","",STRIG_OWRITE,"Driver"
HKLM,"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\tdpipe.sys","",STRIG_OWRITE,"Driver"
HKLM,"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdpdd.sys","",STRIG_OWRITE,"Driver"
HKLM,"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\rdpcdd.sys","",STRIG_OWRITE,"Driver"

; This is for 32 bit Apps running on IA64
[Reg.common.ia64]
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility","SysDir",STRIG_RETAIN,""
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\ACMSETUP","Flags",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CINMANIA","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\CSETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","ClipboardFlags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","OpenClipboardDelayInMilliSecs",DWORD_RETAIN,0x50
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCEL","OpenClipboardRetries",DWORD_RETAIN,0x20
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\EXCHNG32","Flags",DWORD_RETAIN,0x008
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\FIXACLS","Flags",DWORD_RETAIN,0x408
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\HOTFIX","Flags",DWORD_RETAIN,0x28
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\INSTRUN","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MARS32","Flags",DWORD_RETAIN,0x80c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MPRADMIN","Flags",DWORD_RETAIN,0x408
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xff
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","Flags",DWORD_RETAIN,0x80c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x1
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSACCESS","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\OUTLOOK","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\PLT","Flags",DWORD_RETAIN,0x11
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\POWERPNT","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\REG2INI","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\REGEDIT","Flags",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\REGEDT32","Flags",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\RUNDLL32","Flags",DWORD_RETAIN,"0x408"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SCHDPL32","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SETUP1","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SNASRV","Flags",DWORD_RETAIN,0x200
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\SYSDIFF","Flags",DWORD_RETAIN,0x408
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VSETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WINWORD","Flags",DWORD_RETAIN,0x8
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WS32","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WS32CLN","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WS32REG","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\WSVERIFY","Flags",DWORD_RETAIN,0x40c
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSSETUP","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","FirstCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0xf
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","Flags",DWORD_RETAIN,0xc
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","MsgQBadAppSleepTimeInMillisec",DWORD_RETAIN,0x0
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\_MSTEST","NthCountMsgQPeeksSleepBadApp",DWORD_RETAIN,0x5
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\IniFiles","SYSTEM",DWORD_RETAIN,0x44
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\IniFiles","WIN",DWORD_RETAIN,0x44
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Registry Entries","Classes",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Registry Entries","Microsoft\Windows NT",DWORD_RETAIN,0x108
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Change User Option"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Security","SecurityLevel",STRIG_RETAIN,"Default"
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\MSOFFICE","Flags",0x00010001,0x408
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\vs60wiz","Flags",0x00010001,0x00008000
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Registry Entries","Microsoft\Windows\CurrentVersion\Explorer\Shell Folders",0x00010001,0x108
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server", "RegistryExtensionFlags", 0x00010001, 0x3
HKLM ,"SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\visio32","Flags",DWORD_OWRITE,0x00010000
