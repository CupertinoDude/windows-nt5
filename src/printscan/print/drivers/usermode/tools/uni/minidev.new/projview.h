/******************************************************************************

  Header File:  Project View.H

  This defines the class which provides the UI for viewing and manipulating
  project level information for the studio.

  Copyright (c) 1997 by Microsoft Corporaiton.  All Rights Reserved.

  A Pretty Penny Enterprises Production.

  Change History:
  02-03-1997    Bob_Kjelgaard@Prodigy.Net   Created it

******************************************************************************/
#if defined(LONG_NAMES)
#include    "Project Record.H"
#else
#include    "ProjRec.H"
#endif

class CProjectView : public CFormView {
protected: // create from serialization only
	CProjectView();
	CRect	crWSVOrgDims ;		// Window's original dimensions
	CRect	crWSVCurDims ;		// Window's current dimensions
	CRect	crTreeCurDims ;		// Current tree (m_ctcDriver) control dimensions
	CRect	crTreeOrgDims ;		// Original tree (m_ctcDriver) control dimensions
	CRect	crLblCurDims ;		// Current label dimensions
	CRect	crLblOrgDims ;		// Current label dimensions
	bool	bResizingOK ;		// True iff it is OK to resize the control(s)
	DECLARE_DYNCREATE(CProjectView)

// Attributes
public:
	//{{AFX_DATA(CProjectView)
	enum { IDD = IDD_ProjectForm };
	CTreeCtrl	m_ctcDriver;
	//}}AFX_DATA
	CProjectRecord* GetDocument();

// Operations
public:

// Overrides
	// ClassWizard generated virtual function overrides
	//{{AFX_VIRTUAL(CProjectView)
	public:
	virtual BOOL PreCreateWindow(CREATESTRUCT& cs);
	protected:
	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
	virtual void OnInitialUpdate(); // called first time after construct
	virtual BOOL OnPreparePrinting(CPrintInfo* pInfo);
	virtual void OnBeginPrinting(CDC* pDC, CPrintInfo* pInfo);
	virtual void OnEndPrinting(CDC* pDC, CPrintInfo* pInfo);
	//}}AFX_VIRTUAL

// Implementation
public:
	virtual ~CProjectView();
#ifdef _DEBUG
	virtual void AssertValid() const;
	virtual void Dump(CDumpContext& dc) const;
#endif

protected:

    //  Messages generated by tree view nodes derived from CProjectNode
    afx_msg void    OnExpandBranch();
    afx_msg void    OnCollapseBranch();
    afx_msg void    OnRenameItem();
    afx_msg void    OnOpenItem();
    //afx_msg void    OnGenerateItem();
    afx_msg void    OnImport();
    afx_msg void    OnDeleteItem();
    afx_msg void    OnCopyItem();
    afx_msg void    OnChangeID();
    afx_msg void    OnCheckWorkspace();

// Generated message map functions
protected:
	//{{AFX_MSG(CProjectView)
	afx_msg void OnBeginlabeleditDriverView(NMHDR* pNMHDR, LRESULT* pResult);
	afx_msg void OnEndLabelEdit(NMHDR* pNMHDR, LRESULT* pResult);
	afx_msg void OnContextMenu(CWnd* pWnd, CPoint point);
	afx_msg void OnDblclkDriverView(NMHDR* pNMHDR, LRESULT* pResult);
	afx_msg void OnFileParse();
	afx_msg void OnKeydownDriverView(NMHDR* pNMHDR, LRESULT* pResult);
	afx_msg void OnSize(UINT ntype, int cx, int cy) ;
	afx_msg void OnFileInf();
	//}}AFX_MSG
	DECLARE_MESSAGE_MAP()
};

#ifndef _DEBUG  // debug version in Project View.cpp
inline CProjectRecord* CProjectView::GetDocument()
   { return (CProjectRecord*)m_pDocument; }
#endif
/////////////////////////////////////////////////////////////////////////////
// CCopyItem dialog

class CCopyItem : public CDialog
{
// Construction
public:
	CCopyItem(CWnd* pParent = NULL);   // standard constructor
	void Init(CString cssrcfile);

// Dialog Data
	//{{AFX_DATA(CCopyItem)
	enum { IDD = IDD_CopyItem };
	CString	m_csCopyName;
	CString	m_csCopyPrompt;
	//}}AFX_DATA


// Overrides
	// ClassWizard generated virtual function overrides
	//{{AFX_VIRTUAL(CCopyItem)
	protected:
	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
	//}}AFX_VIRTUAL

// Implementation
protected:

	// Generated message map functions
	//{{AFX_MSG(CCopyItem)
		// NOTE: the ClassWizard will add member functions here
	//}}AFX_MSG
	DECLARE_MESSAGE_MAP()
};


/////////////////////////////////////////////////////////////////////////////
// CChangeID dialog

class CChangeID : public CDialog
{
// Construction
public:
	void Init(CString csrestype, CString csname, int ncurid);
	CChangeID(CWnd* pParent = NULL);   // standard constructor

// Dialog Data
	//{{AFX_DATA(CChangeID)
	enum { IDD = IDD_ChangeID };
	CString	m_csResourceLabel;
	CString	m_csResourceName;
	int		m_nCurResID;
	int		m_nNewResID;
	//}}AFX_DATA


// Overrides
	// ClassWizard generated virtual function overrides
	//{{AFX_VIRTUAL(CChangeID)
	protected:
	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
	//}}AFX_VIRTUAL

// Implementation
protected:

	// Generated message map functions
	//{{AFX_MSG(CChangeID)
	//}}AFX_MSG
	DECLARE_MESSAGE_MAP()
};


/////////////////////////////////////////////////////////////////////////////
// CDeleteQuery dialog

class CDeleteQuery : public CDialog {
// Construction
public:
	CDeleteQuery(CWnd* pParent = NULL);   // standard constructor

// Dialog Data
	//{{AFX_DATA(CDeleteQuery)
	enum { IDD = IDD_DeleteQuery };
	CString	m_csTarget;
	BOOL	m_bRemoveFile;
	//}}AFX_DATA

    void    Init(CString csrestype, CString csname) ;
    BOOL    KillFile() const { return m_bRemoveFile; }
// Overrides
	// ClassWizard generated virtual function overrides
	//{{AFX_VIRTUAL(CDeleteQuery)
	protected:
	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support
	//}}AFX_VIRTUAL

// Implementation
protected:

	// Generated message map functions
	//{{AFX_MSG(CDeleteQuery)
	afx_msg void OnNo();
	afx_msg void OnYes();
	//}}AFX_MSG
	DECLARE_MESSAGE_MAP()
};

