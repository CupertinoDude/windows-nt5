<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">


<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Microsoft Windows XP Service Pack 1 Installation and Deployment Guide</TITLE>

<STYLE type="text/css">H1 {
	CLEAR: both; FONT-SIZE: 140%; MARGIN-BOTTOM: 0.5em
}
H2 {
	CLEAR: both; MARGIN-TOP: 1.5em; FONT-SIZE: 130%; MARGIN-BOTTOM: 0.5em
}
H3 {
	CLEAR: both; MARGIN-TOP: 1.2em; FONT-SIZE: 120%; MARGIN-BOTTOM: 0.5em
}
H4 {
	CLEAR: both; MARGIN-TOP: 1.2em; FONT-SIZE: 110%; MARGIN-BOTTOM: 0.5em; MARGIN-LEFT: 1em
}
H5 {
	CLEAR: both; MARGIN-TOP: 1.2em; FONT-SIZE: 100%; MARGIN-BOTTOM: 0.5em; MARGIN-LEFT: 2em
}
H6 {
	CLEAR: both; MARGIN-TOP: 0.2em; FONT-SIZE: 70%; MARGIN-BOTTOM: 0.5em
}
P {
	MARGIN-TOP: 1.5em; MARGIN-BOTTOM: 0.6em
}
P.indent {
	MARGIN-LEFT: 3em
}
P.note {
	CLEAR: both; MARGIN-TOP: 1em; FONT-WEIGHT: bold; MARGIN-BOTTOM: -0.25em
}
P.tip {
	CLEAR: both; MARGIN-TOP: 1em; FONT-WEIGHT: bold; MARGIN-BOTTOM: -0.25em
}
P.important {
	CLEAR: both; MARGIN-TOP: 1em; FONT-WEIGHT: bold; MARGIN-BOTTOM: -0.25em
}
P.caution {
	CLEAR: both; MARGIN-TOP: 1em; FONT-WEIGHT: bold; MARGIN-BOTTOM: -0.25em
}
P.warning {
	CLEAR: both; MARGIN-TOP: 1em; FONT-WEIGHT: bold; MARGIN-BOTTOM: -0.25em
}
P.proclabel {
	CLEAR: both; FONT-WEIGHT: bold; FONT-SIZE: 100%
}
OL {
	MARGIN-TOP: 0.5em; PADDING-LEFT: .5em; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2.1em
}
OL.indent {
	MARGIN-TOP: 0.5em; PADDING-LEFT: 3em; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2.1em
}
UL {
	MARGIN-TOP: 0.6em; PADDING-LEFT: 0em; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 1.5em; LIST-STYLE-TYPE: disc
}
UL.indent {
	MARGIN-TOP: 0.5em; PADDING-LEFT: 3em; MARGIN-BOTTOM: 0px; MARGIN-LEFT: 2.1em
}
LI {
	CLEAR: both; MARGIN-BOTTOM: 0.7em
}
DD {
	MARGIN-BOTTOM: 0px; MARGIN-LEFT: 1.5em
}
CODE {
	FONT-SIZE: 105%; BACKGROUND: #ffffff; COLOR: #000000; FONT-FAMILY: Courier New, Courier, Monospace
}
BODY {
	FONT-SIZE: 80%; BACKGROUND: #ffffff; COLOR: #000000; FONT-FAMILY: Verdana, Arial, Helvetica, Sans Serif
}
TABLE {
	FONT-SIZE: 100%; BACKGROUND: #ffffff; COLOR: #000000; FONT-FAMILY: Verdana, Arial, Helvetica, Sans Serif
}
A:link {
	COLOR: #0066cc; TEXT-DECORATION: none
}
A:visited {
	COLOR: #0066cc; TEXT-DECORATION: none
}
A:hover {
	COLOR: #ff0000; TEXT-DECORATION: underline
}
A:active {
	COLOR: #ff0000; TEXT-DECORATION: underline
}
HR {
	HEIGHT: 1px
}
DIV P {
	MARGIN-LEFT: 2em
}
a.finePrint {font-size: 85%;}
</STYLE>

</HEAD>
<BODY>
<A NAME="top"><img src="../../winXP_logo_horiz_sm.gif" width="314" height="68" border="0" alt="Microsoft Windows XP"></A>
<H1>Service Pack&nbsp;1 Installation and Deployment Guide</H1>
	

<H4><A HREF="#about_this_guide_ezpd">About This Guide</A></H4>

<H4><A HREF="#what_is_the_service_pack_hjng">What Is in Service Pack 1</A></H4>

<H4><A HREF="#planning_the_deployment_ftdj">Planning the Deployment</A></H4>

<H4><A HREF="#installing_service_pack_3_for_windows_2000_jfhp">Installing Service Pack 1 for Windows XP</A></H4>

<H5><A HREF="#the_update_installation_jwbu">The Update Installation</A></H5>

<H5><A HREF="#the_integrated_installation_fmay">The Integrated Installation</A></H5>

<H4><A HREF="#removing_the_service_pack_or_the_windows_2000_hotfixes_gwvc">Removing Service Pack 1</A></H4>

<H4><A HREF="#copyright_owya">Copyright</A></H4>

<BR><BR>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="97%">
  <TBODY>
  <TR vAlign=bottom>
    <TD>
      <H1><A NAME="about_this_guide_ezpd"></A> About This Guide</H1>
	</TD>
    <TD align=right><A class="finePrint" 
      href="#top">Back 
      to Top</A></TD></TR></TBODY></TABLE>
<HR>

<P>This guide provides instructions for administrators installing Service Pack&nbsp;1 (SP1) for Microsoft&reg; Windows&reg;&nbsp;XP Home Edition, Windows&reg;&nbsp;XP Professional, and Windows&reg;&nbsp;XP 64-Bit Edition. This guide includes information for advanced users, technical details, procedures, and recommendations for successfully installing the service pack on multiple computers in a small business or corporate environment.</P>

<P>This document focuses on the key scenarios for installing the service pack either alone or with Windows&nbsp;XP.</P>
<P class="note">Note</P>
<P class="indent">If you want to install the service pack in combination with Windows&nbsp;XP hotfixes, see the <I>Microsoft Windows&nbsp;XP Hotfix Installation and Deployment Guide</I> (<A HREF=".\hfdeploy.htm" TARGET="_blank"><U>HFDeploy.htm</U></A>).</P>

<P>This guide assumes a working knowledge of Windows&nbsp;XP and service pack installations. Although some basic operating system information is included in the document, this is not a replacement for either the Windows&nbsp;XP documentation or formal training. Rather, it is intended to complement these sources of information.</P>

<P>In particular, you should use this guide in conjunction with the <I>Microsoft Windows&nbsp;XP Professional Resource Kit Documentation </I>and the <I>Microsoft Windows&nbsp;2000 Server Resource Kit</I>. For more information about these technical resources, see &quot;<A HREF="#for_more_information_lvgp">For More Information</A>&quot; later in this document.</P>

<P>The <A HREF="http://go.microsoft.com/fwlink/?LinkId=8602" TARGET="_blank"><U>Microsoft Windows&nbsp;XP Service Pack&nbsp;1 Web site</U></A> provides a list of known issues and general release notes pertaining to SP1. </P>

<H2><A NAME="organization_of_this_guide_rrmz"></A> Organization of This Guide</H2>

<P>This guide includes the following main sections:

<UL>
	<LI><B>What Is in Service Pack 1</B>
<P>You can read this section to become familiar with the service pack. This section also provides information about additional resource material that can help you plan your service pack deployment.</P>
</li>
	<LI><B>Planning the Deployment</B>
<P>This section identifies the important steps for planning your service pack deployment. You can read about the installation methods, the deployment tools and files, the supported platforms for the service pack, and the methods for testing the deployment in your environment.</P>
</li>
	<LI><B>Installing Service Pack 1 for Windows&nbsp;XP</B>
<P>You can install SP1 separately as an update or integrate it with Windows&nbsp;XP before installing the two together.

<P><B>The Update Installation</B>

<P>This section explains how to perform an <I>update installation</I> of the service pack. This type of installation entails installing SP1 separately as a standalone application in Windows&nbsp;XP. Procedures provide step-by-step instructions for the following update installation scenarios:</P>

<UL>
	<LI>Scenario 1: Installing the service pack so that computers use local service pack source files (recommended)</li>
	<LI>Scenario 2: Installing the service pack so that computers use shared, remote service pack source files</li>
	<LI>Scenario 3: Installing the service pack by using SMS</li>
	<LI>Scenario 4: Installing the service pack by using Windows Installer and Group Policy</li></UL>

<P><B>The Integrated Installation</B></P>

<P>This section explains how to create an <I>integrated installation</I> and install Windows&nbsp;XP combined with the service pack. Procedures provide step-by-step instructions for the following integrated installation scenarios:</P>

<UL>
	<LI>Scenario 1: Installing Windows&nbsp;XP integrated with the service pack</li>
	<LI>Scenario 2: Using RIS to install Windows&nbsp;XP integrated with the service pack </li></UL>
</li></UL>
<P class="note">Note</P>
<P class="indent">For details about the combination installation (installing hotfixes with Windows&nbsp;XP), see the <I>Microsoft Windows&nbsp;XP Hotfix Installation and Deployment Guide</I> (<A HREF=".\hfdeploy.htm" TARGET="_blank"><U>HFDeploy.htm</U></A>).</P>

<H2><A NAME="conventions_used_in_this_guide_iugs"></A> Terminology Used in This Guide</H2>

<P>Before you get started, it's important to understand a few specialized terms that are used in this installation and deployment guide.</P>

<P>The following table provides definitions of terms used in this guide that are specific to service pack installations or Windows&nbsp;XP, or both.</P>

<TABLE width="100%">
<tr><th align="left">Term</th><th align="left">Definition</th></tr><tr><td><I>systemroot</I></td><td>The &quot;root&quot; directory of the Windows installation on the computer's hard disk. For example, on most computers running Windows&nbsp;XP, <i>systemroot</i> is C:\WINDOWS. If you upgraded your computer to Windows&nbsp;XP from another version of Windows, <i>systemroot</i> might be C:\WINNT.</td></tr><tr><td><I>systemdrive</I></td><td>The drive where the operating system is installed. For example, on most computers, the <I>systemdrive</I> is C:\.</td></tr><tr><td><I>integrated</I></td><td>Describes the version of the service pack that comes bundled with the operating system (for example, Windows&nbsp;XP), which results in a unified operating system that is marketed as such (for example, Windows&nbsp;XP with SP1). You can also create an integrated version of Windows&nbsp;XP operating system files with SP1.</td></tr></TABLE><BR>

<H2><A NAME="for_more_information_lvgp"></A> For More Information</H2>

<P>For additional information about Windows&nbsp;XP and this service pack, see the following resources:</P>

<UL>
	<LI><B>The Readme file for SP1</B><I>,</I> which contains important information to review before you install this service pack. The (<A HREF="..\..\ReadMeSP.htm" TARGET="_blank"><U>Readme </U></A>) file is located on your SP1 CD and is available when you are running Setup (Update.exe or XPsp1.exe).</li>
	<LI><B>Windows&nbsp;XP Help</B>, which provides comprehensive topics to help you learn more about the features and functions of Windows&nbsp;XP.</li>
	<LI><B>The Microsoft Windows&nbsp;XP Professional Resource Kit Documentation</B><I>,</I> which contains detailed instructions for deploying Windows&nbsp;XP Professional in an organization. This resource kit includes information for managers, network architects, system administrators, and other people in an IT organization who are involved in planning a Windows&nbsp;XP deployment. The resource kit is available on the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8420" TARGET="_blank"><U>Microsoft Windows Resource Kits Web site</U></A> and also from <A HREF="http://go.microsoft.com/fwlink/?LinkId=9324" TARGET="_blank"><U>Microsoft Press</U></A>.</li>
	<LI>The <A HREF="http://go.microsoft.com/fwlink/?LinkId=9325" TARGET="_blank"><U>Microsoft Windows Catalog Web site</U></A>, which provides the most up-to-date information about supported hardware and software products.</li>
	<LI>The <A HREF="http://go.microsoft.com/fwlink/?LinkId=9323" TARGET="_blank"><U>Microsoft Windows Update Web site</U></A>, which provides information about and downloads of various Windows software (including drivers).</li>
	<LI>The <A HREF="http://go.microsoft.com/fwlink/?LinkId=9326" TARGET="_blank"><U>Microsoft Knowledge Base Web site</U></A>, which provides updated information about Windows&nbsp;XP.</li></UL>

<BR><BR>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="97%">
  <TBODY>
  <TR vAlign=bottom>
    <TD>
      <H1><A NAME="what_is_the_service_pack_hjng"></A> What Is in Service Pack 1</H1>
	</TD>
    <TD align=right><A class="finePrint" 
      href="#top">Back 
      to Top</A></TD></TR></TBODY></TABLE>
<HR>

<P>This service pack is a collection of updates to Windows&nbsp;XP. To help you learn more about the service pack, this section discusses the following topics:</P>

<UL>
	<LI>The service pack CD contents.</li>
	<LI>The service pack information on the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8602" TARGET="_blank"><U>Microsoft Windows&nbsp;XP Service Pack&nbsp;1 Web site</U></A>, which provides details about the fixes included in the service pack.</li>
	<LI>The list of fixes included in the service pack in article<A HREF="http://go.microsoft.com/fwlink/?LinkId=8343" TARGET="_blank"> <U>Q324720</U></A>, &quot;List of fixes in Windows&nbsp;XP Service Pack 1,&quot; in the Microsoft Knowledge Base.</li>
	<LI>The service pack features.</li></UL>
<P class="important">Important</P>
<P class="indent">Although SP1 is not a required upgrade, there are fixes included in this release that might improve the way your programs run with Windows&nbsp;XP.</P>

<H2><A NAME="service_pack_cd_contents_fjiv"></A> Service Pack CD Contents</H2>

<P>The SP1 CD includes the following items:</P>

<UL>
	<LI>Service pack installation files that you can extract from the XPsp1.exe file. This file contains all of the service pack binary files that have been updated for SP1; it also contains the Update.exe program file.
<P>XPsp1.exe is a self-extracting compressed file. You can extract all of the files it contains and proceed by using command-line options to determine the type of installation. For example, you can extract all of the files to a shared network folder and then use Update.exe (included on the SP1 CD) to upgrade individual computers.</P>

<P>If you run this program without command-line options, all of the SP1 files will be installed on the local computer, which is the default installation location. For more information about command-line options, see &quot;<A HREF="#command_line_switches_for_update_exe_and_w2ksp3_exe_nthj">Command-Line Options for XPsp1.exe and Update.exe</A>&quot; later in this document.</P>
</li>
	<LI>Service pack documentation. Be sure to read the SP1 Readme file (<A HREF="..\..\ReadMeSP.htm" TARGET="_blank"><U>ReadMe</U></A>), which contains information that all users should familiarize themselves with.</li></UL>

<P>The SP1 CD also contains the following documents and tools for advanced users and administrators:</P>

<UL>
	<LI>The <I>Microsoft Windows&nbsp;XP Hotfix Installation and Deployment Guide,</I> which provides instructions for installing hotfixes on multiple computers. This guide is located on your SP1 CD in the \Support\Tools folder (see <A HREF=".\HFDeploy.htm" TARGET="_blank"><U>HFDeploy.htm</U></A>).</li>
	<LI>The Deploy.cab file, which is a compressed file that contains a collection of tools and is located on the CD in the \Support\Tools folder. Note that Deploy.cab is not automatically loaded when you install SP1. For information about these tools, see the <I>Microsoft Windows Corporate Deployment Tools User's Guide</I> (deploy.chm) and the <I>Microsoft Windows Preinstallation Reference Help</I> (ref.chm), included in Deploy.cab in the \support\tools folder.</li>
	<LI>The Support.cab file, which is a compressed file that contains a collection of tools and is located in the \Support\Tools folder. The updated Windows&nbsp;XP support tools in this file help support personnel and network administrators manage their networks and troubleshoot problems. Note that Support.cab is not automatically loaded when you install SP1. 
<P>For more information on the support tools, see:</P>

<UL>
	<LI><I>Windows Support Tools</I> <I>Help</I> (suptools.chm in Support.cab). This Help file provides descriptions of the support tools and examples of how they are used. </li>
	<LI><i>Release Notes (Readme.htm) for Windows Support Tools for Microsoft Windows&nbsp;XP Professional and Windows&nbsp;XP 64-Bit Edition</I>, which is located in the \support\tools folder. </li>
	<LI>The article <A HREF="http://go.microsoft.com/fwlink/?LinkId=8972" TARGET="_blank"><U>Q325896</U></A>, &quot;Updated Support Tools for Windows XP SP1,&quot; in the Microsoft Knowledge Base.</li></UL>
</li></UL>

<H2><A NAME="service_pack_web_site_bfjk"></A> Service Pack Web Site</H2>

<P>All files and programs included on the SP1 CD are also available on the Web. On the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8602" TARGET="_blank"><U>Microsoft Windows&nbsp;XP Service Pack&nbsp;1 Web site</U></A>, you can view a list of fixes included in the service pack, which includes a list of files affected by SP1. The Web site also includes details about known issues, and general release notes for the service pack.</P>

<P>There are also two installation options available from this Web site, as described in the following paragraphs. Note that both of these installations provide you with the exact same software. </P>

<UL>
	<LI><B>The Express installation</B>
<P>This installation package includes only the files required to start the installation and connect to a download server: the information (.inf) file, the version (.ver) file, and a URL that points to the download server on the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8602" TARGET="_blank"><U>Microsoft Windows&nbsp;XP Service Pack&nbsp;1 Web site</U></A>. The remaining files you need are identified and downloaded when you link to the download server. Because the Express installation detects the service pack files that are already installed on your computer and installs only those files that need to be updated, the download time is significantly reduced.</P>
</li>
	<LI><B>The Network installation</B>
<P>This is a full self-extractable package that contains all of the files required for a service pack installation. This installation option downloads all of the SP1 files to your computer from the network you are connected to. This is ideal for administrators who want to set up a shared network folder for deploying the service pack on multiple computers.</P>
</li></UL>

<H3><A NAME="service_pack_debugging_symbols_dkme"></A> Service Pack Debugging Symbols</H3>

<P>The debugging symbol files are recommended for system administrators and other advanced users who will be diagnosing Windows&nbsp;XP system problems.</P>

<P>These symbols are located on your SP1 CD in the \support\symbols folder (symbols.exe). During the installation process, the service pack debugging symbol files are copied over any existing versions of the debugging symbol files in the symbol installation folder.</P>

<p class="note">Note</p>
<P class="indent">You do not need to have debugging symbols installed for your computer to operate properly.</P>

<P>You can also download symbols from the <A HREF="http://go.microsoft.com/fwlink/?LinkId=7682" TARGET="_blank"><U>How to Get Symbols</U></A> page on the Microsoft Windows Driver Development Kits (DDK) Web site. This page also contains information about the Microsoft Symbol Server, which enables you to download symbols on demand during a debugging session. For more information and to obtain the most current version of the debugging tools for Windows, see the <A HREF="http://go.microsoft.com/fwlink/?LinkId=9328" TARGET="_blank"><U>Microsoft Debugging Tools</U></A> page on the Microsoft Windows DDK Web site.</P>

<H2><A NAME="service_pack_updates_swnw"></A> Service Pack 1 Updates</H2>

<P>To help you decide whether to upgrade to this service pack, Microsoft provides extensive documentation about the service pack updates. You will find the current list of fixes and general release note items (for example, space requirements for installing SP1) on the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8602" TARGET="_blank"><U>Microsoft Windows&nbsp;XP Service Pack&nbsp;1 Web site</U></A>.</P>

<P>The service pack is a collection of updates for Windows&nbsp;XP. These updates address:</P>

<UL>
	<LI>Security issues (including the Windows&nbsp;XP Update Package)</li>
	<LI>Operating system reliability</li>
	<LI>Application compatibility</li>
	<LI>Windows&nbsp;XP Setup</li></UL>
<P class="note">Note</P>
<P class="indent">If you have not yet installed the Windows&nbsp;XP Update Package, you only need to install Service Pack 1 because the security update is included. </P>

<P class="indent">For further information about the Windows&nbsp;XP Update Package, see article <A HREF="http://go.microsoft.com/fwlink/?LinkId=8683" TARGET="_blank"><U>Q309521</U></A>, &quot;Windows&nbsp;XP Update Package, October 25, 2001,&quot; in the Microsoft Knowledge Base.</P>

<H2><A NAME="the_service_pack_3_update_exe_installation_program_qvyt"></A> Service Pack&nbsp;1 Features</H2>

<P>SP1 includes the features listed and described in the following paragraphs.</P>

<UL>
	<LI><B>One-time installation</B>
<P>After you have installed the service pack, you do not need to reinstall it if you add a device or new software to your computer. For example, Windows&nbsp;XP includes a file named Driver.cab, which contains all of the files potentially installed by Plug and Play (PnP)-class installers. Setup and other components use this file to install the drivers for new devices (for example, a PCMCIA card or a USB keyboard) without requiring access to the Windows&nbsp;XP CD or the network.</P>

<P>The service pack does not update the Driver.cab file itself; instead, the Update.exe program installs an additional driver file named Sp1.cab. This file contains only updated versions of drivers that exist in the original Windows&nbsp;XP Driver.cab file. In addition to the Sp1.cab file, the Update.exe program installs a new Drvindex.inf that points to Sp1.cab for all of the updated drivers and also points to Driver.cab for all of the remaining drivers.</P>

<P>Update.exe installs a Layout.inf file. Layout.inf ensures that the correct software is installed and that all the correct updates are made to Windows&nbsp;XP when you remove services from or add services to your computer. For example, if you remove a service from Microsoft Windows&nbsp;NT&reg;&nbsp;4.0 and then reinstall it there, you must reinstall the service pack after you reinstall the service. This is unnecessary in Windows&nbsp;XP. The Layout.inf file is updated automatically to determine which files must be installed from the original Windows&nbsp;XP CD or from the service pack and, if necessary, the file prompts for the appropriate media.</P>

<P>For more information about this feature, see article <A HREF="http://go.microsoft.com/fwlink/?LinkId=9295" TARGET="_blank"><U>Q327393</U></A>, &quot;Not Necessary to Reinstall Windows&nbsp;XP Service Packs After System State Changes,&quot; in the Microsoft Knowledge Base.</P>
</li>
	<LI><B>Integration installation support</B>
<P>You can integrate the service pack with a Windows&nbsp;XP installation. You do not need to perform separate installations of Windows&nbsp;XP and the service pack. For more information about this installation method, see &quot;<A HREF="#the_integrated_installation_fmay">The Integrated Installation</A>&quot; later in this document.</P>
</li>
	<LI><B>Svcpack.log file creation</B>
<P>The Update.exe program creates a log file in <I>systemroot</I> named Svcpack.log. This log file contains the following information:</P>

<UL>
	<LI>The command-line utility that initiated the Update.exe program.</li>
	<LI>A list of the files that the Update.exe program copied to your computer.</li></UL>
</li></UL>

<H3><A NAME="command_line_switches_for_update_exe_and_w2ksp3_exe_nthj"></A> Command-Line Options for XPsp1.exe and Update.exe </H3>

<P>To deploy the service pack, you can run the XPsp1.exe program, which extracts the contents of the service pack. After this, the Update.exe program runs automatically to install the service pack. You can define the way these steps are completed by using the options explained in this section.</P>

<P>The following table describes the command-line options that both the Update.exe and XPsp1.exe programs support. You include the options you want to use when you enter the command to extract files from XPsp1.exe. The options, which are passed to Update.exe, dictate the specifics of the installation process; they do not, however, affect the way the files are extracted. All of the options listed in the table include a forward slash (/), but you can use a hyphen (-) instead, if you prefer. The options work the same way with either symbol.</P>

<TABLE width="100%">
<tr><th align="left">Command-line option</th><th align="left">Description</th></tr><tr><td><B>/U</B></td><td>Uses unattended Setup. If you use this option, only <I>critical</I> error prompts will appear on-screen during the installation process.</td></tr><tr><td><B>/F</B></td><td>Forces other applications to close at shutdown.</td></tr><tr><td><B>/N</B></td><td>Does not back up files for removing the service pack.</td></tr><tr><td><B>/O</B></td><td>Overwrites OEM files without prompting.</td></tr><tr><td><B>/Z</B></td><td>Does not restart the computer after the installation is completed.</td></tr><tr><td><B>/Q</B></td><td>Uses quiet mode (the same as unattended mode, but with the user interface hidden from view). If you use this option, no prompts will appear on-screen during the installation process.</td></tr><tr><td><B>/L</B></td><td>Lists installed hotfixes.</td></tr><tr><td><B>/S:</B>&lt;<I>foldername</I>&gt;</td><td>Combines Windows&nbsp;XP with SP1 in a shared distribution folder for an integrated installation.</td></tr></TABLE><BR>

<H4>Using Command-Line Options</H4>

<P>You can use these options to install the service pack as follows:

<UL>
	<LI>For an unattended installation, use the <B>/U</B> option: 
<P><B>XPsp1.exe /U</B></P>

<P>Use this option to install the service pack using all the default options. The installation will not prompt you for any input, but the installation progress bar in the user interface is displayed throughout the installation process. For details about using unattended Setup, see <I>Microsoft Windows Preinstallation Reference Help</I> (ref.chm), unattend.txt topic, in deploy.cab on your CD in the \support\tools folder.</P>
</li>
	<LI>To set XPsp1.exe to close all other applications after upgrading to SP1, use the <B>/F</B> option:
<P><B>XPsp1.exe /F</B></P>

<P>After the installation is completed, you must close all open programs before restarting the computer. To force applications to close without saving files, use the <B>/F</B> option. You can use this option in conjunction with other command-line options, with the exception of <B>/S</B> (used for an integrated installation), <B>/L</B> (used to list installed hotfixes), and <B>/Z</B> (used to prevent the restart from automatically occurring after the installation).</P>
</li>
	<LI>To prevent the automatic creation of backup files for removing the service pack, use the <B>/N</B> option:
<P><B>XPsp1.exe /N</B></P>

<P>If you select this option, the files needed to remove the service pack will not be backed up during the installation. This can help save disk space but also means that you will not be able to remove the service pack at a later date. If you use this option, the <B>Add or Remove Programs</B> entry is not added for removing the service pack at some point in the future.</P>

<P>You can use this option in conjunction with other command-line options, with the exception of <B>/S</B> (used for an integrated installation only) and <B>/L</B> (used for installing hotfixes).</P>
</li>
	<LI>To update OEM-supplied files without prompts, use the <B>/O</B> option:
<P><B>XPsp1.exe /O</B>

<P>For example, if you have OEM-specific drivers installed on your computer, using the <B>/O</B> option enables these drivers to be updated without prompting you first.</P>
<P class="note">Note</P>
<P class="indent">If you use the <B>/Q</B> or <B>/U</B> option to run Update.exe in quiet or unattended Setup mode and want to update OEM-supplied files, you must also use the <B>/O</B> option. If you do not use the <B>/O</B> option, files such as the hardware abstraction layer (HAL) and disk miniport drivers are not updated.</P>
</li>
	<LI>To prevent the computer from automatically restarting after the service pack is installed, use the <B>/Z</B> option:
<P><B>XPsp1.exe /Z</B>

<P>If you do not want the computer to restart automatically after the service pack installation is completed, use this option. You can use this option in conjunction with other command-line options, with the exception of <B>/S</B> and <B>/L</B>.</P>
</li>
	<LI>For a quiet installation, use the <B>/Q</B> option:
<P><B>XPsp1.exe /Q</B></P>

<P>Use this option to install SP1 the same way as described for the unattended installation. However, neither the progress bar in the user interface nor any errors that might occur are displayed during installation.</P>
</li>
	<LI>To list hotfixes that are currently installed, use the <B>/L</B> option:
<P><B>XPsp1.exe /L</B></P>

<P>If you want to display all of the hotfixes that are currently installed on the computer, use this option. This option is not designed for use with any other command-line options.</P>
</li>
	<LI>To see which hotfixes and service pack version are installed at any given time, type the following:
<P><B>Qfecheck.exe</B></P>

<P>For more information about the Qfecheck.exe program, see the following articles in the Microsoft Knowledge Base:</P>

<UL>
	<LI><A HREF="http://go.microsoft.com/fwlink/?LinkId=9117" TARGET="_blank"><U>Q282784</U></A>: &quot;Qfecheck.exe Verifies the Installation of Windows&nbsp;2000 and Windows&nbsp;XP Hotfixes&quot;</li>
	<LI><A HREF="http://go.microsoft.com/fwlink/?LinkId=9118" TARGET="_blank"><U>Q304864</U></A>: &quot;Qfecheck Hotfix Tool Reports False Need to Reinstall Freshly Installed Hotfixes&quot;</li></UL>
</li>
	<LI>To deploy Windows&nbsp;XP with SP1, use the <B>/S</B>:&lt;<I>foldername</I>&gt; option in the following command:
<P><B>XPsp1.exe /S:&lt;</B><I>foldername</I><B>&gt;</B>

<P>If you want to deploy Windows&nbsp;XP with SP1 as an integrated installation, you can use this option to build an integrated shared network folder that contains files for Windows&nbsp;XP and SP1. You can use this shared folder to install both Windows&nbsp;XP and the service pack together by using the integrated installation, thus saving time. This feature is not available for hotfixes. For information on how to create and install the integrated version of Windows&nbsp;XP with SP1, see &quot;<A HREF="#scenario_1_installing_windows_2000_integrated_with_the_service_pack_rpmd">Scenario 1: Installing Windows XP Integrated with the Service Pack</A>&quot; later in this document.</P>
</li></UL>

<H4>Command-Line Options for XPsp1.exe Only</H4>

<P>The following table identifies additional command-line options that only the XPsp1.exe program supports.</P>

<TABLE width="100%">
<tr><th align="left">Command-line option</th><th align="left">Description</th></tr><tr><td><B>/X</B></td><td>Extracts service pack files without starting Update.exe.
<P>You are prompted to provide the path for the folder to which you want to extract XPsp1.exe.</P>
</td></tr><tr><td><B>/U/ X:</B>&lt;<I>foldername</I>&gt;</td><td>Extracts service pack files to the &lt;<I>foldername</I>&gt; folder without prompting and without starting Update.exe.</td></tr></TABLE><BR>

<BR><BR>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="97%">
  <TBODY>
  <TR vAlign=bottom>
    <TD>
      <H1><A NAME="planning_the_deployment_ftdj"></A> Planning the Deployment</H1>
	</TD>
    <TD align=right><A class="finePrint" 
      href="#top">Back 
      to Top</A></TD></TR></TBODY></TABLE>
<HR>

<P>To ensure a successful deployment of the service pack, prepare for your deployment by assessing the updates and enhancements contained in the service pack and determining how they affect your organization. After you have assessed deploying the service pack in your organization, complete these important planning tasks:</P>

<UL>
	<LI>Choose an installation method.</li>
	<LI>Identify the deployment tools and files.</li>
	<LI>Determine upgrade options.</li>
	<LI>Check space requirements.</li>
	<LI>Test the deployment in your environment.</li></UL>

<P>The following sections describe these tasks. For a complete list of and detailed information about deployment planning tasks and strategies, see the <I>Microsoft Windows&nbsp;XP Professional Resource Kit Documentation. </I>This guide, which you will find on the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8420" TARGET="_blank"><U>Microsoft Windows Resource Kits Web site</U></A>, is an important tool to use as you design, plan, and develop your deployment of Windows&nbsp;XP as well as Windows&nbsp;XP service packs. It addresses planning information that can help you get started, such as how to create a deployment plan and how to run a pilot project.</P>

<H2><A NAME="choosing_an_installation_method_ejid"></A> Choosing an Installation Method</H2>

<P>The service pack supports the following installation methods:</P>

<UL>
	<LI>The <I>update installation,</I> which is the standard method also used to install Windows&nbsp;2000 and Microsoft Windows&nbsp;NT service packs. If you have previously installed a Windows&nbsp;NT&nbsp;4.0 service pack or a Windows&nbsp;2000 service pack, you should already be familiar with the update installation method.</li>
	<LI>The <I>integrated installation,</I> which you can use with SP1. The integrated installation method allows you to simultaneously install Windows&nbsp;XP and the service pack.</li>
	<LI>The <I>combination installation,</I> which enables you to install the service pack with a variety of other components by using a combination of update and integrated installation processes. This type of installation is explained in the <I>Microsoft Windows&nbsp;XP Hotfix Installation and Deployment Guide</I> (see <A HREF=".\hfdeploy.htm" TARGET="_blank"><U>HFDeploy.htm</U></A>).</li></UL>

<P>For more information about the update and integrated installation methods, see these sections later in this document:</p>

<UL>
	<LI><A HREF="#the_update_installation_jwbu">The Update Installation</A></li>
	<LI><A HREF="#the_integrated_installation_fmay">The Integrated Installation</A></li></UL>

<H2><A NAME="identifying_the_deployment_tools_and_files_hdts"></A> Identifying the Deployment Tools and Files</H2>

<P>After you select your installation method , review the corresponding scenario in the &quot;<A HREF="#installing_service_pack_3_for_windows_2000_jfhp">Installing Service Pack&nbsp;1 for Windows&nbsp;XP</A>&quot; section later in this document to determine the necessary deployment tools and files.</P>

<P>This section provides a brief overview of common deployment tools and files. For more detailed information about a specific deployment tool or file, see:</P>

<UL>
	<LI>The <A HREF="http://go.microsoft.com/fwlink/?LinkId=8420" TARGET="_blank"><U>Microsoft Windows Resource Kits Web site</U></A>.</li>
	<LI>The <I>Microsoft Windows Corporate Deployment Tools User's Guide</I> (deploy.chm) and the <I>Microsoft Windows Preinstallation Reference Help</I> (ref.chm), on your CD in the \support\tools folder included in Deploy.cab.</li>
	<LI>The <I>Windows Support Tools</I> <I>Help</I> (suptools.chm in Support.cab). This Help file provides descriptions of the support tools and examples of how they are used. </li>
	<LI>The <I>Release Notes (Readme.htm) for Windows Support Tools for Microsoft Windows&nbsp;XP Professional and Windows&nbsp;XP 64-Bit Edition</I>, which is located in the \support\tools folder. </li></UL>

<P>Depending on the scenario you choose, you might need one or more of the following deployment tools and files:</P>

<UL>
	<LI><B>Microsoft Systems Management Server</B>
<P>Microsoft Systems Management Server (SMS) provides a variety of tools to help you deploy the service pack in your organization. With the SMS version 2.0 software distribution feature, you can automatically upgrade all of the SMS client computers in your organization with the new service pack. You can allow users to run the service pack installation whenever they like, or you can schedule the service pack installation to run at a specific time. You can also schedule it to run on SMS client computers at a time when the users are not logged on. </P>

<P>For details about deploying SP1 using SMS, see article <A HREF="http://go.microsoft.com/fwlink/?LinkId=8969" TARGET="_blank"><U>Q326696</U></A>, &quot;Installing the Windows&nbsp;XP Service Pack&nbsp;1 by Using SMS,&quot; in the Microsoft Knowledge Base.</P>
<P class="note">Note</P>
<P class="indent">SMS provides tools for upgrading your current computers, but not for the installation of new computers that do not have an operating system already installed. Upgrades from other versions of Windows (including Windows&nbsp;NT&nbsp;4.0) are possible with SMS.
</li>
	<LI><B>Microsoft Windows Installer</B>
<P>Windows Installer is a Windows&nbsp;XP component that standardizes and simplifies the way you install and manage software programs (such as the service pack) on multiple computers. This installation service enables you to manage the installation, modification, repair, and removal of programs. Windows Installer facilitates consistent deployment, enabling you to manage shared resources, customize installation processes, make decisions about application usage, and resolve configuration problems. </P>
</li>
	<LI><B>The Unattend.txt answer file</B>
<P>For integrated installations only, the Unattend.txt answer file identifies how Windows&nbsp;XP Setup interacts with the distribution folders and files you create, and it supplies information about your preinstallation requirements. The answer file also supplies Setup with all of the information that the end user is prompted to provide during a typical Windows&nbsp;XP installation. For example, the Unattend.txt file contains a <I>FullName</I> entry in the [UserData] section. This entry instructs Windows&nbsp;XP Setup to prompt the user to provide a full name. You can create or modify the Unattend.txt file by using either a text editor or Setup Manager. Make sure that only the system administrator has write access to this file.</P>
<P class="note">Note</P>
<P class="indent">For more information, see the Microsoft Windows Preinstallation Reference Help (ref.chm), unattend.txt topic in deploy.cab on your CD in the \support\tools folder.
</li></UL>

<H2><A NAME="determining_upgrade_options_fpvm"></A> Determining Upgrade Options</H2>

<P>Before you deploy the service pack in your organization, consider the upgrade paths supported by update and integrated installations: </P>

<UL>
	<LI><B>Update installations</B>
<P>You start the service pack installation either by double-clicking the XPsp1.exe icon or by running Update.exe after extracting the contents of XPsp1.exe by using a command-line option.</P>
</li>
	<LI><B>Integrated installations</B></P>
<P>You run Windows&nbsp;XP Setup from a shared distribution folder that was previously updated with SP1 by using the <B>/S </B>option (see &quot;<A HREF="#the_integrated_installation_fmay">The Integrated Installation</A>&quot; earlier in this document).</P>
</li></UL>

<P>The following table shows which Windows versions are and are not supported for these two types of SP1 installations.</P>

<TABLE width="100%">
<tr><th align="left">Windows&nbsp;version</th><th>Supported for update installations of Service Pack&nbsp;1</th><th>Supported for integrated installations of Service Pack&nbsp;1</th></tr><tr><td>Windows&nbsp;95</td><td>No</td><td>No (clean installation is possible)</td></tr><tr><td>Windows&nbsp;98</td><td>No</td><td>Yes</td></tr><tr><td>Windows&nbsp;98 Second&nbsp;Edition</td><td>No</td><td>Yes</td></tr><tr><td>Windows&nbsp;NT&nbsp;3.51</td><td>No</td><td>No</td></tr><tr><td>Windows&nbsp;NT&nbsp;4.0&nbsp;Workstation</td><td>No</td><td>Yes</td></tr><tr><td>Windows Millennium&nbsp;Edition</td><td>No</td><td>Yes</td></tr><tr><td>Windows&nbsp;2000 Professional</td><td>No</td><td>Yes</td></tr><tr><td>Windows&nbsp;XP Home&nbsp;Edition</td><td>Yes</td><td>Yes</td></tr><tr><td>Windows&nbsp;XP&nbsp;Professional</td><td>Yes</td><td>Yes</td></tr><tr><td>Windows&nbsp;XP&nbsp;64-Bit&nbsp; Edition</td><td>Yes</td><td>Yes</td></tr></TABLE><BR>

<H2><A NAME="checking_space_requirements_btkt"></A> Checking Space Requirements</H2>

<P>Disk space requirements vary according to the version of Windows&nbsp;XP you are installing: Windows&nbsp;XP Home Edition, Windows&nbsp;XP Professional, and Windows&nbsp;XP 64-Bit Edition. For specific information about the space you will need to install SP1 on a given version of Windows&nbsp;XP, see article <A HREF="http://go.microsoft.com/fwlink/?LinkId=8804" TARGET="_blank"><U>Q326583</U></A>, &quot;Hard Disk Space Requirements for Windows&nbsp;XP Service Pack&nbsp;1,&quot; in the Microsoft Knowledge Base.</P>

<H2><A NAME="space_requirements_for_other_windows_2000_server_applications_mxwx"></A> Testing the Deployment in Your Environment</H2>

<P>Although Microsoft has a high degree of confidence in this service pack, we cannot test all possible hardware configurations and line-of-business (LOB) applications that might be present in all environments. Instead, we recommend that you test the service pack in your environment before you deploy it to all of your users. </P>

<P>Testing the service pack in your environment can include, but is not limited to, the following procedure.</P>

<P class="proclabel">To test the service pack in your environment</p>
<OL>
	<LI>Take a cross-section of the types of computers used in your environment that should receive the service pack. Make sure that the computers you are using for the test are equipped with the software and the hardware devices that are typically used in your business.</li>
	<LI>Install the service pack on each of these computers in the same way that you expect to do in your specific environment. Make sure that you perform each of the following actions:
<UL>
	<LI>Update existing computers that are running Windows&nbsp;XP to SP1.</li>
	<LI>Upgrade existing computers that are running Microsoft Windows&nbsp;98, Windows&nbsp;NT&nbsp;4.0, or Windows&nbsp;2000 Professional, to Windows&nbsp;XP integrated with SP1.</li>
	<LI>Install Windows&nbsp;XP integrated with SP1 to a computer with no previous or existing operating system (that is, perform a <I>clean installation</I>).</li></UL>
</li>
	<LI>Verify that the software and hardware continue to work as expected for the various scenarios.
<P>If you are installing Windows&nbsp;XP for the first time in your company or a particular division of your company, you might want to set up a pilot group to help test your deployment and verify that it works in your environment as expected.
</li></OL>

<P>For more information about planning for, testing, and deploying Windows&nbsp;XP in your environment, see the deployment information included on the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8420" TARGET="_blank"><U>Microsoft Windows Resource Kits Web site</U></A>.</P>

<BR><BR>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="97%">
  <TBODY>
  <TR vAlign=bottom>
    <TD>
      <H1><A NAME="installing_service_pack_3_for_windows_2000_jfhp"></A> Installing Service Pack&nbsp;1 for Windows&nbsp;XP</H1>
	</TD>
    <TD align=right><A class="finePrint" 
      href="#top">Back 
      to Top</A></TD></TR></TBODY></TABLE>
<HR>

<P>The following sections provide instructions for installing SP1. You can either update computers already running Windows&nbsp;XP or complete an integrated installation by installing Windows&nbsp;XP and the service pack together.</P>

<P>For either type of installation, administrative logon credentials are required. To install the service pack on a given computer or over a network, you must be logged on as an administrator.</P>

<H2><A NAME="the_update_installation_jwbu"></A> The Update Installation</H2>

<P>During the update installation, the service pack is installed on a computer that is already running Windows&nbsp;XP. When you run the Update.exe program, it installs the updated system files and makes the necessary registry changes. After the computer is restarted, the installation is complete and Windows&nbsp;XP runs with an updated file set.</P>

<P>This section describes the steps involved in the following update installation scenarios:</P>

<UL>
	<LI>Scenario 1: Installing the service pack so that computers use local service pack source files (recommended)</li>
	<LI>Scenario 2: Installing the service pack so that computers use shared remote service pack source files</li>
	<LI>Scenario 3: Installing the service pack by using SMS </li>
	<LI>Scenario 4: Installing the service pack by using Windows Installer and Group Policy </li></UL>
<P class="important">Important</P>
<P class="indent">If a system file on a computer becomes corrupted or needs replacing for some other reason, you will need the service pack source files to replace that system file.</P>

<P>This service pack supports several types of distribution media, including CD-ROMs, shared folders on networks, and Web downloads. Because this guide is intended for corporate audiences, the update installation scenarios described in this document focus on the use of shared distribution folders on networks, which is the most common distribution medium for this audience.</P>

<P>Depending on your installation requirements, you can choose from the various update scenarios presented in this section.</P>

<H3><A NAME="scenario_1_installing_the_service_pack_on_computers_running_windows_2000_slwy"></A> Scenario 1:  Installing the service pack so that computers use local service pack source files (recommended)</H3>

<P>This method enables you to set up a shared distribution folder on a network so that users can upgrade their computers from a central point and store their system backup files locally.</P>

<P>You can do this by starting the XPsp1.exe program (setting whatever options you want to use). You can also create logon scripts for users, which will ensure that they can upgrade to SP1 when they next use their computers.</P>
<P class="note">Note</P>
<P class="indent">In the following procedure, &quot;E:\&quot; represents the drive name of the network or computer where your distribution folder is located.</P>

<P class="proclabel">To install the service pack </p>
<OL>
	<LI>Connect to the network or computer on which you want to create the distribution folder.</li>
	<LI>In the shared folder on the network, create a distribution folder for the service pack.
<P>For example, to create a distribution folder named XPSP1, type the following at the command prompt:</P>

<P><B>mkdir E:\XPSP1</B>
</li>
	<LI>Copy XPsp1.exe into the distribution folder you created in step 2.</li>
	<LI>Before you begin the installation, be sure to stop any real-time virus checkers that are running on the computers on which you will be installing the service pack.
<P>This is an important first step, as real-time virus checkers could cause problems with the installation if they are running. For each computer you plan to upgrade, back up the files and close any open programs before you continue (unless you plan to force programs to close during the installation).</P>
</li>
	<LI>To install the service pack from the distribution folder (in this example, named XPSP1), type the following at the command prompt:
<P><B>E:\XPSP1\XPsp1.exe</B>

<P>You can include command-line options as needed. For example, to force programs to close when the service pack installation starts, include the /F option in the installation command. For more information about command-line options, see &quot;<A HREF="#command_line_switches_for_update_exe_and_w2ksp3_exe_nthj">Command-Line Options for XPsp1.exe and Update.exe</A>&quot; earlier in this document.</P>

<P>The progress of the installation is displayed as files are verified and extracted. As soon as this process is completed, the Windows&nbsp;XP SP1 Setup Wizard appears. Follow the instructions given by the Setup Wizard. When you are prompted to select whether to archive files, you are advised to select the <B>Archive Files</B> option to ensure that you can remove the service pack later if you want to.</P>
</li>
	<LI>After the installation is completed, the Setup Wizard gives you the option to restart the computer either now or later. It is recommended that you immediately restart the computer. 
<P>If you want to install hotfixes, see the <I>Microsoft Windows&nbsp;XP Hotfix Installation and Deployment Guide</I> (<A HREF=".\hfdeploy.htm" TARGET="_blank"><U>HFDeploy.htm</U></A>).
</li>
	<LI>After you restart the computer, be sure to restart the virus checkers.<P class="important">Important</P>
<P class="indent">SP1 will not be fully operational until you restart your computer.</P>
</li></OL>

<H3><A NAME="scenario_2_installing_the_service_pack_so_such_that_computers_use_shared_remote_service_pack_source_files_pgmq"></A> Scenario 2:  Installing the service pack so that computers use shared, remote service pack source files</H3>

<P>This scenario explains how to prepare a shared distribution folder on a network and install the service pack from it. Doing this enables you to store service pack source files in the shared distribution folder rather than on local computers. Note that the update installation method installs the service pack on computers that are already running Windows&nbsp;XP.</P>
<P class="important">Important</P>
<P class="indent">Because the service pack source files are kept remotely on the network, this method is suitable only for computers that are permanently connected to the network. For example, this method is <I>not</I> suitable for upgrading laptops.</P>

<P class="indent">You must use a shared distribution folder that was created specifically for SP1. Do not reuse a folder that was set up for a previous service pack. Shared distribution folders for service pack source files must be permanent to ensure that all of the files a computer might need to replace are available.</P>

<P>Extracting the files from XPsp1.exe can be useful if you want to use the distribution folder as the folder that contains the service pack source files. This saves disk space on local computers, as the installation would point to the distribution folder for ServicePackFiles rather than creating this folder locally. The ServicePackFiles folder is needed whenever Windows&nbsp;XP requires a service pack file, such as when Windows File Protection needs to restore a corrupted or tampered-with file or when an optional component is configured.</P>

<P>If you move the shared distribution folder, see article <A HREF="http://go.microsoft.com/fwlink/?LinkId=9273" TARGET="_blank"><U>Q271484</U></A>, &quot;Files and Folders Are Added to Your System After Service Pack Is Installed,&quot; in the Microsoft Knowledge Base for more information.</P>
<P class="note">Note</P>
<P class="indent">In the following procedure, &quot;E:\&quot; represents the drive name of the network or computer where your distribution folder is located.</P>

<P class="proclabel">To install the service pack </p>
<OL>
	<LI>Connect to the network or computer on which you want to create the distribution folder.</li>
	<LI>Before you begin the installation, be sure to stop any real-time virus checkers that are running on the computer on which you will be installing the service pack.
<P>This is an important first step because virus checkers could cause problems with the installation if they are running.</P>
</li>
	<LI>In the shared folder on the network, create a distribution folder for the service pack. For example, to create a distribution folder named XPSP1, type the following at the command prompt:
<P><B>mkdir E:\XPSP1</B></P>
</li>
	<LI>To extract files to the shared distribution folder, type the following at the command prompt:
<P><B>XPsp1.exe /X:&lt;</B><I>path</I><B>&gt; /U</B></P>
<p>Where &lt;<I>path</I>&gt; is the location of the shared distribution folder. </P>

</li>
	<LI>For each computer you plan to upgrade, back up the files and close programs before you continue (unless you plan to force programs to close during the installation). </li>
	<LI>To install the service pack from the shared distribution folder, run the service pack update, using Update.exe. For example, to install the service pack from a distribution folder named XPSP1, type the following at the command prompt:
<P><B>E:\XPSP1\Update\Update.exe</B></P>

<P>The installation continues as described for Scenario 1 earlier in this section.</p>

<li>After the installation is completed, it is recommended that you immediately restart the computer.</li>

<P>If you want to install hotfixes, this is explained in the <I>Microsoft Windows&nbsp;XP Hotfix Installation and Deployment Guide</I> (see <A HREF=".\hfdeploy.htm" TARGET="_blank"><U>HFDeploy.htm</U></A>). </P>
</li>
	<LI>After you restart the computer, be sure to restart the virus checkers.</li></OL>
<P class="important">Important</P>
<P class="indent">SP1 will not be fully operational until you restart your computer.</P>

<H3><A NAME="scenario_2_using_sms_to_install_the_service_pack_mpfx"></A> Scenario 3:  Installing the service pack by using SMS</H3>

<P>This scenario explains how to install the service pack from a shared distribution folder on a network by using SMS. This update installation method installs the service pack on SMS client computers that are already running Windows&nbsp;XP.</P>
<P class="important">Important</P>
<P class="indent">To do this type of installation, you must have SMS&nbsp;2.0 with Service Pack&nbsp;4 installed.</P>

<P class="proclabel">To install the service pack by using SMS</p>
<OL>
	<LI>Create the SMS package by importing the package definition file for the service pack. In the package, provide the path to the service pack source files.</li>
	<LI>Distribute the SMS package to the distribution points.</li>
	<LI>Create the advertisement to notify SMS clients about the service pack.</li></OL>

<P>This scenario assumes that you have an understanding of SMS as well as a working knowledge of software distribution. </P>

<P>For details about deploying SP1 using SMS, see article <A HREF="http://go.microsoft.com/fwlink/?LinkId=8969" TARGET="_blank"><U>Q326696</U></A>, &quot;Installing the Windows&nbsp;XP Service Pack&nbsp;1 by Using SMS,&quot; in the Microsoft Knowledge Base.</P>

<H3><A NAME="scenario_3_using_windows_installer_service_to_install_the_service_pack_xkrd"></A> Scenario 4:  Installing the service pack by using Windows Installer and Group Policy</H3>

<P>This scenario explains how to install the service pack from a shared distribution folder on a network by using Windows Installer. This installation method installs the service pack on computers that are already running Windows&nbsp;XP.</P>

<P>To use this method, you should have a good understanding of Windows Installer, as well as a working knowledge of Group Policy and Active&nbsp;Directory&reg;. For more information about Windows Installer, Group Policy, or Active&nbsp;Directory, see the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8420" TARGET="_blank"><U>Microsoft Windows Resource Kits Web site</U></A>.</P>

<H4>Using Windows Installer</H4>

<P>The Windows Installer package file (Update.msi) contains all of the information that Windows Installer requires to install or remove the service pack and to run the Setup user interface. This package file describes the relationships among service pack features, components, and resources. The package file also contains an installation database, a summary information stream, and data streams for various parts of the service pack installation.</P>

<P>You can use the Software Installation and Maintenance feature in Windows&nbsp;XP, which uses Windows Installer, to deploy Update.msi for all the computers and install the service pack.</P>

<P>The Software Installation and Maintenance feature uses a Group Policy object (GPO) to deploy the package (on networked computers) within Active&nbsp;Directory containers, such as sites, domains, and organizational units that are associated with the GPO.</P>

<P>Microsoft requires that you use the <I>machine assigned</I> distribution method when using Update.msi. There are no other methods available.</P>
<P class="important">Important</P>
<P class="indent">Microsoft recommends that you use XPsp1.exe when deploying Windows&nbsp;XP SP1 by using the command prompt. If you use Update.msi to distribute service packs, you must use a computer-based (machine-assigned) GPO only. Microsoft does not support the use of user-based Group Policy deployments with Update.msi. For more information, see article <A HREF="http://go.microsoft.com/fwlink/?LinkId=9274" TARGET="_blank"><U>Q278503</U></A>, &quot;Best Practices for Using Update.msi to deploy Service Packs,&quot; in the Microsoft Knowledge Base.</P>

<P>After you assign the package, Windows Installer automatically installs the service pack the next time the users connected to the network start their computers. Note that only a network administrator or someone who is logged on to a local computer as an administrator can remove the assigned software.</P>

<H4>Assigning Service Pack&nbsp;1 to computers</H4>

<P>This procedure explains how to assign the service pack to computers managed by a GPO, which you create for the Desktops organizational unit under Resources. For your installation, you might want to associate the GPO with a different Active&nbsp;Directory container. To assign the service pack to computers by using Group Policy, you must do the following:

<OL>
	<LI>Create a shared network distribution folder.</li>
	<LI>Create a Group Policy object for SP1 deployments.</li>
	<LI>Deploy the SP1 update.msi from the shared distribution folder as machine-assigned. Do not deploy it as an user-deployment. </li>
	<LI>When the computers are restarted, they will be upgraded to SP1.</li></OL>

<P>Each of these procedures is explained in detail in article <A HREF="http://go.microsoft.com/fwlink/?LinkId=9275" TARGET="_blank"><U>Q302430</U></A>, &quot;HOW TO: Assign Software to a Specific Group By Using a Group Policy,&quot; in the Microsoft Knowledge Base.</P>

<H2><A NAME="the_integrated_installation_fmay"></A> The Integrated Installation</H2>

<P>You can apply the service pack directly to the Windows&nbsp;XP installation files and complete an integrated installation by using a shared distribution folder on a network.</P>

<P>Because the integrated installation replaces individual files, the space requirements for this installation type are practically identical to the space requirements for Windows&nbsp;XP. For information on these requirements, see Readme.htm on the Windows&nbsp;XP CD. </P>

<P>The following scenario explains how to use Update.exe to build the integrated installation and how to run Windows&nbsp;XP Setup to install Windows&nbsp;XP with the service pack already applied.</P>

<P>Because this guide is intended for corporate audiences, the integrated scenario described in this document focuses on the use of shared distribution folders on networks, which is the most common distribution medium for this audience.</P>
<P class="important">Important</P>
<UL>
	<LI>You cannot remove a service pack that you installed together with Windows&nbsp;XP in an integrated installation.</li>
	<LI>If you are upgrading from Windows versions other than Windows&nbsp;XP and&nbsp;want to&nbsp;use&nbsp;the integrated version of Windows&nbsp;XP with SP1, check with the manufacturer of your computer about upgrading your BIOS before you proceed.</li></UL>

<P>This section describes the installation steps for the following integrated installation scenarios:</P>

<UL>
	<LI>Scenario 1: Installing Windows&nbsp;XP integrated with the service pack</li>
	<LI>Scenario 2: Using RIS to install Windows&nbsp;XP integrated with the service pack</li></UL>

<P>Depending on your installation requirements, you can choose from these two integrated installation scenarios, which are described in detail in the following sections.</P>

<H3><A NAME="scenario_1_installing_windows_2000_integrated_with_the_service_pack_rpmd"></A> Scenario 1:  Installing Windows&nbsp;XP integrated with the service pack</H3>

<P>This scenario explains how to create an integrated installation of Windows&nbsp;XP and the service pack in a shared distribution folder on a network. The integrated process installs the service pack during Windows&nbsp;XP Setup. To complete this procedure, you must use a computer that is running Windows&nbsp;XP.</P>

<P>Note that to use the Setup Manager Wizard (setupmgr.exe) to install Windows&nbsp;XP integrated with SP1, you must first have an integrated Windows&nbsp;XP SP1 CD or create a shared distribution folder on the network, as explained in the following procedure. The steps in this procedure use example file locations for creating an integrated installation of Windows&nbsp;XP Professional. You can follow similar conventions for Windows&nbsp;XP Home&nbsp;Edition and Windows&nbsp;XP 64-Bit&nbsp;Edition.</P>
<P class="note">Note</P>
<P class="indent">In the following procedure, &quot;E:\&quot; represents the drive name of the network or computer where your distribution folder is located.</P>

<P class="proclabel">To create an integrated installation of Windows&nbsp;XP and the service pack</p>
<OL>
	<LI>Connect to the network or computer on which you want to create the distribution folder.</li>
	<LI>In the shared folder on the network, create a distribution folder for the Windows&nbsp;XP installation files.
<P>For example, to create a distribution folder named XPSP1_INT\PRO, type the following:</P>

<P><B>mkdir E:\XPSP1_INT\PRO</B>

<P>Ensure only the system administrator has full access to this folder. Other users should have only read and execute permissions.</P>
</li>
	<LI>Insert your Windows&nbsp;XP product CD into the CD-ROM drive, and then copy the contents of the CD to the distribution folder that you created in step&nbsp;2.
<P>For example, to copy the installation files and folders from the Windows&nbsp;XP product CD in the CD-ROM drive (D:) to the distribution folder named XPSP1_INT\PRO, type the following:

<P><B>xcopy D:\ E:\XPSP1_INT\PRO /E</B></P>
</li>
	<LI>Remove the Windows&nbsp;XP product CD from the CD-ROM drive, and then insert the service pack CD.</li>
	<LI>You can extract the service pack source files from XPsp1.exe and put them in a folder you choose on your hard disk if you want to store these files locally, as described in &quot;<A HREF="#the_update_installation_jwbu">The Update Installation section</A>&quot; earlier in this document. If you do not want to choose the location on your computer, skip this step and the installation will put the files in the default location.
<P>For example, to extract the service pack files located in the CD-ROM drive (D:) to a folder named temp on the drive where the distribution folder is located, type the following: 

<P><B>D:\</B> <B>XPsp1.exe /X:E:\temp /U</B></P>
</li>
	<LI>If you extracted the files, you can apply the service pack to the Windows&nbsp;XP installation files located in the folder named XPSP1_INT\PRO by typing the following:
<P><B>E:\temp\update\update.exe /S:E\XPSP1_INT\PRO</B></P>

<P>For a list of command-line options, see &quot;<A HREF="#command_line_switches_for_update_exe_and_w2ksp3_exe_nthj">Command-Line Options for XPsp1.exe and Update.exe</A>&quot; earlier in this document.
</li>
	<LI>The Windows&nbsp;XP Service Pack&nbsp;1 Setup Wizard displays the progress of your installation and informs you when the installation is completed.</li>
	<LI>Customize Windows&nbsp;XP Setup, as necessary (for example, to complete an unattended installation or add OEM files). For information on how to do this, see the <I>Microsoft Windows&nbsp;XP Professional Resource Kit Documentation</I> on the <A HREF="http://go.microsoft.com/fwlink/?LinkId=8420" TARGET="_blank"><U>Microsoft Windows Resource Kits Web site</U></A> and Microsoft Windows Preinstallation Reference Help (ref.chm) included in Deploy.cab on your CD in the \support\tools folder.</li>
	<LI>You can now deploy Windows&nbsp;XP to multiple computers from the shared distribution folder in either attended or unattended Setup mode. During the standard installation process, Windows&nbsp;XP Setup installs the updated operating system with the service pack already applied. For further details, see the <I>Microsoft Windows Corporate Deployment Tools User's Guide</I> (deploy.chm) included in Deploy.cab in the \Support\Tools folder on your SP1 CD.</li></OL>
<P class="important">Important</P>
<P class="indent">When you run the Update.exe program as described earlier for an integrated installation, a Svcpack.log file is created automatically in <I>systemroot</I> on the computer that is running the Update.exe program. If you plan to update more than one version of Windows&nbsp;XP on this computer, rename the Svcpack.log file after you update each version. This ensures that you do not overwrite the current log file when you update additional versions of Windows&nbsp;XP.</P>

<H3><A NAME="scenario_2_using_ris_to_install_windows_2000_integrated_with_the_service_pack_ubra"></A> Scenario 2:  Using RIS to install Windows&nbsp;XP integrated with the service pack</H3>

<P>This scenario explains how to use Remote Installation Services (RIS) to install Windows&nbsp;XP integrated with the service pack. However, this section does not provide details on how to set up RIS. For more information about RIS, see the technical paper <A HREF="http://go.microsoft.com/fwlink/?LinkId=3649" TARGET="_blank"><U>Step-by-Step Guide to Remote OS Installation</U></A>.</P>

<H4>Types of RIS Images</H4>

<P>There are two types of operating system images supported by Remote OS Installation: CD-based images (images created via RISetup) and Remote Installation Preparation (RIPrep) images. The CD-based option is similar to setting up a client operating system directly from the Windows&nbsp;XP product CD, but in this case, the source files reside on a RIS server. The RIPrep image enables an administrator to configure a client computer exactly how he or she wants it and then make a copy of that image for installation on client computers connected to the network.</P>

<H4>Adding a Service Pack&nbsp;1 Integrated CD-Based Image to a RIS Server</H4>

<P>After you complete the installation of RIS on the server, perform the following steps to add an image of Windows&nbsp;XP integrated with the service pack to your RIS server.</P>

<P class="proclabel">To copy Windows&nbsp;XP integrated with Service Pack&nbsp;1 to your RIS server</p>
<OL>
	<LI>Create an integrated installation of Windows&nbsp;XP with SP1. For more information, see &quot;<A HREF="#scenario_1_installing_windows_2000_integrated_with_the_service_pack_rpmd">Scenario 1: Installing Windows XP integrated with the service pack</A>&quot; earlier in this document.</li>
	<LI>To create a new image, click <B>Start</B>, and then click <B>Run</B>. Type:
<P><B>risetup.exe -add</B></P>
</li>
	<LI>The Remote Installation Services Set Wizard appears. Follow the instructions given by the wizard. When prompted for the image source by the Installation Source Files Location page, enter the path to the shared folder that contains the integrated installation that you created in step&nbsp;1.</li>
	<LI>The installation continues, and a box appears showing progress. After the RISetup image is complete. You can install the image on each computer by following the instructions given in the &quot;Remote Installation Services&quot; topic in <b>Help and Support Center</b>.</li></OL>

<H4>Updating Existing RIPrep Images to Service Pack&nbsp;1</H4>

<P>If you want to update your integrated installation image with additional programs or settings, you must have an SP1 CD-based image of Windows&nbsp;XP on your RIS server (see the preceding section, &quot;Adding a Service Pack&nbsp;1 Integrated CD-Based Image to a RIS Server&quot;). </P>

<P class="proclabel">To update existing RIPrep images</p>
<OL>
	<LI>Install the RIPrep image on your computer by using RIS.</li>
	<LI>Add additional programs and settings you want to include in the image.</li>
	<LI>Run RIPrep to copy the image back to the RIS server. For instructions on how to run RIPrep, see the technical paper <A HREF="http://go.microsoft.com/fwlink/?LinkId=3649" TARGET="_blank"><U>Step-by-Step Guide to Remote OS Installation</U></A>.</li>
	<LI>You can now deploy your RIPrep image to other computers. For details about how to do this, see the &quot;Remote Installation Services&quot; topic in <b>Help and Support Center</b>.</li></OL>
<P class="note">Note</P>
<P class="indent">You cannot use the <B>/S</B> option to integrate SP1 directly into an existing CD-based image or RIPrep image. </P>

<BR><BR>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="97%">
  <TBODY>
  <TR vAlign=bottom>
    <TD>
      <H1><A NAME="removing_the_service_pack_or_the_windows_2000_hotfixes_gwvc"></A> Removing Service Pack 1</H1>
	</TD>
    <TD align=right><A class="finePrint" 
      href="#top">Back 
      to Top</A></TD></TR></TBODY></TABLE>
<HR>

<P>This section discusses the process of removing the service pack from your computer. If you want to remove the service pack, it is possible to restore your computer to its previous state. However, you cannot remove a service pack that was installed by means of an integrated installation.</P>

<P>When you run the Update.exe program to install the service pack, a subfolder named $ntservicepackuninstall$ is created in your <I>systemroot</I> folder.</P>

<P>You can remove the service pack by using <B>Add or Remove Programs</B> in <B>Control Panel</B>.</P>
<P class="important">Important</P>
<UL>
	<LI>If you install any applications or services that require the service pack, removing the service pack can adversely affect those programs.</li>
	<LI>The service pack does not contain system updates &#0151; such as file format, database format, and registry format change.</li>
	<LI>If you turn off the automatic backup option for Update.exe, you <I>cannot</I> remove the service pack.</li>
	<LI>If you install Microsoft Internet Explorer <I>after</I> installing the service pack, Internet Explorer will not appear in <B>Add or Remove Programs</B>. </li></UL>

<P class="proclabel">To remove the service pack by using Add or Remove Programs</p>
<OL>
	<LI>If you installed any applications after the service pack was installed, you must remove these applications first, in the order in which they were installed.</li>
	<LI>Click <B>Start</B>, and then click <B>Control Panel</B>.</li>
	<LI>Click <B>Add or Remove Programs</B>, click <B>Windows&nbsp;XP Service Pack&nbsp;1</B>, and then click <B>Change or Remove Programs</B>.</li>
	<LI>Follow the instructions that appear on your screen.<P class="important">Important</P>
<P class="indent">If you choose to remove SP1, a dialog box appears, listing the applications you installed since you upgraded to SP1. If you continue with the removal, these applications might not work correctly.</P>
</li></OL>

<BR><BR>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="97%">
  <TBODY>
  <TR vAlign=bottom>
    <TD>
      <H1><A NAME="copyright_owya"></A> Copyright</H1>
	</TD>
    <TD align=right><A class="finePrint" 
      href="#top">Back 
      to Top</A></TD></TR></TBODY></TABLE>
<HR>

<P>Information in this document, including URL and other Internet Web site references, is subject to change without notice. Unless otherwise noted, the example companies, organizations, products, domain names, e-mail addresses, logos, people, places and events depicted herein are fictitious, and no association with any real company, organization, product, domain name, e-mail address, logo, person, place or event is intended or should be inferred. Complying with all applicable copyright laws is the responsibility of the user. Without limiting the rights under copyright, no part of this document may be reproduced, stored in or introduced into a retrieval system, or transmitted in any form or by any means (electronic, mechanical, photocopying, recording, or otherwise), or for any purpose, without the express written permission of Microsoft Corporation. </P>

<P>Microsoft may have patents, patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document. Except as expressly provided in any written license agreement from Microsoft, the furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property.</P>

<P>&copy; 2002 Microsoft Corporation. All rights reserved.</P>

<P>Microsoft, Active&nbsp;Directory, MS-DOS, Windows, and Windows&nbsp;NT are either registered trademarks or trademarks of Microsoft Corporation in the United States and/or other countries.</P>

<P>This product contains graphics filter software; this software is based in part on the work of the Independent JPEG Group.</P>

<P>The names of actual companies and products mentioned herein may be the trademarks of their respective owners.</P>

<!--RELID:WXSP1.4_EN-->

</body>
</HTML>
